---
alwaysApply: true
---
# Jwell B2B Platform – Project Overview

## Project Identity

- **Project Name**: Jwell B2B Platform – Elvee Jewels
- **Business**: B2B jewellery platform for retailers and wholesalers
- **Brand**: Elvee Jewels Pvt. Ltd.

## Core Business Domains (DO NOT BREAK)

These domains are business-critical and must be handled with extreme care:

1. **Products & Variants**
   - Product base configuration (`products` table)
   - Variant generation matrix (metals × purities × tones × diamonds × colorstones × sizes)
   - Variant matching logic
   - Location: `app/Models/Product.php`, `app/Models/ProductVariant.php`, `app/Services/Catalog/ProductVariantSyncService.php`

2. **Pricing & Rates**
   - Dynamic pricing: base_price + making_charge + variant adjustments + metal rates + discounts
   - Live metal rate synchronization (Gold XAU, Silver XAG)
   - Making charge discounts (customer group, quantity, product-specific)
   - Location: `app/Services/PricingService.php`, `app/Services/RateSyncService.php`, `app/Services/MakingChargeDiscountService.php`

3. **Orders Workflow**
   - Status flow: Pending → Pending Payment → Paid → Approved → In Production → Quality Check → Ready To Dispatch → Dispatched → Delivered
   - Status enum: `app/Enums/OrderStatus.php`
   - Workflow service: `app/Services/OrderWorkflowService.php`

4. **Quotations**
   - Customer submits → Admin reviews → Approved/Rejected → Customer confirms → Converted to order
   - Location: `app/Http/Controllers/Frontend/QuotationController.php`, `app/Http/Controllers/Admin/QuotationController.php`

5. **KYC System**
   - Status flow: Pending → Review → Approved/Rejected
   - KYC-gated features (catalog, cart, checkout, orders)
   - Status enum: `app/Enums/KycStatus.php`
   - Location: `app/Http/Controllers/Frontend/KycOnboardingController.php`, `app/Http/Controllers/Admin/KycController.php`

6. **Jobwork & Work Orders**
   - Jobwork requests (customer/vendor supplied materials)
   - Work order status: Draft → In Production → Quality Check → Ready To Dispatch → Dispatched → Closed
   - Status enums: `app/Enums/JobworkStatus.php`, `app/Enums/WorkOrderStatus.php`
   - Location: `app/Http/Controllers/Frontend/JobworkController.php`, `app/Http/Controllers/Production/WorkOrderController.php`

## Technology Stack (MUST STAY CONSISTENT)

- **Backend**: Laravel 12, PHP 8.2+, PostgreSQL
- **Frontend**: React 18.2, TypeScript 5.0, Inertia.js 2.0
- **Styling**: Tailwind CSS 3.2+ with Headless UI
- **Build**: Vite 7.0
- **Auth**: Laravel Breeze 2.3 (with OTP support)
- **Payments**: Stripe (extensible driver system)
- **Queue**: Laravel Queue for background jobs
- **Testing**: PHPUnit 11.5

If a request conflicts with this stack, either adapt within it or explicitly warn before introducing new technology.

## Portal Architecture

Three distinct portals with separate routes, controllers, and layouts:

1. **Customer Portal** (`/`)
   - Routes: `routes/web.php` (customer middleware group)
   - Controllers: `app/Http/Controllers/Frontend/*`
   - Pages: `resources/js/Pages/Frontend/*`
   - Layout: `resources/js/Layouts/AuthenticatedLayout.tsx`
   - Access: Retailer, Wholesaler (KYC-approved)

2. **Admin Portal** (`/admin`)
   - Routes: `routes/web.php` (admin prefix + middleware)
   - Controllers: `app/Http/Controllers/Admin/*`
   - Pages: `resources/js/Pages/Admin/*`
   - Layout: `resources/js/Layouts/AdminLayout.tsx`
   - Access: Admin, Super Admin, Sales

3. **Production Portal** (`/production`)
   - Routes: `routes/web.php` (production prefix + middleware)
   - Controllers: `app/Http/Controllers/Production/*`
   - Pages: `resources/js/Pages/Production/*`
   - Layout: `resources/js/Layouts/ProductionLayout.tsx`
   - Access: Production, Super Admin

## User Types (Enum)

Defined in `app/Enums/UserType.php`:
- `Retailer` - Customer portal access
- `Wholesaler` - Customer portal access (enhanced pricing)
- `Admin` - Admin portal access
- `SuperAdmin` - All portals
- `Sales` - Admin portal (limited)
- `Production` - Production portal

## Assistant Behavior Rules

- Always respect all `.cursor/rules/*.mdc` files as project law
- Prefer small, incremental changes over large refactors
- When unsure about business logic, preserve current behavior and mark `// TODO` instead of guessing
- Before touching critical domains, check existing services, enums, and routes
- Extend existing code rather than building parallel logic
