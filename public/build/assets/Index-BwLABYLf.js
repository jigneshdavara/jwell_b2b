import{u as q,r as d,a as I,j as e,H as L,L as D}from"./app-xiOEIreu.js";import{A as E}from"./AuthenticatedLayout-jfKbel75.js";import"./ApplicationLogo-Dg1h9LTV.js";import"./FlashMessage-CKFpXUfl.js";const w=[{value:"catalogue",label:"Catalogue design",helper:"Customise an existing Elvee design with metal / variant tweaks."},{value:"custom",label:"Upload bespoke concept",helper:"Share brand-new concepts with references, AI renders, or CAD briefs."}];function T(){const{prefillProduct:t,defaultVariantId:h,jobworks:o,offers:f,metals:x,metalPurities:g,metalTones:b}=q().props,[c,C]=d.useState(t?"catalogue":"custom"),[u,j]=d.useState(""),[i,N]=d.useState(""),{data:n,setData:a,post:S,processing:v,errors:r}=I({submission_mode:t?"catalogue":"custom",product_id:t?.id??null,product_variant_id:h??null,type:"customer_supplied",reference_design:"",reference_url:"",reference_media:[],metal_id:"",metal_purity_id:"",metal_tone_id:"",metal:t?.material??"",purity:t?.purity??"",diamond_quality:"",quantity:1,special_instructions:"",delivery_deadline:"",wastage_percentage:"",manufacturing_charge:""}),y=d.useMemo(()=>i===""||typeof i!="number"?[]:g.filter(s=>s.metal_id===i),[i,g]),M=d.useMemo(()=>i===""||typeof i!="number"?[]:b.filter(s=>s.metal_id===i),[i,b]);d.useEffect(()=>{if(a("submission_mode",c),c==="catalogue"&&t&&(a("product_id",t.id),a("metal",t.material??""),a("purity",t.purity??""),a("product_variant_id",h??null),t.material)){const s=x.find(l=>l.name.toLowerCase()===t.material?.toLowerCase());s&&(N(s.id),a("metal_id",s.id))}c==="custom"&&(a("product_id",null),a("product_variant_id",null))},[c]),d.useEffect(()=>{const s=u.split(`
`).map(l=>l.trim()).filter(l=>l.length>0);a("reference_media",s)},[u]),d.useEffect(()=>{t&&t.media.length&&j(t.media.map(s=>s.url).join(`
`))},[t]),d.useMemo(()=>!t||!n.product_variant_id?null:t.variants.find(s=>s.id===n.product_variant_id)??null,[t,n.product_variant_id]);const _=d.useMemo(()=>{if(!t)return null;const s=t.base_price??0,l=t.making_charge_amount??0;return s+l},[t]),k=s=>{s.preventDefault(),S(route("frontend.jobwork.store"),{preserveScroll:!0})};return e.jsxs(E,{children:[e.jsx(L,{title:"Jobwork & Custom Manufacturing"}),e.jsxs("div",{className:"space-y-10",children:[e.jsx("section",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:e.jsxs("div",{className:"flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold text-slate-900",children:"Create a production brief"}),e.jsx("p",{className:"mt-2 text-sm text-slate-500",children:"Share modification requirements for catalogue pieces or submit brand-new concepts. Our production concierge will revert with quotes and timelines."})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-500",children:[e.jsxs("span",{className:"inline-flex items-center rounded-full border border-slate-200 px-3 py-1 font-medium text-slate-700",children:["Current requests: ",o.length]}),e.jsxs(D,{href:route("frontend.catalog.index"),className:"inline-flex items-center gap-2 rounded-full bg-elvee-blue px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-elvee-blue/30 transition hover:bg-navy",children:["Browse catalogue",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})}),e.jsxs("section",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:w.map(s=>{const l=!t&&s.value==="catalogue";return e.jsx("button",{type:"button",onClick:()=>!l&&C(s.value),disabled:l,className:`rounded-full px-4 py-2 text-sm font-semibold transition ${c===s.value?"bg-slate-900 text-white shadow-slate-900/30":"bg-slate-100 text-slate-600 hover:bg-slate-200"} ${l?"cursor-not-allowed opacity-60":""}`,children:s.label},s.value)})}),e.jsxs("p",{className:"mt-3 text-xs text-slate-500",children:[w.find(s=>s.value===c)?.helper,!t&&c==="catalogue"&&e.jsx("span",{className:"ml-2 font-semibold text-amber-600",children:"Select a catalogue design first from Browse Catalogue."})]}),e.jsx("form",{onSubmit:k,className:"mt-6 space-y-6",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[c==="catalogue"&&t?e.jsxs("div",{className:"space-y-4 rounded-2xl border border-slate-200 p-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Design selected"}),e.jsx("h2",{className:"mt-1 text-lg font-semibold text-slate-900",children:t.name}),e.jsxs("p",{className:"text-xs text-slate-500",children:["SKU ",t.sku]})]}),e.jsxs("div",{className:"grid gap-3 text-sm text-slate-600 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-500",children:"Base value"}),e.jsxs("p",{className:"text-slate-900",children:["₹ ",(t.base_price??0).toLocaleString("en-IN")]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-500",children:"Making charge"}),e.jsxs("p",{className:"text-slate-900",children:["₹ ",(t.making_charge_amount??0).toLocaleString("en-IN")]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-500",children:"Purity"}),e.jsx("p",{className:"text-slate-900",children:t.purity})]})]}),t.variants.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Select variant"}),e.jsx("div",{className:"grid gap-2",children:t.variants.map(s=>{const l=n.product_variant_id===s.id;return e.jsxs("label",{className:`flex cursor-pointer items-center justify-between rounded-2xl border px-4 py-3 text-sm transition ${l?"border-feather-gold bg-feather-gold/10 text-slate-900":"border-slate-200 bg-white text-slate-600 hover:border-feather-gold/50"}`,children:[e.jsx("span",{children:s.label}),e.jsx("span",{className:"flex items-center gap-2",children:e.jsx("input",{type:"radio",name:"product_variant_id",value:s.id,checked:l,onChange:()=>a("product_variant_id",s.id),className:"h-4 w-4 text-elvee-blue focus:ring-feather-gold"})})]},s.id)})})]}),_!==null&&e.jsxs("div",{className:"rounded-xl bg-slate-900 px-4 py-3 text-sm text-white",children:[e.jsx("p",{className:"text-xs text-white/70",children:"Estimated total"}),e.jsxs("p",{className:"mt-1 text-lg font-semibold",children:["₹ ",_.toLocaleString("en-IN")]}),e.jsx("p",{className:"text-xs text-white/70",children:"Final value subject to labour & offer adjustments."})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Reference design summary *"}),e.jsx("textarea",{className:"min-h-[120px] rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.reference_design,onChange:s=>a("reference_design",s.target.value),placeholder:"Describe materials, gemstone placements, finishing details, packaging expectations…"}),r.reference_design&&e.jsx("span",{className:"text-xs text-rose-500",children:r.reference_design})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Reference media URLs (one per line)"}),e.jsx("textarea",{className:"min-h-[120px] rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:u,onChange:s=>j(s.target.value),placeholder:"https://…"}),r.reference_media&&e.jsx("span",{className:"text-xs text-rose-500",children:r.reference_media})]})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Supply Type"}),e.jsxs("select",{className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.type,onChange:s=>a("type",s.target.value),children:[e.jsx("option",{value:"customer_supplied",children:"Customer supplying metal/stone"}),e.jsx("option",{value:"vendor_supplied",children:"Elvee supplying metal/stone"})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Metal *"}),e.jsxs("select",{className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.metal_id,onChange:s=>{const l=s.target.value===""?"":Number(s.target.value);N(l),a("metal_id",l),a("metal_purity_id",""),a("metal_tone_id","");const m=x.find(p=>p.id===l);a("metal",m?.name??"")},children:[e.jsx("option",{value:"",children:"Select metal"}),x.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),r.metal_id&&e.jsx("span",{className:"text-xs text-rose-500",children:r.metal_id}),r.metal&&e.jsx("span",{className:"text-xs text-rose-500",children:r.metal})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Purity"}),e.jsxs("select",{className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20 disabled:bg-slate-50 disabled:text-slate-400",value:n.metal_purity_id,onChange:s=>{const l=s.target.value===""?"":Number(s.target.value);a("metal_purity_id",l);const m=y.find(p=>p.id===l);a("purity",m?.name??"")},disabled:i===""||typeof i!="number",children:[e.jsx("option",{value:"",children:"Select purity"}),y.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),r.metal_purity_id&&e.jsx("span",{className:"text-xs text-rose-500",children:r.metal_purity_id}),r.purity&&e.jsx("span",{className:"text-xs text-rose-500",children:r.purity})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Tone"}),e.jsxs("select",{className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20 disabled:bg-slate-50 disabled:text-slate-400",value:n.metal_tone_id,onChange:s=>{const l=s.target.value===""?"":Number(s.target.value);a("metal_tone_id",l)},disabled:i===""||typeof i!="number",children:[e.jsx("option",{value:"",children:"Select tone"}),M.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),r.metal_tone_id&&e.jsx("span",{className:"text-xs text-rose-500",children:r.metal_tone_id})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Diamond / Stone quality"}),e.jsx("input",{type:"text",className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.diamond_quality,onChange:s=>a("diamond_quality",s.target.value)})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Quantity"}),e.jsx("input",{type:"number",min:1,className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.quantity,onChange:s=>a("quantity",Number(s.target.value)||1)}),r.quantity&&e.jsx("span",{className:"text-xs text-rose-500",children:r.quantity})]})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Special instructions"}),e.jsx("textarea",{className:"min-h-[100px] rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.special_instructions,onChange:s=>a("special_instructions",s.target.value)})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Delivery deadline"}),e.jsx("input",{type:"date",className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.delivery_deadline,onChange:s=>a("delivery_deadline",s.target.value)}),r.delivery_deadline&&e.jsx("span",{className:"text-xs text-rose-500",children:r.delivery_deadline})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Wastage %"}),e.jsx("input",{type:"number",step:"0.01",className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.wastage_percentage,onChange:s=>a("wastage_percentage",s.target.value)})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Manufacturing charge (₹)"}),e.jsx("input",{type:"number",step:"0.01",className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.manufacturing_charge,onChange:s=>a("manufacturing_charge",s.target.value)})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Active offer playbook"}),e.jsx("ul",{className:"mt-3 space-y-3 text-sm text-slate-600",children:f.length?f.map(s=>e.jsxs("li",{className:"rounded-xl bg-slate-50 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold text-slate-800",children:s.name}),e.jsx("span",{className:"text-xs text-slate-500",children:s.code})]}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:s.description})]},s.code)):e.jsx("li",{className:"text-xs text-slate-500",children:"No active offers configured."})})]}),t&&t.media.length>0&&e.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:t.media.map(s=>e.jsx("img",{src:s.url,alt:s.alt,className:"h-36 w-full rounded-2xl object-cover shadow"},s.url))}),e.jsx("button",{type:"submit",disabled:v,className:"w-full rounded-full bg-elvee-blue px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-elvee-blue/30 transition hover:bg-navy disabled:cursor-not-allowed disabled:opacity-60",children:v?"Submitting…":"Submit jobwork request"})]})]})})]}),e.jsxs("section",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Recent jobwork briefs"}),e.jsxs("span",{className:"text-xs text-slate-500",children:["Showing latest ",o.length]})]}),e.jsx("div",{className:"mt-4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs font-semibold text-slate-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:"Reference"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Design"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Mode"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Qty"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Delivery"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Created"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[o.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-800",children:s.reference}),e.jsxs("td",{className:"px-4 py-3 text-slate-600",children:[s.product??"Custom",s.variant?e.jsx("span",{className:"block text-xs text-slate-400",children:s.variant}):null]}),e.jsx("td",{className:"px-4 py-3 capitalize text-slate-500",children:s.submission_mode}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:s.quantity}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"inline-flex rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-600",children:s.status})}),e.jsx("td",{className:"px-4 py-3 text-slate-500",children:s.delivery_deadline??"—"}),e.jsx("td",{className:"px-4 py-3 text-slate-500",children:s.created_at})]},s.id)),o.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-6 text-center text-sm text-slate-500",children:"No jobwork requests yet. Submit your first brief above."})})]})]})})]})]})]})}export{T as default};
