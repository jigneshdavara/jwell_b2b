import{u as Te,r as C,a as qe,j as e,H as Be}from"./app-xiOEIreu.js";import{R as Fe}from"./RichTextEditor-CMExxgqu.js";import{A as Ue}from"./AdminLayout-XCW1ytWV.js";const _e=(A=!1)=>({sku:"",label:"",metal_id:"",metal_purity_id:"",diamond_option_key:null,is_default:A,metadata:{},metals:[],diamonds:[]});function Re({catalogs:A,selectedIds:f,onChange:I,error:G}){const[F,W]=C.useState(!1),[T,B]=C.useState(""),q=C.useRef(null),j=C.useMemo(()=>{if(!T.trim())return A;const v=T.toLowerCase();return A.filter(z=>z.name.toLowerCase().includes(v)||z.code?.toLowerCase().includes(v))},[A,T]),Z=v=>{f.includes(v)?I(f.filter(z=>z!==v)):I([...f,v])};C.useEffect(()=>{const v=z=>{q.current&&!q.current.contains(z.target)&&(W(!1),B(""))};return F&&document.addEventListener("mousedown",v),()=>{document.removeEventListener("mousedown",v)}},[F]);const U=C.useMemo(()=>f.map(v=>{const z=A.find(X=>X.id===v);return z?{id:v,name:z.name}:null}).filter(Boolean),[f,A]),b=v=>{I(f.filter(z=>z!==v))};return e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Catalogs"}),f.length>0&&e.jsxs("span",{className:"text-xs font-medium text-sky-600",children:[f.length," selected"]})]}),e.jsxs("div",{className:"relative",ref:q,children:[e.jsx("button",{type:"button",onClick:()=>W(!F),className:`w-full rounded-2xl border ${G?"border-rose-300":"border-slate-200"} bg-white px-4 py-2.5 text-left focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200 transition-all ${F?"border-sky-400 ring-2 ring-sky-200":""}`,children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"flex-1 min-h-[20px] flex flex-wrap gap-1.5",children:f.length===0?e.jsx("span",{className:"text-slate-400",children:"Select catalogs..."}):U.map(v=>e.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-md bg-sky-50 px-2 py-1 text-xs font-medium text-sky-700 border border-sky-200",onClick:z=>z.stopPropagation(),children:[e.jsx("span",{children:v.name}),e.jsx("button",{type:"button",onClick:z=>{z.stopPropagation(),b(v.id)},className:"hover:bg-sky-100 rounded-full p-0.5 transition-colors",children:e.jsx("svg",{className:"h-3 w-3 text-sky-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},v.id))}),e.jsx("svg",{className:`ml-2 h-5 w-5 text-slate-400 transition-transform flex-shrink-0 ${F?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),F&&e.jsxs("div",{className:"absolute z-50 mt-2 w-full rounded-2xl border border-slate-200 bg-white shadow-lg shadow-slate-900/10 max-h-80 overflow-hidden",children:[A.length>5&&e.jsx("div",{className:"border-b border-slate-100 p-3",children:e.jsxs("div",{className:"relative",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",value:T,onChange:v=>B(v.target.value),placeholder:"Search catalogs...",className:"w-full rounded-xl border border-slate-200 bg-white pl-10 pr-4 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",onClick:v=>v.stopPropagation()})]})}),e.jsx("div",{className:"max-h-64 overflow-y-auto p-2",children:j.length===0?e.jsx("div",{className:"px-3 py-6 text-center text-sm text-slate-400",children:T?"No catalogs found":"No catalogs available"}):e.jsx("div",{className:"space-y-1",children:j.map(v=>{const z=f.includes(v.id);return e.jsxs("button",{type:"button",onClick:()=>Z(v.id),className:`w-full flex items-center gap-3 rounded-xl px-3 py-2.5 text-left transition-colors ${z?"bg-sky-50 text-sky-700":"text-slate-700 hover:bg-slate-50"}`,children:[e.jsx("div",{className:`flex h-5 w-5 items-center justify-center rounded border-2 transition-all ${z?"border-sky-500 bg-sky-500":"border-slate-300"}`,children:z&&e.jsx("svg",{className:"h-3.5 w-3.5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm font-medium truncate ${z?"text-sky-900":"text-slate-900"}`,children:v.name}),v.code&&e.jsxs("span",{className:`text-xs font-mono ${z?"text-sky-600":"text-slate-500"}`,children:["(",v.code,")"]})]})})]},v.id)})})})]})]}),G&&e.jsx("span",{className:"text-xs text-rose-500",children:G})]})}function Ge(){const{props:A}=Te(),{product:f,brands:I,categories:G,catalogs:F,diamonds:W,metals:T,metalPurities:B,metalTones:q,errors:j}=A,Z=C.useMemo(()=>{if(!f?.variants?.length)return{metalPurityIds:[],metalToneIds:[],diamondOptions:[],metalSelections:[]};const t=new Set,s=new Set,a=new Map,r=new Map;return f.variants.forEach(i=>{i.metals?.length&&i.metals.forEach(n=>{if(n.metal_id&&n.metal_id!==""&&n.metal_id!==null){const x=typeof n.metal_id=="number"?n.metal_id:Number(n.metal_id),p=n.metal_purity_id&&n.metal_purity_id!==""?typeof n.metal_purity_id=="number"?n.metal_purity_id:Number(n.metal_purity_id):0,u=n.metal_tone_id&&n.metal_tone_id!==""?typeof n.metal_tone_id=="number"?n.metal_tone_id:Number(n.metal_tone_id):0,m=n.metal_weight?String(n.metal_weight):"",k=`${x}-${p}-${u}`;r.has(k)||r.set(k,{metal_id:x,metal_purity_id:p||0,metal_tone_id:u||0,weight:m}),p&&t.add(p),u&&s.add(u)}}),i.diamonds?.length&&i.diamonds.forEach(n=>{if(n.diamond_id&&n.diamond_id!==""&&n.diamond_id!==null){const x=typeof n.diamond_id=="number"?n.diamond_id:Number(n.diamond_id);a.has(x)||a.set(x,{diamond_id:x,count:n.diamonds_count&&n.diamonds_count!==""&&n.diamonds_count!==null?String(n.diamonds_count):""})}})}),{metalPurityIds:Array.from(t),metalToneIds:Array.from(s),diamondSelections:Array.from(a.values()),metalSelections:Array.from(r.values()).map(i=>({metal_id:i.metal_id,metal_purity_id:i.metal_purity_id||"",metal_tone_id:i.metal_tone_id||"",weight:i.weight}))}},[f]),U=qe(()=>({sku:f?.sku??"",name:f?.name??"",titleline:f?.titleline??"",description:f?.description??"",catalog_ids:f?.catalog_ids??[],brand_id:String(f?.brand_id??""),category_id:String(f?.category_id??""),collection:f?.collection??"",producttype:f?.producttype??"",gender:f?.gender??"",making_charge_amount:f?.making_charge_amount?String(f.making_charge_amount):"",making_charge_types:(()=>{const t=f?.making_charge_amount&&Number(f.making_charge_amount)>0,s=f?.making_charge_percentage&&Number(f.making_charge_percentage)>0;return t&&s?["fixed","percentage"]:s?["percentage"]:t?["fixed"]:["fixed"]})(),making_charge_percentage:f?.making_charge_percentage?String(f.making_charge_percentage):"",is_active:f?.is_active??!0,variants:f?.variants?.length?f.variants.map((t,s)=>({id:t.id,sku:t.sku??"",label:t.label??"",metal_id:t.metal_id??"",metal_purity_id:t.metal_purity_id??"",diamond_option_key:t.diamond_option_key??null,is_default:t.is_default??s===0,inventory_quantity:t.inventory_quantity!==void 0&&t.inventory_quantity!==null?Number(t.inventory_quantity):0,metadata:t.metadata??{},metals:t.metals?.map(a=>({id:a.id,metal_id:a.metal_id??"",metal_purity_id:a.metal_purity_id??"",metal_tone_id:a.metal_tone_id??"",metal_weight:a.metal_weight?String(a.metal_weight):""}))??[],diamonds:t.diamonds?.map(a=>({id:a.id,diamond_id:a.diamond_id??"",diamonds_count:a.diamonds_count?String(a.diamonds_count):""}))??[]})):[_e(!0)],diamond_options:[],uses_diamond:(Z.diamondSelections?.length??0)>0,diamond_selections:Z.diamondSelections??[],metal_selections:Z.metalSelections??[],selected_metals:[],metal_configurations:{},media_uploads:[],removed_media_ids:[]})),{setData:b,post:v,put:z,processing:X}=U,o=U.data,[ne,ie]=C.useState(o.description),Y=C.useRef(null);C.useEffect(()=>{o.description!==ne&&ie(o.description)},[o.description]);const ge=C.useCallback(t=>{ie(t),Y.current&&clearTimeout(Y.current),Y.current=setTimeout(()=>{b("description",t)},300)},[b]);C.useEffect(()=>()=>{Y.current&&clearTimeout(Y.current)},[]);const[le,re]=C.useState(""),[be,We]=C.useState(new Set),[ye,Ke]=C.useState(new Set),J=t=>Number.isFinite(t)?t.toFixed(3).replace(/\.?0+$/,""):"",je=(t,s)=>{const a=parseFloat(t);if(!Number.isFinite(a))return"";const r=s==="mm"?a/10:a;return J(r)},oe=(t,s)=>{const a=typeof t=="number"?t:parseFloat(t);if(!Number.isFinite(a))return"";const r=s==="mm"?a*10:a;return J(r)},K=C.useMemo(()=>Object.fromEntries(B.map(t=>[t.id,t.name])),[B]),Q=C.useMemo(()=>Object.fromEntries(q.map(t=>[t.id,t.name])),[q]),O=C.useMemo(()=>Object.fromEntries(T.map(t=>[t.id,t.name])),[T]),te=C.useCallback((t,s)=>{let a="";if(t.metals&&t.metals.length>0){const d=t.metals.filter(h=>h.metal_id!==""&&typeof h.metal_id=="number").map(h=>({metal_id:h.metal_id,metal_purity_id:h.metal_purity_id!==""&&h.metal_purity_id!==null?Number(h.metal_purity_id):null,metal_tone_id:h.metal_tone_id!==""&&h.metal_tone_id!==null?Number(h.metal_tone_id):null}));if(d.length===0)a="";else{const h=new Map;d.forEach(g=>{h.has(g.metal_id)||h.set(g.metal_id,[]),h.get(g.metal_id).push(g)});const M=[];h.forEach((g,ae)=>{const E=O[ae]??"";if(!E)return;const P=new Set(g.map(L=>L.metal_purity_id).filter(Boolean)),N=new Set(g.map(L=>L.metal_tone_id).filter(Boolean));let $="";if(P.size>1&&N.size===1){const L=Array.from(N)[0],D=L?Q[L]??"":"",S=Array.from(P).map(V=>V?K[V]??"":"").filter(Boolean).sort();S.length>0?D?$=`${S.join(" + ")} ${D} ${E}`:$=`${S.join(" + ")} ${E}`:$=E}else if(N.size>1&&P.size===1){const L=Array.from(P)[0],D=L?K[L]??"":"",S=Array.from(N).map(V=>V?Q[V]??"":"").filter(Boolean).sort();S.length>0?D?$=`${D} ${S.join(" + ")} ${E}`:$=`${S.join(" + ")} ${E}`:$=D?`${D} ${E}`:E}else{const L=g[0],D=L.metal_purity_id,S=L.metal_tone_id,V=D?K[D]??"":"",H=S?Q[S]??"":"";V&&H?$=`${V} ${H} ${E}`:V?$=`${V} ${E}`:H?$=`${H} ${E}`:$=E}$&&M.push($)}),a=M.join(" / ")}}else if(t.metal_id!==""&&typeof t.metal_id=="number"){const d=O[t.metal_id]??"";if(t.metal_purity_id!==""&&typeof t.metal_purity_id=="number"){const h=K[t.metal_purity_id]??"";a=h?`${h} ${d}`:d}else a=d}let r="";if(t.diamonds&&t.diamonds.length>0){const d=[];t.diamonds.forEach(h=>{if(h.diamond_id&&typeof h.diamond_id=="number"){const M=h.diamonds_count?` (${h.diamonds_count})`:"";d.push(`Diamond${M}`)}}),r=d.join(" / ")}const i=t.metadata??{},n=typeof i.size_value=="string"||typeof i.size_value=="number"?String(i.size_value):"";let p=(i.size_unit==="mm"||i.size_unit==="cm"?i.size_unit:"cm")||"cm",u="";n&&(u=J(Number(n)));const m=u?`${u}${p}`:"",k=[r,a,m].filter(Boolean),l=k.length?k.join(" / "):"Variant",_=a;let y=null;t.diamonds&&t.diamonds.length>0&&(y=t.diamonds.map(d=>({diamond_id:d.diamond_id!==""&&d.diamond_id!==null?Number(d.diamond_id):null,diamonds_count:d.diamonds_count?Number(d.diamonds_count):null})));const c={metal_id:t.metal_id!==""&&t.metal_id!==null?Number(t.metal_id):null,metal_purity_id:t.metal_purity_id!==""&&t.metal_purity_id!==null?Number(t.metal_purity_id):null,diamond_option_key:t.diamond_option_key??null,diamond:y,auto_label:l};u?(c.size_value=u,c.size_unit=p):(delete c.size_value,delete c.size_unit);const w=typeof i.status=="string"&&i.status.trim().length>0?String(i.status):void 0;return w?c.status=w:c.status="enabled",{autoLabel:l,metalTone:_,sizeText:m,metadata:c}},[oe,J,O,K,Q]),R=C.useCallback(t=>(t.variants||[]).map((s,a)=>{const r=te(s,t),i=s.metadata?.auto_label??"",n=!s.label||s.label===i,x=s.metadata?.auto_sku??"",p=(t.sku??"").trim(),m=`${p?p.replace(/[^A-Za-z0-9]/g,"").toUpperCase():"SKU"}-${String(a+1).padStart(2,"0")}`,k=!s.sku||s.sku===x;return{...s,sku:k?m:s.sku,label:n?r.autoLabel:s.label,metadata:{...r.metadata,auto_sku:m},is_default:s.is_default??a===0}}),[te]);C.useMemo(()=>[],[]),C.useMemo(()=>[],[]),C.useMemo(()=>[],[]),C.useMemo(()=>({}),[]);const Ne=t=>{},de=t=>{b(s=>{if(s.size_unit===t)return s;const a=(s.size_values||[]).map(i=>{const n=je(i,s.size_unit||"cm");return n?oe(n,t):i}),r={...s,size_unit:t,size_values:a,variants:(s.variants||[]).map(i=>{const n={...i.metadata??{}},x=n.size_value;return x?(n.size_value=x,n.size_unit=t):(delete n.size_value,n.size_unit=t),{...i,metadata:n}})};return r.variants=R(r),r})},ve=()=>{const t=le.trim();if(!t)return;const s=parseFloat(t);if(!Number.isFinite(s)||s<=0)return;const a=J(s);b(r=>{if((r.size_values||[]).includes(a))return r;const i={...r,size_values:[...r.size_values||[],a]};return i.variants=R(i),i}),re("")},ke=t=>{b(s=>{const a={...s,size_values:(s.size_values||[]).filter(r=>r!==t)};return a.variants=R(a),a})},we=()=>{b(t=>{const s=t.diamond_selections||[];return{...t,diamond_selections:[...s,{diamond_id:"",count:""}]}})},Ce=t=>{b(s=>{const a=s.diamond_selections||[];return{...s,diamond_selections:a.filter((r,i)=>i!==t)}})},ce=(t,s,a)=>{b(r=>{const n=(r.diamond_selections||[]).map((x,p)=>p!==t?x:{...x,[s]:a});return{...r,diamond_selections:n}})},ze=t=>{b(s=>{if((s.variants||[]).length===1)return s;const a=(s.variants||[]).filter((i,n)=>n!==t);a.every(i=>!i.is_default)&&a.length>0&&(a[0].is_default=!0);const r={...s,variants:a};return r.variants=R(r),r})},ee=(t,s,a)=>{b(r=>{const i=(r.variants||[]).map((x,p)=>{if(p!==t)return x;const u={...x};switch(s){case"is_default":typeof a=="boolean"&&(u.is_default=a);break;case"metal_id":(a===""||typeof a=="number")&&(u.metal_id=a,(a===""||typeof a!="number")&&(u.metal_purity_id=""));break;case"metal_purity_id":(a===""||typeof a=="number")&&(u.metal_purity_id=a);break;case"diamond_option_key":u.diamond_option_key=a?String(a):null;break;case"sku":case"label":typeof a=="string"&&(u[s]=a);break;case"inventory_quantity":if(a===""||a===null)u[s]=0;else if(typeof a=="string"){const m=parseInt(a,10);u[s]=isNaN(m)?0:m}else typeof a=="number"&&(u[s]=a);break}return u}),n={...r,variants:i};return n.variants=R(n),n})},Se=(t,s)=>{b(a=>{const r=(a.variants||[]).map((n,x)=>{if(x!==t)return n;const p={...n.metadata??{}};return Object.entries(s).forEach(([u,m])=>{m===null?delete p[u]:p[u]=m}),{...n,metadata:p}}),i={...a,variants:r};return i.variants=R(i),i})},Me=t=>{b(s=>({...s,variants:(s.variants||[]).map((a,r)=>({...a,is_default:r===t}))}))},$e=(t,s)=>{b(a=>{const r=(a.variants||[]).map((i,n)=>{if(n!==t)return i;const x=i.diamonds||[];return{...i,diamonds:x.filter((p,u)=>u!==s)}});return{...a,variants:r}})},se=(t,s,a,r)=>{b(i=>{const n=(i.variants||[]).map((x,p)=>{if(p!==t)return x;const m=(x.diamonds||[]).map((k,l)=>l!==s?k:{...k,[a]:r});return{...x,diamonds:m}});return{...i,variants:n}})},me=(t,s,a,r)=>{b(i=>{const n=(i.variants||[]).map((x,p)=>{if(p!==t)return x;const m=(x.metals||[]).map((k,l)=>l!==s?k:{...k,[a]:r});return{...x,metals:m}});return{...i,variants:n}})},Le=t=>{const s=[],a=t.selected_metals||[],r=t.metal_configurations||{};a.length>0&&a.forEach(c=>{const w=r[c]||{purities:[],tones:[]},d=w.purities.length>0?w.purities:[null],h=w.tones.length>0?w.tones:[null];d.forEach(M=>{h.forEach(g=>{s.push([{metal_id:c,metal_purity_id:M!==null?M:null,metal_tone_id:g!==null?g:null}])})})});const i=[];t.uses_diamond&&(t.diamond_options||[]).length>0?(t.diamond_options||[]).forEach(c=>{i.push({key:c.key,clarity_id:c.clarity_id!==""?Number(c.clarity_id):null,color_id:c.color_id!==""?Number(c.color_id):null,shape_id:c.shape_id!==""?Number(c.shape_id):null})}):i.push({key:"",clarity_id:null,color_id:null,shape_id:null});const n=t.size_dimension_enabled&&(t.size_values||[]).length>0?t.size_values||[]:[null],x=t.size_dimension_enabled&&(n||[]).length>0&&(n||[])[0]!==null,p=t.uses_diamond&&i.length>0&&i[0].key!=="";if(s.length===0&&!x&&!p)return t;const u=[],m=[];s.length>0?s.forEach(c=>{(n||[]).forEach(w=>{m.push({metals:c,size:w??null})})}):x?n.forEach(c=>{m.push({metals:[],size:c??null})}):m.push({metals:[],size:null});const k=p?i[0]:{key:"",clarity_id:null,color_id:null,shape_id:null};if(m.forEach(c=>{u.push({metals:c.metals,diamond:k,size:c.size})}),u.length===0)return t;const l=new Map;(t.variants||[]).forEach(c=>{if(!c.metals||c.metals.length===0)return;const w=c.metadata?.size_value||"no-size",d=c.diamond_option_key||"no-diamond",M=`${c.metals.filter(g=>g.metal_id!==""&&typeof g.metal_id=="number").map(g=>`${g.metal_id}-${g.metal_purity_id||"null"}-${g.metal_tone_id||"null"}`).sort().join("|")}::${w}::${d}`;l.set(M,{metals:c.metals.map(g=>({metal_id:typeof g.metal_id=="number"?g.metal_id:0,metal_purity_id:g.metal_purity_id!==""&&g.metal_purity_id!==null?typeof g.metal_purity_id=="number"?g.metal_purity_id:Number(g.metal_purity_id):null,metal_tone_id:g.metal_tone_id!==""&&g.metal_tone_id!==null?typeof g.metal_tone_id=="number"?g.metal_tone_id:Number(g.metal_tone_id):null,metal_weight:g.metal_weight||""})),diamonds:(c.diamonds||[]).map(g=>({diamond_id:g.diamond_id!==""&&g.diamond_id!==null?typeof g.diamond_id=="number"?g.diamond_id:Number(g.diamond_id):null,diamonds_count:g.diamonds_count||""}))})});const _=u.map((c,w)=>{const d=_e(w===0),h=c.size||"no-size",M=c.diamond.key||"no-diamond",ae=`${c.metals.map(N=>`${N.metal_id}-${N.metal_purity_id||"null"}-${N.metal_tone_id||"null"}`).sort().join("|")}::${h}::${M}`,E=l.get(ae);if(d.metals=c.metals.map(N=>{const $=E?.metals.find(D=>D.metal_id===N.metal_id&&D.metal_purity_id===(N.metal_purity_id??null)&&D.metal_tone_id===(N.metal_tone_id??null));let L="";if((t.metal_selections||[]).length>0){const D=(t.metal_selections||[]).find(S=>{const V=typeof S.metal_id=="number"?S.metal_id:Number(S.metal_id),H=S.metal_purity_id===""?null:typeof S.metal_purity_id=="number"?S.metal_purity_id:Number(S.metal_purity_id),Ae=S.metal_tone_id===""?null:typeof S.metal_tone_id=="number"?S.metal_tone_id:Number(S.metal_tone_id);return V===N.metal_id&&H===(N.metal_purity_id??null)&&Ae===(N.metal_tone_id??null)});D&&(L=D.weight||"")}return{id:void 0,metal_id:N.metal_id,metal_purity_id:N.metal_purity_id??"",metal_tone_id:N.metal_tone_id??"",metal_weight:$?.metal_weight||L||""}}),c.metals.length>0){const N=c.metals[0];d.metal_id=N.metal_id,N.metal_purity_id!==null&&(d.metal_purity_id=N.metal_purity_id)}d.diamond_option_key=null,(t.diamond_selections||[]).length>0?d.diamonds=(t.diamond_selections||[]).map(N=>{const $=E?.diamonds.find(L=>L.diamond_id===(N.diamond_id!==""&&N.diamond_id!==null?typeof N.diamond_id=="number"?N.diamond_id:Number(N.diamond_id):null));return{id:$?.id,diamond_id:N.diamond_id!==""&&N.diamond_id!==null?typeof N.diamond_id=="number"?N.diamond_id:Number(N.diamond_id):"",diamonds_count:$?.diamonds_count||N.count||""}}):d.diamonds=[];const P={...d.metadata??{},status:"enabled"};return c.size?(P.size_value=c.size,P.size_unit=t.size_unit):(delete P.size_value,delete P.size_unit),d.diamond_option_key&&(P.diamond_option_key=d.diamond_option_key),d.metadata=P,d}),y={...t,variants:_};return y.variants=R(y),y},ue=()=>{b(t=>Le(t))},De=t=>{t.preventDefault();const s=(U.data.media_uploads?.length??0)>0;U.transform(r=>{const i=r,n={...i};i.media_uploads&&Array.isArray(i.media_uploads)&&i.media_uploads.length>0&&(n.media_uploads=i.media_uploads),n.sku=i.sku||"",n.name=i.name||"",n.titleline=i.titleline||null,n.collection=i.collection||null,n.producttype=i.producttype||null,n.gender=i.gender||null,n.description=i.description||"";const x=i.brand_id;if(x!==""&&x!==null&&x!==void 0){const m=Number(x);n.brand_id=isNaN(m)?null:m}else n.brand_id=null;const p=i.category_id;if(p!==""&&p!==null&&p!==void 0){const m=Number(p);n.category_id=isNaN(m)?null:m}else n.category_id=null;const u=i.making_charge_types||[];if(u.includes("fixed")){const m=i.making_charge_amount;if(m===""||m===null||m===void 0)n.making_charge_amount=0;else{const k=Number(m);n.making_charge_amount=isNaN(k)?0:k}}else n.making_charge_amount=0;if(u.includes("percentage")){const m=i.making_charge_percentage;if(m===""||m===null||m===void 0)n.making_charge_percentage=null;else{const k=Number(m);n.making_charge_percentage=isNaN(k)?null:k}}else n.making_charge_percentage=null;return n.is_active=i.is_active??!0,delete n.metadata,(!n.media_uploads||Array.isArray(n.media_uploads)&&n.media_uploads.length===0)&&delete n.media_uploads,(!n.removed_media_ids||Array.isArray(n.removed_media_ids)&&n.removed_media_ids.length===0)&&delete n.removed_media_ids,n.sku||(n.sku=""),n.name||(n.name=""),n.brand_id===void 0&&(n.brand_id=null),n.category_id===void 0&&(n.category_id=null),n.making_charge_amount===void 0&&(n.making_charge_amount=0),i.variants&&Array.isArray(i.variants)?n.variants=i.variants:n.variants=[],i.diamond_selections!==void 0&&(n.diamond_selections=i.diamond_selections),f?.id&&s&&(n._method="PUT"),n});const a={preserveScroll:!0,forceFormData:s,onFinish:()=>{U.transform(r=>r)}};f?.id?s?v(route("admin.products.update",f.id),a):z(route("admin.products.update",f.id),a):v(route("admin.products.store"),a)},xe=j.variants,pe=C.useMemo(()=>Object.entries(j??{}).filter(([t])=>t.startsWith("media_uploads")).map(([,t])=>t),[j]),he=C.useMemo(()=>f?.media?[...f.media].sort((t,s)=>t.display_order-s.display_order):[],[f?.media]),Ee=t=>{const s=o.removed_media_ids??[],r=s.includes(t)?s.filter(i=>i!==t):[...s,t];b("removed_media_ids",r)},Ve=t=>{const s=t.target.files?Array.from(t.target.files):[];s.length!==0&&(b("media_uploads",[...o.media_uploads??[],...s]),t.target.value="")},Pe=t=>{b("media_uploads",(o.media_uploads??[]).filter((s,a)=>a!==t))},fe=t=>(o.removed_media_ids??[]).includes(t);return e.jsxs(Ue,{children:[e.jsx(Be,{title:f?.id?`Edit ${f.name}`:"New Product"}),e.jsxs("form",{onSubmit:De,className:"space-y-10",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-xl shadow-slate-900/10",children:[e.jsxs("div",{className:"flex flex-col gap-4 border-b border-slate-100 pb-6 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:f?.id?"Update product":"Create product"}),e.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Define product master information and atelier references."})]}),e.jsx("button",{type:"submit",disabled:X,className:"inline-flex items-center gap-2 rounded-full bg-slate-900 px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-slate-900/20 transition hover:bg-slate-700 disabled:cursor-not-allowed disabled:opacity-60",children:X?"Saving…":f?.id?"Save changes":"Create product"})]}),e.jsx("div",{className:"mt-6 space-y-6",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"SKU *"}),e.jsx("input",{type:"text",value:o.sku,onChange:t=>b("sku",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200"}),j.sku&&e.jsx("span",{className:"text-xs text-rose-500",children:j.sku})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Product name *"}),e.jsx("input",{type:"text",value:o.name,onChange:t=>b("name",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200"}),j.name&&e.jsx("span",{className:"text-xs text-rose-500",children:j.name})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Title Line *"}),e.jsx("input",{type:"text",value:o.titleline,onChange:t=>b("titleline",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Enter product title line"}),j.titleline&&e.jsx("span",{className:"text-xs text-rose-500",children:j.titleline})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Brand *"}),e.jsxs("select",{value:o.brand_id,onChange:t=>b("brand_id",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[e.jsx("option",{value:"",children:"Select brand"}),Object.entries(I).map(([t,s])=>e.jsx("option",{value:t,children:s},t))]}),j.brand_id&&e.jsx("span",{className:"text-xs text-rose-500",children:j.brand_id})]}),e.jsx(Re,{catalogs:F,selectedIds:Array.isArray(o.catalog_ids)?o.catalog_ids:[],onChange:t=>b("catalog_ids",t),error:j.catalog_ids})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Category *"}),e.jsxs("select",{value:o.category_id,onChange:t=>b("category_id",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[e.jsx("option",{value:"",children:"Select category"}),(G||[]).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),j.category_id&&e.jsx("span",{className:"text-xs text-rose-500",children:j.category_id})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Collection *"}),e.jsx("input",{type:"text",value:o.collection,onChange:t=>b("collection",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Enter collection name"}),j.collection&&e.jsx("span",{className:"text-xs text-rose-500",children:j.collection})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Product Type *"}),e.jsx("input",{type:"text",value:o.producttype,onChange:t=>b("producttype",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Enter product type"}),j.producttype&&e.jsx("span",{className:"text-xs text-rose-500",children:j.producttype})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Gender *"}),e.jsxs("select",{value:o.gender,onChange:t=>b("gender",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[e.jsx("option",{value:"",children:"Select gender"}),e.jsx("option",{value:"Men",children:"Men"}),e.jsx("option",{value:"Women",children:"Women"}),e.jsx("option",{value:"Unisex",children:"Unisex"}),e.jsx("option",{value:"Kids",children:"Kids"})]}),j.gender&&e.jsx("span",{className:"text-xs text-rose-500",children:j.gender})]}),e.jsxs("div",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{className:"mb-2 block",children:"Making Charge *"}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o.making_charge_types?.includes("fixed")??!1,onChange:t=>{const s=o.making_charge_types||[];t.target.checked?b("making_charge_types",[...s,"fixed"]):b("making_charge_types",s.filter(a=>a!=="fixed"))},className:"h-5 w-5 rounded border-slate-300 text-elvee-blue focus:ring-2 focus:ring-elvee-blue focus:ring-offset-0"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Fixed Amount"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o.making_charge_types?.includes("percentage")??!1,onChange:t=>{const s=o.making_charge_types||[];t.target.checked?b("making_charge_types",[...s,"percentage"]):b("making_charge_types",s.filter(a=>a!=="percentage"))},className:"h-5 w-5 rounded border-slate-300 text-elvee-blue focus:ring-2 focus:ring-elvee-blue focus:ring-offset-0"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Percentage"})]})]})]}),j.making_charge_types&&(!o.making_charge_types||o.making_charge_types.length===0)&&e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"block text-xs text-rose-500",children:j.making_charge_types})}),(o.making_charge_types?.includes("fixed")??!1)&&e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsxs("span",{children:["Making Charge (₹) ",o.making_charge_types?.includes("percentage")??!1?"":"*"]}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:o.making_charge_amount,onChange:t=>b("making_charge_amount",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Enter fixed making charge"}),j.making_charge_amount&&e.jsx("span",{className:"text-xs text-rose-500",children:j.making_charge_amount})]}),(o.making_charge_types?.includes("percentage")??!1)&&e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsxs("span",{children:["Making Charge Percentage (%) ",o.making_charge_types?.includes("fixed")??!1?"":"*"]}),e.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:o.making_charge_percentage,onChange:t=>b("making_charge_percentage",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Enter percentage (e.g., 10 for 10%)"}),e.jsx("span",{className:"text-xs text-slate-500",children:"Percentage will be calculated on metal cost"}),j.making_charge_percentage&&e.jsx("span",{className:"text-xs text-rose-500",children:j.making_charge_percentage})]}),j.making_charge_types&&o.making_charge_types&&o.making_charge_types.length>0&&e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"block text-xs text-rose-500",children:j.making_charge_types})})]})]})})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-xl shadow-slate-900/10",children:[e.jsx("div",{className:"flex flex-col gap-3 border-b border-slate-100 pb-4 lg:flex-row lg:items-center lg:justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Product description"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Provide merchandising copy, craftsmanship details, and any atelier notes for this SKU."})]})}),e.jsxs("div",{className:"mt-6",children:[e.jsx(Fe,{value:ne,onChange:ge,className:"overflow-hidden rounded-3xl border border-slate-200",placeholder:"Detail the design notes, materials, finish, and atelier craftsmanship."}),j.description&&e.jsx("span",{className:"mt-2 block text-xs text-rose-500",children:j.description})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-xl shadow-slate-900/10",children:[e.jsx("div",{className:"flex flex-col gap-4 border-b border-slate-100 pb-4 lg:flex-row lg:items-center lg:justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Product media"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Upload product images or videos for catalogue displays. You can also remove outdated media assets."})]})}),e.jsxs("div",{className:"mt-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-slate-400",children:"Current media"}),e.jsx("div",{className:"mt-3 grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:he.length>0?he.map(t=>e.jsxs("div",{className:`relative overflow-hidden rounded-3xl border border-slate-200 bg-slate-50 shadow-sm transition ${fe(t.id)?"opacity-50 ring-2 ring-rose-200":""}`,children:[t.type==="video"?e.jsx("video",{src:t.url,className:"h-48 w-full rounded-t-3xl bg-black object-cover",controls:!0,onError:s=>{console.error("Video load error:",t.url),s.target.style.display="none"},children:"Your browser does not support the video tag."}):e.jsx("img",{src:t.url,alt:"Product media",className:"h-48 w-full rounded-t-3xl object-cover",onError:s=>{console.error("Image load error:",t.url),s.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Crect fill="%23ddd" width="400" height="300"/%3E%3Ctext fill="%23999" font-family="sans-serif" font-size="18" x="50%25" y="50%25" text-anchor="middle" dy=".3em"%3EImage not found%3C/text%3E%3C/svg%3E'}}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 text-xs text-slate-500",children:[e.jsx("span",{className:"rounded-full bg-white/70 px-3 py-1 font-semibold text-slate-700",children:t.type.toUpperCase()}),e.jsx("button",{type:"button",onClick:()=>Ee(t.id),className:"text-rose-500 transition hover:text-rose-600",children:fe(t.id)?"Undo removal":"Remove"})]})]},t.id)):e.jsx("p",{className:"rounded-2xl border border-dashed border-slate-200 px-4 py-6 text-sm text-slate-500",children:"No media uploaded yet."})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-slate-400",children:"Upload new files"}),e.jsxs("label",{className:"mt-3 flex cursor-pointer flex-col items-center justify-center gap-3 rounded-3xl border border-dashed border-slate-300 bg-slate-50 px-6 py-10 text-center text-slate-500 transition hover:border-slate-400 hover:bg-slate-100",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-slate-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 15a4 4 0 014-4h10a4 4 0 014 4v3a2 2 0 01-2 2H5a2 2 0 01-2-2v-3z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 10l5-5m0 0l5 5m-5-5v12"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-700",children:"Click to upload"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"JPEG, PNG, WebP, MP4 up to 50MB each."})]}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*,video/*",onChange:Ve,className:"hidden"})]}),pe.length>0&&e.jsx("ul",{className:"mt-3 space-y-1",children:pe.map((t,s)=>e.jsx("li",{className:"text-xs text-rose-500",children:t},`${s}-${t}`))}),(o.media_uploads??[]).length>0&&e.jsx("ul",{className:"mt-4 space-y-2",children:(o.media_uploads??[]).map((t,s)=>e.jsxs("li",{className:"flex items-center justify-between rounded-2xl border border-slate-200 px-4 py-2 text-sm text-slate-600",children:[e.jsx("span",{className:"truncate",children:t.name}),e.jsx("button",{type:"button",onClick:()=>Pe(s),className:"text-rose-500 transition hover:text-rose-600",children:"Remove"})]},`${t.name}-${s}`))})]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-xl shadow-slate-900/10",children:[e.jsx("div",{className:"flex flex-col gap-3 border-b border-slate-100 pb-4 lg:flex-row lg:items-center lg:justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Variant configuration"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Decide whether this product uses a single price or multiple combinations across metals and diamonds."})]})}),e.jsxs("div",{className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-2",children:"Variant Configuration Options"}),e.jsx("p",{className:"text-xs text-slate-600 mb-4",children:"Use the configuration buttons in the variant table below to add metals (with purity and tone) and diamonds to each variant."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-sky-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 13h8l-4-4m0 8l4-4"})}),e.jsx("span",{className:"text-slate-700",children:"Configure Metals"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-sky-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),e.jsx("span",{className:"text-slate-700",children:"Configure Diamonds"})]})]})]}),e.jsxs("div",{className:"space-y-4 rounded-2xl border border-slate-200 p-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-slate-500",children:"Size dimension"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Maintain consistent size data across variants. Add numeric values and choose the preferred unit."})]}),e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[e.jsx("input",{type:"checkbox",checked:o.size_dimension_enabled,onChange:t=>Ne(t.target.checked),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),"Use size dimension"]})]}),o.size_dimension_enabled&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:[e.jsx("span",{children:"Unit"}),e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[e.jsx("input",{type:"radio",name:"size-unit",value:"mm",checked:o.size_unit==="mm",onChange:()=>de("mm"),className:"h-4 w-4 border-slate-300 text-sky-600 focus:ring-sky-500"}),"Millimetres (mm)"]}),e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[e.jsx("input",{type:"radio",name:"size-unit",value:"cm",checked:o.size_unit==="cm",onChange:()=>de("cm"),className:"h-4 w-4 border-slate-300 text-sky-600 focus:ring-sky-500"}),"Centimetres (cm)"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",step:"0.001",min:"0",value:le,onChange:t=>re(t.target.value),className:"w-24 rounded-2xl border border-slate-200 px-3 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:`e.g. 25${o.size_unit}`}),e.jsx("button",{type:"button",onClick:ve,className:"inline-flex items-center gap-2 rounded-full border border-slate-300 px-4 py-1.5 text-xs font-semibold uppercase tracking-[0.2em] text-slate-600 transition hover:border-slate-400 hover:text-slate-900",children:"Add size"})]}),(o.size_values||[]).length===0&&e.jsx("span",{className:"text-xs text-slate-400",children:"Add at least one size value to use in the variant matrix."})]}),(o.size_values||[]).length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:(o.size_values||[]).map(t=>e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-slate-50 px-3 py-1 text-xs font-semibold text-slate-600",children:[t,o.size_unit,e.jsx("button",{type:"button",onClick:()=>ke(t),className:"text-rose-500 transition hover:text-rose-600","aria-label":`Remove size ${t}${o.size_unit}`,children:"×"})]},`${t}-${o.size_unit}`))})]})]}),e.jsxs("div",{className:"space-y-4 rounded-2xl border border-slate-200 p-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-slate-500",children:"Metals"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Select metals that can be used in your product variants."})]}),e.jsx("div",{className:"flex flex-wrap gap-3",children:T.map(t=>{const s=(o.selected_metals||[]).includes(t.id);return e.jsxs("label",{className:`
                                                    inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-medium transition-all cursor-pointer
                                                    ${s?"bg-sky-600 text-white shadow-sm":"border border-slate-200 bg-white text-slate-700 hover:border-slate-300"}
                                                `,children:[e.jsx("input",{type:"checkbox",checked:s,onChange:a=>{b(r=>{const i=r.selected_metals||[],n=a.target.checked?[...i,t.id]:i.filter(p=>p!==t.id),x={...r.metal_configurations||{}};return a.target.checked?x[t.id]||(x[t.id]={purities:[],tones:[]}):delete x[t.id],{...r,selected_metals:n,metal_configurations:x}})},className:`mr-2 h-4 w-4 rounded border-2 ${s?"border-white bg-white text-sky-600":"border-slate-300 bg-white text-slate-700"} focus:ring-2 focus:ring-sky-500 focus:ring-offset-0`}),t.name]},t.id)})}),e.jsx("div",{className:"space-y-4",children:T.map(t=>{if(!(o.selected_metals||[]).includes(t.id))return null;const a=(o.metal_configurations||{})[t.id]||{purities:[],tones:[]},r=B.filter(u=>u.metal_id===t.id),i=q.filter(u=>u.metal_id===t.id),n=a.purities.length>0?a.purities.length:r.length>0?r.length:1,x=a.tones.length>0?a.tones.length:i.length>0?i.length:1,p=n*x;return e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("h4",{className:"text-sm font-semibold text-slate-900",children:["Metal: ",t.name]}),p>0&&e.jsxs("span",{className:"text-xs font-medium text-sky-600",children:[p," variant",p!==1?"s":""," for this metal"]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"mb-3 text-xs text-slate-600",children:["Choose all purities in which this design is available for ",t.name,"."]}),e.jsx("div",{className:"flex flex-wrap gap-3",children:r.map(u=>{const m=a.purities.includes(u.id);return e.jsxs("label",{className:`
                                                                        inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-medium transition-all cursor-pointer
                                                                        ${m?"bg-sky-600 text-white shadow-sm":"border border-slate-200 bg-white text-slate-700 hover:border-slate-300"}
                                                                    `,children:[e.jsx("input",{type:"checkbox",checked:m,onChange:k=>{b(l=>{const _={...l.metal_configurations||{}};_[t.id]||(_[t.id]={purities:[],tones:[]});const y=_[t.id].purities||[];return _[t.id].purities=k.target.checked?[...y,u.id]:y.filter(c=>c!==u.id),{...l,metal_configurations:_}})},className:`mr-2 h-4 w-4 rounded border-2 ${m?"border-white bg-white text-sky-600":"border-slate-300 bg-white text-slate-700"} focus:ring-2 focus:ring-sky-500 focus:ring-offset-0`}),u.name]},u.id)})})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"mb-3 text-xs text-slate-600",children:["Choose all tones in which this design is available for ",t.name,"."]}),e.jsx("div",{className:"flex flex-wrap gap-3",children:i.map(u=>{const m=a.tones.includes(u.id);return e.jsxs("label",{className:`
                                                                        inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-medium transition-all cursor-pointer
                                                                        ${m?"bg-sky-600 text-white shadow-sm":"border border-slate-200 bg-white text-slate-700 hover:border-slate-300"}
                                                                    `,children:[e.jsx("input",{type:"checkbox",checked:m,onChange:k=>{b(l=>{const _={...l.metal_configurations||{}};_[t.id]||(_[t.id]={purities:[],tones:[]});const y=_[t.id].tones||[];return _[t.id].tones=k.target.checked?[...y,u.id]:y.filter(c=>c!==u.id),{...l,metal_configurations:_}})},className:`mr-2 h-4 w-4 rounded border-2 ${m?"border-white bg-white text-sky-600":"border-slate-300 bg-white text-slate-700"} focus:ring-2 focus:ring-sky-500 focus:ring-offset-0`}),u.name]},u.id)})})]})]},t.id)})})]}),(()=>{const t=o.selected_metals||[],s=o.metal_configurations||{};let a=0;t.forEach(x=>{const p=s[x]||{purities:[],tones:[]},u=B.filter(_=>_.metal_id===x),m=q.filter(_=>_.metal_id===x),k=p.purities.length>0?p.purities.length:u.length>0?u.length:1,l=p.tones.length>0?p.tones.length:m.length>0?m.length:1;a+=k*l});const r=o.size_dimension_enabled&&(o.size_values||[]).length>0?(o.size_values||[]).length:1,i=(o.diamond_selections||[]).length>0?(o.diamond_selections||[]).length:1,n=a>0?a*r*i:r*i;return t.length>0||o.size_dimension_enabled||(o.diamond_selections||[]).length>0?e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Preview generated variants"}),e.jsxs("p",{className:"mt-1 text-xs text-slate-600",children:["This setup will generate approximately ",n," variant",n!==1?"s":""," based on your current configuration."]})]}),e.jsx("button",{type:"button",onClick:ue,className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-white px-4 py-2 text-sm font-semibold text-slate-700 transition hover:border-slate-400 hover:bg-slate-50",children:"Regenerate matrix"})]})}):null})(),e.jsxs("div",{className:"space-y-4 rounded-2xl border border-slate-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-slate-500",children:"Diamonds"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Select diamonds and specify counts for your product variants."})]}),e.jsxs("button",{type:"button",onClick:we,className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-white px-3 py-1.5 text-xs font-semibold text-slate-700 transition hover:border-sky-400 hover:bg-sky-50",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 5v14M5 12h14"})}),"Add Diamond"]})]}),(o.diamond_selections||[]).length>0?e.jsx("div",{className:"space-y-3",children:(o.diamond_selections||[]).map((t,s)=>e.jsxs("div",{className:"flex items-center gap-3 rounded-xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"mb-1 block text-xs font-semibold text-slate-600",children:"Diamond"}),e.jsxs("select",{value:t.diamond_id===""?"":t.diamond_id,onChange:a=>ce(s,"diamond_id",a.target.value===""?"":Number(a.target.value)),className:"w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[e.jsx("option",{value:"",children:"Select diamond"}),W.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{className:"w-32",children:[e.jsx("label",{className:"mb-1 block text-xs font-semibold text-slate-600",children:"Count"}),e.jsx("input",{type:"number",min:"0",step:"1",value:t.count,onChange:a=>ce(s,"count",a.target.value),className:"w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"0"})]}),e.jsx("button",{type:"button",onClick:()=>Ce(s),className:"mt-6 rounded-full border border-rose-200 p-2 text-rose-600 transition hover:border-rose-300 hover:text-rose-700","aria-label":"Remove diamond",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]},s))}):e.jsx("p",{className:"text-xs text-slate-400",children:'No diamonds added. Click "Add Diamond" to add one.'})]})]})]}),e.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl shadow-slate-900/10 ring-1 ring-slate-200/80",children:[e.jsxs("div",{className:"flex flex-col gap-4 border-b border-slate-200 pb-6 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-900",children:"Variant Matrix"}),e.jsx("p",{className:"mt-2 text-sm text-slate-500",children:"Configure product variants with metals and diamonds. The default variant powers the customer catalogue card pricing."})]}),e.jsxs("button",{type:"button",onClick:ue,className:"inline-flex items-center gap-2 rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-slate-900/20 transition hover:bg-slate-700",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h7"})}),"Generate Matrix"]})]}),xe&&e.jsx("div",{className:"mt-6 rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-600 ring-1 ring-rose-200/50",children:xe}),e.jsx("div",{className:"mt-8 overflow-hidden rounded-3xl bg-white shadow-xl shadow-slate-900/10 ring-1 ring-slate-200/80",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-5 py-3 text-left min-w-[150px]",children:"SKU"}),e.jsx("th",{className:"px-5 py-3 text-left min-w-[300px]",children:"Variant Label"}),e.jsx("th",{className:"px-5 py-3 text-left min-w-[250px]",children:"Metal"}),e.jsx("th",{className:"px-5 py-3 text-left min-w-[250px]",children:"Diamonds"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Inventory Quantity"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Status"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Default"}),e.jsx("th",{className:"px-5 py-3 text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100 bg-white",children:[(o.variants||[]).map((t,s)=>{const a=te(t,o);a.metalTone;const r=(t.metals||[]).filter(l=>l.metal_id!==""&&l.metal_id!==null&&typeof l.metal_id=="number");r.reduce((l,_)=>{const y=parseFloat(_.metal_weight||"0");return l+(isNaN(y)?0:y)},0);const i=new Map;r.forEach(l=>{const _=l.metal_id;i.has(_)||i.set(_,[]),i.get(_).push({metal_id:_,metal_purity_id:l.metal_purity_id!==""&&l.metal_purity_id!==null?typeof l.metal_purity_id=="number"?l.metal_purity_id:Number(l.metal_purity_id):null,metal_tone_id:l.metal_tone_id!==""&&l.metal_tone_id!==null?typeof l.metal_tone_id=="number"?l.metal_tone_id:Number(l.metal_tone_id):null})});const n=[],x=[];i.forEach((l,_)=>{const y=O[_]||"",c=new Set,w=new Set;if(l.forEach(d=>{if(d.metal_purity_id!==null){const h=typeof d.metal_purity_id=="number"?d.metal_purity_id:Number(d.metal_purity_id);Number.isFinite(h)&&c.add(h)}if(d.metal_tone_id!==null){const h=typeof d.metal_tone_id=="number"?d.metal_tone_id:Number(d.metal_tone_id);Number.isFinite(h)&&w.add(h)}}),c.size>0){const d=Array.from(c).map(h=>{const M=typeof h=="number"?h:Number(h);return Number.isFinite(M)&&K[M]||""}).filter(Boolean).sort();d.length>0&&(c.size>1?n.push(`${d.join(" + ")} (${y})`):n.push(`${d[0]} (${y})`))}if(w.size>0){const d=Array.from(w).map(h=>{const M=typeof h=="number"?h:Number(h);return Number.isFinite(M)&&Q[M]||""}).filter(Boolean).sort();d.length>0&&(w.size>1?x.push(`${d.join(" + ")} (${y})`):x.push(`${d[0]} (${y})`))}});let p=[];const u=(t.diamonds||[]).filter(l=>l.diamond_id!==""&&l.diamond_id!==null&&l.diamond_id!==void 0).map(l=>({diamond_id:typeof l.diamond_id=="number"?l.diamond_id:Number(l.diamond_id),diamonds_count:l.diamonds_count||""}));u.length>0?p=u:(t.diamonds||[]).length>0?p=(t.diamonds||[]).map(l=>({diamond_id:null,diamonds_count:l.diamonds_count||""})):(o.diamond_selections||[]).length>0&&(p=(o.diamond_selections||[]).filter(l=>l.diamond_id!==""&&l.diamond_id!==null&&l.diamond_id!==void 0).map(l=>({diamond_id:typeof l.diamond_id=="number"?l.diamond_id:Number(l.diamond_id),diamonds_count:l.count||""})));const m=t.metadata??{};(typeof m.size_value=="string"||typeof m.size_value=="number")&&String(m.size_value),(m.size_unit==="mm"||m.size_unit==="cm")&&m.size_unit;const k=typeof m.status=="string"&&m.status.trim().length>0?String(m.status):"enabled";return a.autoLabel,e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:`hover:bg-slate-50 ${k==="disabled"?"opacity-70":""} ${t.is_default?"bg-sky-50/30":""}`,children:[e.jsxs("td",{className:"px-5 py-3 align-middle min-w-[150px]",children:[e.jsx("input",{type:"text",value:t.sku,onChange:l=>ee(s,"sku",l.target.value),className:"w-full min-w-[120px] rounded-xl border border-slate-200 px-3 py-1.5 text-sm text-slate-700 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Variant SKU"}),j[`variants.${s}.sku`]&&e.jsx("p",{className:"mt-1 text-xs text-rose-500",children:j[`variants.${s}.sku`]})]}),e.jsxs("td",{className:"px-5 py-3 align-middle min-w-[300px]",children:[e.jsx("input",{type:"text",value:t.label,onChange:l=>ee(s,"label",l.target.value),className:"w-full min-w-[280px] rounded-xl border border-slate-200 px-3 py-1.5 text-sm text-slate-700 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Display label"}),j[`variants.${s}.label`]&&e.jsx("p",{className:"mt-1 text-xs text-rose-500",children:j[`variants.${s}.label`]})]}),e.jsx("td",{className:"px-5 py-3 align-middle text-slate-700",children:e.jsx("div",{className:"space-y-3 min-w-[250px]",children:r.length>0?r.map((l,_)=>{const y=O[l.metal_id]||"Unknown Metal",c=l.metal_purity_id&&typeof l.metal_purity_id=="number"&&B.find(h=>h.id===l.metal_purity_id)?.name||"",w=l.metal_tone_id&&typeof l.metal_tone_id=="number"&&q.find(h=>h.id===l.metal_tone_id)?.name||"",d=l.metal_weight||"";return e.jsxs("div",{className:"flex flex-col gap-2 rounded-lg border border-slate-200 bg-slate-50/50 p-3",children:[e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-medium text-slate-500 mb-1",children:"Metal"}),e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:y})]}),e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-medium text-slate-500 mb-1",children:"Purity"}),e.jsx("div",{className:"text-sm text-slate-700",children:c||"—"})]}),e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-medium text-slate-500 mb-1",children:"Tone"}),e.jsx("div",{className:"text-sm text-slate-700",children:w||"—"})]}),e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-medium text-slate-500 mb-1.5",children:"Weight (g)"}),e.jsx("input",{type:"number",step:"0.001",min:"0.001",required:!0,value:d,onChange:h=>{const M=h.target.value;me(s,_,"metal_weight",M)},className:`w-full rounded-lg border px-2.5 py-1.5 text-sm font-mono transition-colors ${!d||d===""?"border-rose-300 bg-rose-50 text-rose-500 focus:border-rose-400 focus:bg-white":"border-slate-200 bg-white text-slate-700 focus:border-sky-400"} focus:outline-none focus:ring-1 focus:ring-sky-200`,placeholder:"0.000"}),(!d||d==="")&&e.jsx("span",{className:"mt-1 text-[10px] text-rose-500",children:"Required"})]})]},_)}):e.jsx("span",{className:"text-sm text-slate-400",children:"—"})})}),e.jsx("td",{className:"px-5 py-3 align-middle text-slate-700",children:e.jsx("div",{className:"space-y-3 min-w-[250px]",children:p.length>0?p.map((l,_)=>{const y=l.diamond_id&&W?.find(w=>w.id===l.diamond_id)?.name||"Diamond",c=l.diamonds_count||"";return e.jsxs("div",{className:"flex items-center gap-3 rounded-lg border border-slate-200 bg-slate-50/50 p-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs font-medium text-slate-500 mb-1",children:"Diamond"}),e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:y})]}),e.jsxs("div",{className:"w-24",children:[e.jsx("div",{className:"text-xs font-medium text-slate-500 mb-1",children:"Count"}),e.jsx("input",{type:"number",min:"1",step:"1",required:!0,value:c,onChange:w=>{const d=w.target.value;se(s,_,"diamonds_count",d)},className:`w-full rounded-lg border px-2.5 py-1.5 text-sm font-mono transition-colors ${!c||c===""?"border-rose-300 bg-rose-50 text-rose-500 focus:border-rose-400 focus:bg-white":"border-slate-200 bg-white text-slate-700 focus:border-sky-400"} focus:outline-none focus:ring-1 focus:ring-sky-200`,placeholder:"0"})]})]},_)}):e.jsx("span",{className:"text-sm text-slate-400",children:"—"})})}),e.jsx("td",{className:"px-5 py-3 align-middle text-slate-700",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("input",{type:"number",min:"0",step:"1",required:!0,value:t.inventory_quantity!==void 0&&t.inventory_quantity!==null&&t.inventory_quantity!==""?String(t.inventory_quantity):"",onChange:l=>{const _=l.target.value.trim();if(_==="")ee(s,"inventory_quantity","");else{const y=parseInt(_,10);!isNaN(y)&&y>=0&&ee(s,"inventory_quantity",y)}},className:`w-full min-w-[100px] rounded-xl border px-3 py-1.5 text-sm text-slate-700 transition-colors ${t.inventory_quantity===void 0||t.inventory_quantity===null||t.inventory_quantity===""?"border-rose-300 bg-rose-50 text-rose-500 focus:border-rose-400 focus:bg-white":"border-slate-200 bg-white focus:border-sky-400"} focus:outline-none focus:ring-2 focus:ring-sky-200`,placeholder:"0"}),(t.inventory_quantity===void 0||t.inventory_quantity===null||t.inventory_quantity==="")&&e.jsx("span",{className:"text-[10px] text-rose-500",children:"Required"})]})}),e.jsx("td",{className:"px-5 py-3 text-slate-700",children:e.jsxs("select",{value:k,onChange:l=>Se(s,{status:l.target.value}),className:`rounded-xl border px-3 py-1.5 text-sm text-slate-700 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200 ${k==="enabled"?"border-emerald-300 bg-emerald-50":"border-amber-300 bg-amber-50"}`,children:[e.jsx("option",{value:"enabled",children:"Enabled"}),e.jsx("option",{value:"disabled",children:"Disabled"})]})}),e.jsx("td",{className:"px-5 py-3 text-slate-700",children:e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[e.jsx("input",{type:"radio",name:"default-variant-table",checked:t.is_default,onChange:()=>Me(s),className:"h-4 w-4 text-sky-600 focus:ring-sky-500"}),e.jsx("span",{children:t.is_default?"Default":"Set default"})]})}),e.jsx("td",{className:"px-5 py-3 text-right",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx("button",{type:"button",onClick:()=>ze(s),className:"inline-flex items-center justify-center rounded-full border border-rose-200 p-1.5 text-rose-600 transition hover:border-rose-300 hover:text-rose-700","aria-label":"Remove variant",title:"Remove Variant",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,className:"h-4 w-4",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 7h12m-9 3v6m6-6v6M10 4h4a1 1 0 0 1 1 1v1H9V5a1 1 0 0 1 1-1Z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 7h14l-.8 11.2A2 2 0 0 1 16.2 20H7.8a2 2 0 0 1-1.99-1.8L5 7Z"})]})})})})]},t.id??`variant-${s}`),ye.has(s)&&e.jsx("tr",{children:e.jsx("td",{colSpan:13,className:"px-5 py-4",children:e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Metals for this Variant"}),e.jsxs("p",{className:"mt-1 text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold text-rose-600",children:"Required:"})," Enter metal weight (in grams) for each metal in this variant."]})]})}),r.length===0?e.jsx("p",{className:"text-xs text-slate-400",children:"No metals assigned to this variant."}):e.jsx("div",{className:"space-y-3",children:r.map((l,_)=>{const y=O[l.metal_id]||"Unknown Metal",c=l.metal_purity_id&&typeof l.metal_purity_id=="number"&&B.find(d=>d.id===l.metal_purity_id)?.name||"",w=l.metal_tone_id&&typeof l.metal_tone_id=="number"&&q.find(d=>d.id===l.metal_tone_id)?.name||"";return e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"mb-3 flex items-center justify-between",children:e.jsxs("span",{className:"text-xs font-semibold text-slate-600",children:[y,c&&` — ${c}`,w&&` — ${w}`]})}),e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:e.jsxs("label",{className:"flex flex-col gap-1.5",children:[e.jsxs("span",{className:"text-xs font-semibold text-slate-700 flex items-center gap-1",children:[e.jsx("span",{children:"Metal Weight (g)"}),e.jsx("span",{className:"text-rose-500 font-bold text-sm",title:"Required field",children:"*"})]}),e.jsx("input",{type:"number",step:"0.001",min:"0.001",required:!0,value:l.metal_weight||"",onChange:d=>{const h=d.target.value;me(s,_,"metal_weight",h)},className:`rounded-xl border-2 px-3 py-2 text-sm font-medium transition-colors ${l.metal_weight?"border-slate-200 bg-white focus:border-sky-400":"border-rose-300 bg-rose-50 focus:border-rose-400 focus:bg-white"} focus:outline-none focus:ring-2 focus:ring-sky-200`,placeholder:"Enter weight (required)"}),!l.metal_weight&&e.jsx("span",{className:"text-xs text-rose-600 font-medium",children:"⚠️ This field is required"})]})})]},_)})})]})})}),be.has(s)&&e.jsx("tr",{children:e.jsx("td",{colSpan:13,className:"px-5 py-4",children:e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Diamonds for this Variant"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"This variant uses the shared diamond list defined above. All variants share the same diamonds."})]})}),p.length===0?e.jsx("p",{className:"text-xs text-slate-400",children:"No diamonds assigned to this variant from the shared matrix."}):e.jsx("div",{className:"space-y-3",children:p.map((l,_)=>e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs font-semibold text-slate-600",children:["Diamond #",_+1]}),e.jsx("button",{type:"button",onClick:()=>$e(s,_),className:"text-xs text-rose-500 transition hover:text-rose-700",children:"Remove"})]}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("label",{className:"flex flex-col gap-1.5 text-xs font-medium text-slate-600",children:["Diamond",e.jsxs("select",{value:typeof l.diamond_id=="string"||!l.diamond_id?"":String(l.diamond_id),onChange:y=>se(s,_,"diamond_id",y.target.value===""?"":Number(y.target.value)),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[e.jsx("option",{value:"",children:"Select diamond"}),(W||[]).map(y=>e.jsx("option",{value:y.id,children:y.name},y.id))]})]}),e.jsxs("label",{className:"flex flex-col gap-1.5 text-xs font-medium text-slate-600",children:["Number of Diamonds",e.jsx("input",{type:"number",step:"1",min:"0",value:l.diamonds_count,onChange:y=>se(s,_,"diamonds_count",y.target.value),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"0"})]})]})]},_))})]})})})]})}),(o.variants||[]).length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:17,className:"px-5 py-6 text-center text-xs uppercase tracking-[0.1em] text-slate-400",children:"No variants configured. Generate matrix to create variants."})})]})]})})})]})]})]})}export{Ge as default};
