import{u as I,r as i,a as H,j as e,H as Q,L as T,b as V}from"./app-UdF9nnLx.js";import{A as B}from"./AuthenticatedLayout-B6KrgYrs.js";import"./FlashMessage-Blu8kqte.js";const k=new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}),S=a=>({gold_purity_id:typeof a?.gold_purity_id=="number"?a.gold_purity_id:null,silver_purity_id:typeof a?.silver_purity_id=="number"?a.silver_purity_id:null,diamond_option_key:typeof a?.diamond_option_key=="string"?a.diamond_option_key:null,size_cm:a?.size_cm!==void 0&&a?.size_cm!==null?typeof a.size_cm=="number"?a.size_cm.toString():String(a.size_cm):null,auto_label:typeof a?.auto_label=="string"?a.auto_label:null});function X(){const{props:a}=I(),{mode:m,product:t,goldPurities:M,silverPurities:D,diamondOptions:q}=a,z=i.useMemo(()=>t.variants.find(s=>s.is_default)??t.variants[0]??null,[t.variants]),g=S(z?.metadata),c=i.useMemo(()=>{const s=t.variants.map(l=>S(l.metadata).size_cm).filter(l=>l!=null&&l!=="");return Array.from(new Set(s))},[t.variants]),[n,O]=i.useState(t.uses_gold?g.gold_purity_id??"":""),[r,F]=i.useState(t.uses_silver?g.silver_purity_id??"":""),[o,A]=i.useState(t.uses_diamond?g.diamond_option_key??"":""),[x,G]=i.useState(c.length>0?g.size_cm??c[0]:""),[P,f]=i.useState(!1),[p,C]=i.useState(!1),{data:d,setData:u,post:E,processing:j,errors:y}=H({product_id:t.id,product_variant_id:z?.id??null,mode:m,quantity:1,notes:"",selections:{gold_purity_id:n===""?null:n,silver_purity_id:r===""?null:r,diamond_option_key:o||null,size_cm:x||null}}),h=i.useMemo(()=>t.variants.find(s=>{const l=S(s.metadata);return!(t.uses_gold&&(l.gold_purity_id??null)!==(n===""?null:n)||t.uses_silver&&(l.silver_purity_id??null)!==(r===""?null:r)||t.uses_diamond&&(l.diamond_option_key??null)!==(o||null)||c.length>0&&(l.size_cm??null)!==(x||null))})??null,[t.variants,t.uses_gold,t.uses_silver,t.uses_diamond,n,r,o,x,c.length]);i.useEffect(()=>{u("product_variant_id",h?.id??null)},[h,u]),i.useEffect(()=>{u("selections",{gold_purity_id:n===""?null:n,silver_purity_id:r===""?null:r,diamond_option_key:o||null,size_cm:x||null})},[n,r,o,x,u]);const v=m==="jobwork",_=v&&!t.is_jobwork_allowed,J=i.useMemo(()=>{const s=t.base_price??0,l=t.making_charge??0,b=h?.price_adjustment??0;return s+l+b},[t.base_price,t.making_charge,h]),L=s=>{s.preventDefault(),!(j||N||_)&&f(!0)},$=()=>{j||p||(C(!0),E(route("frontend.quotations.store"),{preserveScroll:!0,onSuccess:()=>f(!1),onFinish:()=>C(!1)}))},R=()=>{const s={product_id:t.id,product_variant_id:d.product_variant_id,quantity:d.quantity,configuration:{mode:m,notes:d.notes,selections:d.selections}};V.post(route("frontend.cart.items.store"),s,{preserveScroll:!0,onSuccess:()=>{f(!1)}})},N=t.variants.length>0&&!h;return e.jsxs(B,{children:[e.jsx(Q,{title:t.name}),e.jsx("div",{className:"space-y-8",children:e.jsxs("div",{className:"grid gap-10 lg:grid-cols-[1.6fr_1fr]",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:t.media.map((s,l)=>e.jsx("div",{className:"overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-lg",children:e.jsx("img",{src:s.url,alt:s.alt,className:"h-64 w-full object-cover transition duration-500 hover:scale-105"})},`${s.url}-${l}`))}),e.jsxs("div",{className:"rounded-3xl bg-white p-8 shadow-xl ring-1 ring-slate-200/80",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:["SKU ",t.sku]}),e.jsx("h1",{className:"mt-2 text-3xl font-semibold text-slate-900",children:t.name}),e.jsxs("p",{className:"mt-3 text-sm text-slate-500",children:["By ",t.brand??"AurumCraft Atelier"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Estimate"}),e.jsx("p",{className:"text-2xl font-semibold text-slate-900",children:k.format(t.base_price??0)}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Making ",k.format(t.making_charge??0)]})]})]}),e.jsx("p",{className:"mt-6 text-sm leading-7 text-slate-600 whitespace-pre-line",children:t.description}),e.jsxs("dl",{className:"mt-6 grid gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 px-4 py-3 text-sm",children:[e.jsx("dt",{className:"text-slate-500",children:"Material"}),e.jsx("dd",{className:"font-semibold text-slate-800",children:t.material??"Custom blend"})]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 px-4 py-3 text-sm",children:[e.jsx("dt",{className:"text-slate-500",children:"Purity"}),e.jsx("dd",{className:"font-semibold text-slate-800",children:t.purity??"On request"})]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 px-4 py-3 text-sm",children:[e.jsx("dt",{className:"text-slate-500",children:"Gross wt."}),e.jsxs("dd",{className:"font-semibold text-slate-800",children:[(t.gross_weight??0).toFixed(2)," g"]})]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 px-4 py-3 text-sm",children:[e.jsx("dt",{className:"text-slate-500",children:"Net wt."}),e.jsxs("dd",{className:"font-semibold text-slate-800",children:[(t.net_weight??0).toFixed(2)," g"]})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("form",{onSubmit:L,className:"w-full space-y-5 rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:v?"Request jobwork quotation":"Request jewellery quotation"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Select your configuration and our merchandising desk will share pricing shortly."})]}),e.jsx("span",{className:"rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold uppercase tracking-[0.3em] text-slate-500",children:v?"Jobwork":"Jewellery"})]}),_&&e.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-sm text-amber-700",children:"This design is not available for jobwork. Switch to Jewellery purchase to request a quotation."}),t.uses_gold&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.3em] text-slate-500",children:"Gold purity"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:M.map(s=>e.jsx("button",{type:"button",onClick:()=>O(s.id),className:`rounded-full px-3 py-1 text-xs font-semibold transition ${n===s.id?"bg-sky-600 text-white shadow-lg shadow-sky-600/30":"bg-slate-200 text-slate-700 hover:bg-slate-300"}`,children:s.name},s.id))})]}),t.uses_silver&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.3em] text-slate-500",children:"Silver purity"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:D.map(s=>e.jsx("button",{type:"button",onClick:()=>F(s.id),className:`rounded-full px-3 py-1 text-xs font-semibold transition ${r===s.id?"bg-sky-600 text-white shadow-lg shadow-sky-600/30":"bg-slate-200 text-slate-700 hover:bg-slate-300"}`,children:s.name},s.id))})]}),t.uses_diamond&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.3em] text-slate-500",children:"Diamond mix"}),e.jsxs("div",{className:"grid gap-2",children:[q.map(s=>e.jsxs("label",{className:`flex cursor-pointer items-center justify-between rounded-2xl border px-4 py-3 text-sm transition ${o===s.key?"border-sky-500 bg-sky-50 text-slate-900":"border-slate-200 bg-white text-slate-600 hover:border-sky-300"}`,children:[e.jsx("span",{children:s.label}),e.jsx("input",{type:"radio",name:"diamond_option_key",value:s.key,checked:o===s.key,onChange:()=>A(s.key),className:"h-4 w-4 text-sky-600 focus:ring-sky-500"})]},s.key)),q.length===0&&e.jsx("p",{className:"text-xs text-slate-400",children:"No predefined diamond mixes for this design."})]})]}),c.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.3em] text-slate-500",children:"Size (cm)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(s=>e.jsx("button",{type:"button",onClick:()=>G(s),className:`rounded-full px-3 py-1 text-xs font-semibold transition ${x===s?"bg-sky-600 text-white shadow-lg shadow-sky-600/30":"bg-slate-200 text-slate-700 hover:bg-slate-300"}`,children:s},s))})]}),N&&e.jsx("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-600",children:"No variant is available for the selected combination. Adjust purity, mix, or size to continue."}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Quantity"}),e.jsx("input",{type:"number",min:1,value:d.quantity,onChange:s=>{const l=Number(s.target.value);u("quantity",Number.isFinite(l)&&l>0?Math.floor(l):1)},className:"w-full rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200"}),y.quantity&&e.jsx("span",{className:"text-xs text-rose-500",children:y.quantity})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Notes for merchandising team"}),e.jsx("textarea",{value:d.notes,onChange:s=>u("notes",s.target.value),className:"min-h-[120px] rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"List required scope: hallmarking, hallmark packaging, diamond certification, delivery deadlines…"}),y.notes&&e.jsx("span",{className:"text-xs text-rose-500",children:y.notes})]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 px-4 py-3 text-sm text-slate-600",children:[e.jsx("p",{className:"font-semibold text-slate-700",children:"Estimated total"}),e.jsx("p",{className:"mt-1 text-xl font-semibold text-slate-900",children:k.format(J)}),e.jsx("p",{className:"text-xs text-slate-500",children:"Includes base & making. Final quotation may vary with bullion/diamond parity and labour."})]}),e.jsx("button",{type:"submit",disabled:j||N||_,className:"w-full rounded-full bg-sky-600 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-sky-600/30 transition hover:bg-sky-500 disabled:cursor-not-allowed disabled:opacity-60",children:"Submit quotation"})]}),e.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:[e.jsx("h3",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-slate-500",children:"Next steps"}),e.jsxs("p",{className:"mt-3 text-sm text-slate-600",children:["Our merchandising team will review the configuration and share pricing or follow-up questions by email. Once you approve, the request moves to production and appears in your ",m==="jobwork"?"jobwork timeline":"orders dashboard","."]}),e.jsxs(T,{href:route("frontend.quotations.index"),className:"mt-4 inline-flex items-center gap-2 text-sm font-semibold text-sky-600 hover:text-sky-500",children:["View all quotations",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7-7 7M21 12H3"})})]})]})]})]})}),P&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 px-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-4 rounded-3xl bg-white p-6 shadow-2xl",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Confirm quotation"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Submit this quotation request with the selected configuration? Our merchandising desk will review and respond shortly."}),e.jsxs("div",{className:"space-y-2 rounded-2xl bg-slate-50 p-4 text-xs text-slate-500",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-slate-700",children:"Mode:"})," ",m==="jobwork"?"Jobwork":"Jewellery"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-slate-700",children:"Quantity:"})," ",d.quantity]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",className:"rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-600 hover:border-slate-400 hover:text-slate-900",onClick:()=>f(!1),disabled:p,children:"Review again"}),e.jsx("button",{type:"button",className:"rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-600 hover:border-slate-400 hover:text-slate-900",onClick:R,disabled:p,children:"Add to quotation list"}),e.jsx("button",{type:"button",className:"rounded-full bg-sky-600 px-4 py-2 text-sm font-semibold text-white shadow-sky-600/30 hover:bg-sky-500 disabled:cursor-not-allowed disabled:opacity-60",onClick:$,disabled:p,children:p?"Submitting…":"Confirm submission"})]})]})})]})}export{X as default};
