import{u as B,r as i,j as e,H as P,b as o,L as W}from"./app-BPfwiKJb.js";import{A as E}from"./AdminLayout-C7QSrqtK.js";const I={pending:"bg-amber-100 text-amber-700",review:"bg-amber-100 text-amber-700",approved:"bg-emerald-100 text-emerald-700",rejected:"bg-rose-100 text-rose-700"};function G(){const{users:s,kycStatuses:g,filters:n,stats:R,customerGroups:b,perPageOptions:k}=B().props,[x,f]=i.useState(n.search??""),[r,p]=i.useState([]),[d,j]=i.useState(s.meta.per_page),[u,v]=i.useState(n.type??""),[m,y]=i.useState(n.customer_group_id?String(n.customer_group_id):""),_=i.useMemo(()=>["all",...g],[g]),S=t=>{const l={search:x||void 0,per_page:d!==s.meta.per_page?d:void 0,customer_group_id:m||void 0,type:u||void 0,status:t==="all"?void 0:t};o.get(route("admin.customers.index"),l,{preserveState:!0,replace:!0,preserveScroll:!0})},w=()=>{o.get(route("admin.customers.index"),{search:x||void 0,status:n.status??void 0,per_page:d,customer_group_id:m||void 0,type:u||void 0},{preserveState:!0,replace:!0,preserveScroll:!0})},C=t=>{p(t?s.data.map(l=>l.id):[])},A=(t,l)=>{p(a=>l?[...a,t]:a.filter(c=>c!==t))},h=()=>p([]),L=()=>{r.length!==0&&window.confirm("Delete selected customers? This cannot be undone.")&&o.delete(route("admin.customers.bulk-destroy"),{data:{ids:r},preserveScroll:!0,onFinish:h})},D=t=>{r.length!==0&&o.post(route("admin.customers.bulk-group-update"),{ids:r,customer_group_id:t||null},{preserveScroll:!0,onFinish:h})},M=t=>{window.confirm("Delete this customer? This action is irreversible.")&&o.delete(route("admin.customers.destroy",t),{preserveScroll:!0})},F=t=>{o.post(route("admin.customers.toggle-status",t.id),{},{preserveScroll:!0})},N=(t,l,a)=>e.jsx("button",{type:"button",onClick:a,className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-slate-200 text-slate-500 transition hover:border-slate-300 hover:text-slate-900",title:l,children:t});return e.jsxs(E,{children:[e.jsx(P,{title:"Customers & KYC"}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("section",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:[e.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500",children:"Search name or email"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:x,onChange:t=>f(t.target.value),placeholder:"Jane Doe or jane@studio.com",className:"w-full rounded-2xl border border-slate-300 px-4 py-2 text-sm text-slate-700 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200"}),e.jsx("button",{type:"button",onClick:w,className:"rounded-2xl bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow shadow-slate-900/20 transition hover:bg-slate-700",children:"Apply"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500",children:"Customer group"}),e.jsxs("select",{value:m,onChange:t=>y(t.target.value),className:"w-full rounded-2xl border border-slate-300 px-4 py-2 text-sm text-slate-700 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[e.jsx("option",{value:"",children:"All groups"}),b.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500",children:"Customer type"}),e.jsxs("select",{value:u,onChange:t=>v(t.target.value),className:"w-full rounded-2xl border border-slate-300 px-4 py-2 text-sm text-slate-700 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[e.jsx("option",{value:"",children:"All types"}),e.jsx("option",{value:"retailer",children:"Retailer"}),e.jsx("option",{value:"wholesaler",children:"Wholesaler"})]})]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3 border-t border-slate-200 pt-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs font-semibold text-slate-600",children:[e.jsx("span",{children:"Status:"}),_.map(t=>{const l=(n.status??"all")===t;return e.jsx("button",{type:"button",onClick:()=>S(t),className:`rounded-full px-3 py-1 transition ${l?"bg-slate-900 text-white shadow shadow-slate-900/20":"bg-slate-100 text-slate-500 hover:bg-slate-200"}`,children:t==="all"?"All":t.replace(/_/g," ")},t)})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[e.jsx("span",{children:"Show"}),e.jsx("select",{value:d,onChange:t=>j(Number(t.target.value)),className:"rounded-xl border border-slate-300 px-3 py-1 text-sm",children:k.map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx("span",{children:"entries"})]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2 text-xs text-slate-500",children:[e.jsx("button",{type:"button",onClick:w,className:"rounded-full border border-slate-200 px-4 py-1.5 font-semibold text-slate-600 hover:border-slate-300 hover:text-slate-900",children:"Apply filters"}),e.jsx("button",{type:"button",onClick:()=>{f(""),y(""),v(""),j(s.meta.per_page),o.get(route("admin.customers.index"))},className:"rounded-full border border-slate-200 px-4 py-1.5 font-semibold text-slate-600 hover:border-slate-300 hover:text-slate-900",children:"Reset"})]})]}),r.length>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-3 rounded-3xl bg-slate-900 px-6 py-4 text-sm text-white shadow-lg shadow-slate-900/20",children:[e.jsxs("span",{children:[r.length," selected"]}),e.jsx("button",{type:"button",onClick:L,className:"inline-flex items-center gap-2 rounded-full bg-rose-500 px-4 py-1.5 text-xs font-semibold text-white shadow shadow-rose-500/20 transition hover:bg-rose-400",children:"Delete selected"}),e.jsxs("select",{className:"rounded-full border border-white/30 bg-white/10 px-3 py-1 text-xs font-semibold text-white focus:border-white focus:outline-none",value:"",onChange:t=>{D(t.target.value)},children:[e.jsx("option",{value:"",children:"Assign to group…"}),b.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("button",{type:"button",onClick:h,className:"text-xs text-white/70 underline-offset-2 hover:underline",children:"Clear selection"})]}),e.jsx("div",{className:"overflow-hidden rounded-3xl bg-white shadow-xl shadow-slate-900/10 ring-1 ring-slate-200/80",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs font-semibold uppercase text-slate-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-5 py-3",children:e.jsx("input",{type:"checkbox",checked:r.length>0&&r.length===s.data.length,onChange:t=>C(t.target.checked),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500","aria-label":"Select all customers"})}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Name"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Email"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Type"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Customer group"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Status"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Docs"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Joined"}),e.jsx("th",{className:"px-5 py-3 text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100 bg-white",children:[s.data.map(t=>{const l=I[t.kyc_status]??"bg-slate-100 text-slate-600",a=r.includes(t.id);return e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-5 py-3",children:e.jsx("input",{type:"checkbox",checked:a,onChange:c=>A(t.id,c.target.checked),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500","aria-label":`Select ${t.name}`})}),e.jsx("td",{className:"px-5 py-3 font-medium text-slate-900",children:t.name}),e.jsx("td",{className:"px-5 py-3 text-slate-600",children:t.email}),e.jsx("td",{className:"px-5 py-3 text-slate-500",children:t.type}),e.jsx("td",{className:"px-5 py-3 text-slate-500",children:t.customer_group?.name??"—"}),e.jsx("td",{className:"px-5 py-3",children:e.jsx("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold ${l}`,children:t.kyc_status_label})}),e.jsx("td",{className:"px-5 py-3 text-slate-500",children:t.kyc_document_count}),e.jsx("td",{className:"px-5 py-3 text-slate-500",children:t.joined_at?new Date(t.joined_at).toLocaleDateString("en-IN"):"—"}),e.jsx("td",{className:"px-5 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[N(t.is_active?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12a7.5 7.5 0 0015 0M19.5 12a7.5 7.5 0 01-15 0"})}),t.is_active?"Disable customer":"Enable customer",()=>F(t)),e.jsx(W,{href:route("admin.customers.kyc.show",t.id),className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-slate-200 text-slate-500 transition hover:border-slate-300 hover:text-slate-900",title:"Review KYC",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5l7.5 7.5-7.5 7.5m-7.5-7.5h15"})})}),N(e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,className:"h-4 w-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),"Delete customer",()=>M(t.id))]})})]},t.id)}),s.data.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-5 py-6 text-center text-sm text-slate-500",children:"No customers found."})})]})]})}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 text-sm text-slate-600",children:[e.jsxs("div",{children:["Showing ",(s.meta.current_page-1)*s.meta.per_page+1," to"," ",Math.min(s.meta.current_page*s.meta.per_page,s.meta.total)," of ",s.meta.total," entries"]}),e.jsx("div",{className:"flex gap-2",children:Array.from({length:s.meta.last_page}).map((t,l)=>{const a=l+1,c=a===s.meta.current_page;return e.jsx("button",{type:"button",onClick:()=>{o.get(route("admin.customers.index"),{page:a,search:x||void 0,status:n.status??void 0,customer_group_id:m||void 0,type:u||void 0,per_page:d},{preserveState:!0,preserveScroll:!0})},className:`rounded-full px-3 py-1 text-sm font-semibold transition ${c?"bg-sky-600 text-white shadow shadow-sky-600/20":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:a},a)})})]})]})]})}export{G as default};
