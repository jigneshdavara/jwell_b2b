import{u as tt,r as k,a as st,j as t,H as nt}from"./app-CwNxIyKL.js";import{R as it}from"./RichTextEditor-BW75X6Q6.js";import{A as at}from"./AdminLayout-ufTt2RJF.js";const ne=(J=!1)=>({sku:"",label:"",metal_id:"",metal_purity_id:"",diamond_option_key:null,size_cm:"",price_adjustment:"0",is_default:J,metadata:{},metals:[],diamonds:[],colorstones:[]}),ot=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`local-${Date.now()}-${Math.random().toString(16).slice(2,8)}`,lt=()=>({id:void 0,diamond_id:"",diamonds_count:""});function _t(){const{props:J}=tt(),{product:y,brands:je,categories:Ne,diamondCatalog:F,colorstoneCatalog:rt,diamonds:X,colorstones:ie,customerGroups:dt,metals:O,metalPurities:A,metalTones:P,errors:w}=J;y?.variants?.length?y.variants.map((e,n)=>({id:e.id,sku:e.sku??"",label:e.label??"",metal_id:e.metal_id??"",metal_purity_id:e.metal_purity_id??"",diamond_option_key:e.diamond_option_key??null,size_cm:e.size_cm?String(e.size_cm):"",price_adjustment:String(e.price_adjustment??0),is_default:e.is_default??n===0,inventory_quantity:e.inventory_quantity!==void 0&&e.inventory_quantity!==null?Number(e.inventory_quantity):0,metadata:e.metadata??{},metals:e.metals?.map(s=>({id:s.id,metal_id:s.metal_id??"",metal_purity_id:s.metal_purity_id??"",metal_tone_id:s.metal_tone_id??"",metal_weight:s.metal_weight?String(s.metal_weight):""}))??[],diamonds:e.diamonds?.map(s=>({id:s.id,diamond_id:s.diamond_id??"",diamonds_count:s.diamonds_count?String(s.diamonds_count):""}))??[],colorstones:e.colorstones?.map(s=>({id:s.id,colorstone_id:s.colorstone_id??"",stones_count:s.stones_count?String(s.stones_count):""}))??[]})):ne(!0);const ve=y?.making_charge_discount_overrides?.length?y.making_charge_discount_overrides.map((e,n)=>({localKey:`${ot()}-${n}`,customer_group_id:e.customer_group_id!==null&&e.customer_group_id!==void 0?Number(e.customer_group_id):"",type:e.type??"percentage",value:e.value!==null&&e.value!==void 0?String(e.value):""})):[],R=k.useMemo(()=>{if(!y?.variants?.length)return{metalIds:[],metalPurityIds:[],metalToneIds:[],diamondOptions:[],colorstoneSelections:[]};const e=new Set,n=new Set,s=new Set,d=new Map,i=new Map;return y.variants.forEach(a=>{a.metals?.length&&a.metals.forEach(r=>{r.metal_id&&r.metal_id!==""&&e.add(typeof r.metal_id=="number"?r.metal_id:Number(r.metal_id)),r.metal_purity_id&&r.metal_purity_id!==""&&n.add(typeof r.metal_purity_id=="number"?r.metal_purity_id:Number(r.metal_purity_id)),r.metal_tone_id&&r.metal_tone_id!==""&&s.add(typeof r.metal_tone_id=="number"?r.metal_tone_id:Number(r.metal_tone_id))}),a.diamonds?.length&&a.diamonds.forEach(r=>{if(r.diamond_id&&r.diamond_id!==""&&r.diamond_id!==null){const p=typeof r.diamond_id=="number"?r.diamond_id:Number(r.diamond_id);d.has(p)||d.set(p,{diamond_id:p,count:r.diamonds_count&&r.diamonds_count!==""&&r.diamonds_count!==null?String(r.diamonds_count):""})}}),a.colorstones?.length&&a.colorstones.forEach(r=>{if(r.colorstone_id&&r.colorstone_id!==""&&r.colorstone_id!==null){const p=typeof r.colorstone_id=="number"?r.colorstone_id:Number(r.colorstone_id);i.has(p)||i.set(p,{colorstone_id:p,count:r.stones_count&&r.stones_count!==""&&r.stones_count!==null?String(r.stones_count):""})}})}),{metalIds:Array.from(e),metalPurityIds:Array.from(n),metalToneIds:Array.from(s),diamondSelections:Array.from(d.values()),colorstoneSelections:Array.from(i.values())}},[y]),I=st(()=>({sku:y?.sku??"",name:y?.name??"",titleline:y?.titleline??"",description:y?.description??"",brand_id:String(y?.brand_id??""),category_id:String(y?.category_id??""),collection:y?.collection??"",producttype:y?.producttype??"",gender:y?.gender??"",making_charge:y?.making_charge?String(y.making_charge):"",making_charge_discount_type:y?.making_charge_discount_type??null,making_charge_discount_value:y?.making_charge_discount_value!==null&&y?.making_charge_discount_value!==void 0?String(y.making_charge_discount_value):null,making_charge_discount_overrides:ve,is_active:y?.is_active??!0,is_variant_product:!0,variants:y?.variants?.length?y.variants.map((e,n)=>({id:e.id,sku:e.sku??"",label:e.label??"",metal_id:e.metal_id??"",metal_purity_id:e.metal_purity_id??"",diamond_option_key:e.diamond_option_key??null,size_cm:e.size_cm?String(e.size_cm):"",price_adjustment:String(e.price_adjustment??0),is_default:e.is_default??n===0,inventory_quantity:e.inventory_quantity!==void 0&&e.inventory_quantity!==null?Number(e.inventory_quantity):0,metadata:e.metadata??{},metals:e.metals?.map(s=>({id:s.id,metal_id:s.metal_id??"",metal_purity_id:s.metal_purity_id??"",metal_tone_id:s.metal_tone_id??"",metal_weight:s.metal_weight?String(s.metal_weight):""}))??[],diamonds:e.diamonds?.map(s=>({id:s.id,diamond_id:s.diamond_id??"",diamonds_count:s.diamonds_count?String(s.diamonds_count):""}))??[],colorstones:e.colorstones?.map(s=>({id:s.id,colorstone_id:s.colorstone_id??"",stones_count:s.stones_count?String(s.stones_count):""}))??[]})):[ne(!0)],metal_ids:R.metalIds,metal_purity_ids:R.metalPurityIds,metal_tone_ids:R.metalToneIds,diamond_options:[],uses_diamond:(R.diamondSelections?.length??0)>0,diamond_selections:R.diamondSelections??[],colorstone_selections:R.colorstoneSelections??[],media_uploads:[],removed_media_ids:[]})),{setData:b,post:ae,put:ke,processing:oe}=I,x=I.data,[le,re]=k.useState(x.description),H=k.useRef(null);k.useEffect(()=>{x.description!==le&&re(x.description)},[x.description]);const we=k.useCallback(e=>{re(e),H.current&&clearTimeout(H.current),H.current=setTimeout(()=>{b("description",e)},300)},[b]);k.useEffect(()=>()=>{H.current&&clearTimeout(H.current)},[]);const[de,ce]=k.useState(""),[ze,Ce]=k.useState(new Set),[Se,Me]=k.useState(new Set),[ct,$e]=k.useState(new Set);k.useCallback(e=>{Me(n=>{const s=new Set(n);return s.has(e)?s.delete(e):s.add(e),s})},[]),k.useCallback(e=>{Ce(n=>{const s=new Set(n);return s.has(e)?s.delete(e):s.add(e),s})},[]),k.useCallback(e=>{$e(n=>{const s=new Set(n);return s.has(e)?s.delete(e):s.add(e),s})},[]);const B=e=>Number.isFinite(e)?e.toFixed(3).replace(/\.?0+$/,""):"",me=(e,n)=>{const s=parseFloat(e);if(!Number.isFinite(s))return"";const d=n==="mm"?s/10:s;return B(d)},ee=(e,n)=>{const s=typeof e=="number"?e:parseFloat(e);if(!Number.isFinite(s))return"";const d=n==="mm"?s*10:s;return B(d)},K=k.useMemo(()=>Object.fromEntries(A.map(e=>[e.id,e.name])),[A]),G=k.useMemo(()=>Object.fromEntries(P.map(e=>[e.id,e.name])),[P]),W=k.useMemo(()=>Object.fromEntries(O.map(e=>[e.id,e.name])),[O]),Z=k.useMemo(()=>({types:Object.fromEntries(F.types.map(e=>[e.id,e.name])),shapes:Object.fromEntries(F.shapes.map(e=>[e.id,e.name])),colors:Object.fromEntries(F.colors.map(e=>[e.id,e.name])),clarities:Object.fromEntries(F.clarities.map(e=>[e.id,e.name])),cuts:Object.fromEntries(F.cuts.map(e=>[e.id,e.name]))}),[F]);k.useCallback(e=>{if(!e)return"";const n=[];return e.weight&&n.push(`${e.weight} Ct`),e.shape_id&&n.push(Z.shapes[Number(e.shape_id)]??""),e.clarity_id&&n.push(Z.clarities[Number(e.clarity_id)]??""),e.color_id&&n.push(Z.colors[Number(e.color_id)]??""),n.filter(Boolean).join(" - ")},[Z]);const te=k.useCallback((e,n)=>{let s="";if(e.metals&&e.metals.length>0){const l=e.metals.filter(c=>c.metal_id!==""&&typeof c.metal_id=="number").map(c=>({metal_id:c.metal_id,metal_purity_id:c.metal_purity_id!==""&&c.metal_purity_id!==null?Number(c.metal_purity_id):null,metal_tone_id:c.metal_tone_id!==""&&c.metal_tone_id!==null?Number(c.metal_tone_id):null}));if(l.length===0)s="";else{const c=new Map;l.forEach(m=>{c.has(m.metal_id)||c.set(m.metal_id,[]),c.get(m.metal_id).push(m)});const h=[];c.forEach((m,N)=>{const u=W[N]??"";if(!u)return;const S=new Set(m.map(C=>C.metal_purity_id).filter(Boolean)),E=new Set(m.map(C=>C.metal_tone_id).filter(Boolean));let z="";if(S.size>1&&E.size===1){const C=Array.from(E)[0],V=C?G[C]??"":"",_=Array.from(S).map($=>$?K[$]??"":"").filter(Boolean).sort();_.length>0?V?z=`${_.join(" + ")} ${V} ${u}`:z=`${_.join(" + ")} ${u}`:z=u}else if(E.size>1&&S.size===1){const C=Array.from(S)[0],V=C?K[C]??"":"",_=Array.from(E).map($=>$?G[$]??"":"").filter(Boolean).sort();_.length>0?V?z=`${V} ${_.join(" + ")} ${u}`:z=`${_.join(" + ")} ${u}`:z=V?`${V} ${u}`:u}else{const C=m[0],V=C.metal_purity_id,_=C.metal_tone_id,$=V?K[V]??"":"",D=_?G[_]??"":"";$&&D?z=`${$} ${D} ${u}`:$?z=`${$} ${u}`:D?z=`${D} ${u}`:z=u}z&&h.push(z)}),s=h.join(" / ")}}else if(e.metal_id!==""&&typeof e.metal_id=="number"){const l=W[e.metal_id]??"";if(e.metal_purity_id!==""&&typeof e.metal_purity_id=="number"){const c=K[e.metal_purity_id]??"";s=c?`${c} ${l}`:l}else s=l}let d="";if(e.diamonds&&e.diamonds.length>0){const l=[];e.diamonds.forEach(c=>{if(c.diamond_id&&typeof c.diamond_id=="number"){const h=c.diamonds_count?` (${c.diamonds_count})`:"";l.push(`Diamond${h}`)}}),d=l.join(" / ")}const i=e.metadata??{},a=typeof i.size_value=="string"||typeof i.size_value=="number"?String(i.size_value):"";let p=(i.size_unit==="mm"||i.size_unit==="cm"?i.size_unit:"cm")||"cm",f="";a?f=B(Number(a)):e.size_cm&&(f=B(parseFloat(e.size_cm)),p="cm");const v=f?`${f}${p}`:"",g=[d,s,v].filter(Boolean),M=g.length?g.join(" / "):"Variant",L=s,T=d;let q=null;e.diamonds&&e.diamonds.length>0&&(q=e.diamonds.map(l=>({diamond_id:l.diamond_id!==""&&l.diamond_id!==null?Number(l.diamond_id):null,diamonds_count:l.diamonds_count?Number(l.diamonds_count):null})));const o={metal_id:e.metal_id!==""&&e.metal_id!==null?Number(e.metal_id):null,metal_purity_id:e.metal_purity_id!==""&&e.metal_purity_id!==null?Number(e.metal_purity_id):null,diamond_option_key:e.diamond_option_key??null,diamond:q,size_cm:e.size_cm?Number(e.size_cm):null,auto_label:M};f?(o.size_value=f,o.size_unit=p):(delete o.size_value,delete o.size_unit);const j=typeof i.status=="string"&&i.status.trim().length>0?String(i.status):void 0;return j?o.status=j:o.status="enabled",{autoLabel:M,metalTone:L,stoneQuality:T,sizeText:v,metadata:o}},[ee,B,W,K,G]),U=k.useCallback(e=>(e.variants||[]).map((n,s)=>{const d=te(n,e),i=n.metadata?.auto_label??"",a=!n.label||n.label===i,r=n.metadata?.auto_sku??"",p=(e.sku??"").trim(),v=`${p?p.replace(/[^A-Za-z0-9]/g,"").toUpperCase():"SKU"}-${String(s+1).padStart(2,"0")}`,g=!n.sku||n.sku===r;return{...n,sku:g?v:n.sku,label:a?d.autoLabel:n.label,metadata:{...d.metadata,auto_sku:v},is_default:n.is_default??s===0}}),[te]),De=k.useMemo(()=>{const e=x.metal_ids||[];return e.length===0?A||[]:(A||[]).filter(n=>e.includes(n.metal_id))},[x.metal_ids,A]),Ee=k.useMemo(()=>{const e=x.metal_ids||[];return e.length===0?P||[]:(P||[]).filter(n=>e.includes(n.metal_id))},[x.metal_ids,P]);k.useMemo(()=>[],[]),k.useMemo(()=>[],[]),k.useMemo(()=>[],[]),k.useMemo(()=>({}),[]);const Ve=e=>{b(n=>({...n,is_variant_product:e}))},Le=e=>{},ue=e=>{b(n=>{if(n.size_unit===e)return n;const s=(n.size_values||[]).map(i=>{const a=me(i,n.size_unit||"cm");return a?ee(a,e):i}),d={...n,size_unit:e,size_values:s,variants:(n.variants||[]).map(i=>{if(!i.size_cm)return{...i,metadata:{...i.metadata??{},size_unit:e}};const a={...i.metadata??{}},r=ee(i.size_cm,e);return r?(a.size_value=r,a.size_unit=e):(delete a.size_value,a.size_unit=e),{...i,metadata:a}})};return d.variants=U(d),d})},Ae=()=>{const e=de.trim();if(!e)return;const n=parseFloat(e);if(!Number.isFinite(n)||n<=0)return;const s=B(n);b(d=>{if((d.size_values||[]).includes(s))return d;const i={...d,size_values:[...d.size_values||[],s]};return i.variants=U(i),i}),ce("")},Pe=e=>{b(n=>{const s={...n,size_values:(n.size_values||[]).filter(d=>d!==e)};return s.variants=U(s),s})},Te=e=>{b(n=>{const s=n.metal_ids||[],i=s.includes(e)?s.filter(f=>f!==e):[...s,e],a=A.filter(f=>f.metal_id===e).map(f=>f.id),r=P.filter(f=>f.metal_id===e).map(f=>f.id),p={...n,metal_ids:i,metal_purity_ids:(n.metal_purity_ids||[]).filter(f=>!a.includes(f)),metal_tone_ids:(n.metal_tone_ids||[]).filter(f=>!r.includes(f)),metal_mix_mode:n.metal_mix_mode};return p.variants=U(p),p})},qe=e=>{b(n=>{const s=n.metal_purity_ids||[],i=s.includes(e)?s.filter(a=>a!==e):[...s,e];return{...n,metal_purity_ids:i}})},Ue=e=>{b(n=>{const s=n.metal_tone_ids||[],i=s.includes(e)?s.filter(a=>a!==e):[...s,e];return{...n,metal_tone_ids:i}})},Be=()=>{b(e=>{const n=e.diamond_selections||[];return{...e,diamond_selections:[...n,{diamond_id:"",count:""}]}})},Fe=e=>{b(n=>{const s=n.diamond_selections||[];return{...n,diamond_selections:s.filter((d,i)=>i!==e)}})},xe=(e,n,s)=>{b(d=>{const a=(d.diamond_selections||[]).map((r,p)=>p!==e?r:{...r,[n]:s});return{...d,diamond_selections:a}})},Re=()=>{b(e=>{const n=e.colorstone_selections||[];return{...e,colorstone_selections:[...n,{colorstone_id:"",count:""}]}})},Ke=e=>{b(n=>{const s=n.colorstone_selections||[];return{...n,colorstone_selections:s.filter((d,i)=>i!==e)}})},_e=(e,n,s)=>{b(d=>{const a=(d.colorstone_selections||[]).map((r,p)=>p!==e?r:{...r,[n]:s});return{...d,colorstone_selections:a}})},We=e=>{b(n=>{if((n.variants||[]).length===1)return n;const s=(n.variants||[]).filter((i,a)=>a!==e);s.every(i=>!i.is_default)&&s.length>0&&(s[0].is_default=!0);const d={...n,variants:s};return d.variants=U(d),d})},Q=(e,n,s)=>{b(d=>{const i=(d.variants||[]).map((r,p)=>{if(p!==e)return r;const f={...r};switch(n){case"is_default":typeof s=="boolean"&&(f.is_default=s);break;case"metal_id":(s===""||typeof s=="number")&&(f.metal_id=s,(s===""||typeof s!="number")&&(f.metal_purity_id=""));break;case"metal_purity_id":(s===""||typeof s=="number")&&(f.metal_purity_id=s);break;case"diamond_option_key":f.diamond_option_key=s?String(s):null;break;case"size_cm":typeof s=="string"&&(f.size_cm=s);break;case"price_adjustment":typeof s=="string"&&(f.price_adjustment=s);break;case"sku":case"label":typeof s=="string"&&(f[n]=s);break;case"total_weight":s===""||s===null?f[n]="":(typeof s=="string"||typeof s=="number")&&(f[n]=s);break;case"inventory_quantity":if(s===""||s===null)f[n]=0;else if(typeof s=="string"){const v=parseInt(s,10);f[n]=isNaN(v)?0:v}else typeof s=="number"&&(f[n]=s);break}return f}),a={...d,variants:i};return a.variants=U(a),a})},Oe=(e,n)=>{b(s=>{const d=(s.variants||[]).map((a,r)=>{if(r!==e)return a;const p={...a.metadata??{}};return Object.entries(n).forEach(([f,v])=>{v===null?delete p[f]:p[f]=v}),{...a,metadata:p}}),i={...s,variants:d};return i.variants=U(i),i})},Ie=e=>{b(n=>({...n,variants:(n.variants||[]).map((s,d)=>({...s,is_default:d===e}))}))},He=e=>{b(n=>{const s=(n.variants||[]).map((d,i)=>{if(i!==e)return d;const a=d.diamonds||[];return{...d,diamonds:[...a,lt()]}});return{...n,variants:s}})},Ge=(e,n)=>{b(s=>{const d=(s.variants||[]).map((i,a)=>{if(a!==e)return i;const r=i.diamonds||[];return{...i,diamonds:r.filter((p,f)=>f!==n)}});return{...s,variants:d}})},se=(e,n,s,d)=>{b(i=>{const a=(i.variants||[]).map((r,p)=>{if(p!==e)return r;const v=(r.diamonds||[]).map((g,M)=>M!==n?g:{...g,[s]:d});return{...r,diamonds:v}});return{...i,variants:a}})},pe=(e,n,s,d)=>{b(i=>{const a=(i.variants||[]).map((r,p)=>{if(p!==e)return r;const v=(r.metals||[]).map((g,M)=>M!==n?g:{...g,[s]:d});return{...r,metals:v}});return{...i,variants:a}})},Ze=(e,n,s,d)=>{b(i=>{const a=(i.variants||[]).map((r,p)=>{if(p!==e)return r;const v=(r.colorstones||[]).map((g,M)=>M!==n?g:{...g,[s]:d});return{...r,colorstones:v}});return{...i,variants:a}})},Qe=e=>{const n=new Map;(e.metal_ids||[]).length>0&&(e.metal_purity_ids||[]).length>0&&(e.metal_purity_ids||[]).forEach(l=>{const c=A.find(h=>h.id===l);c&&(e.metal_ids||[]).includes(c.metal_id)&&(n.has(c.metal_id)||n.set(c.metal_id,[]),n.get(c.metal_id).push(l))});const s=new Map;(e.metal_ids||[]).length>0&&(e.metal_tone_ids||[]).length>0&&(e.metal_tone_ids||[]).forEach(l=>{const c=P.find(h=>h.id===l);c&&(e.metal_ids||[]).includes(c.metal_id)&&(s.has(c.metal_id)||s.set(c.metal_id,[]),s.get(c.metal_id).push(l))});const d=(l,c,h,m)=>{const N=[];return c.length===0&&h.length===0?[[{metal_id:l,metal_purity_id:null,metal_tone_id:null}]]:h.length===0&&c.length>0?c.map(u=>[{metal_id:l,metal_purity_id:u,metal_tone_id:null}]):c.length===0&&h.length>0?h.map(u=>[{metal_id:l,metal_purity_id:null,metal_tone_id:u}]):(m==="normal"?c.forEach(u=>{h.forEach(S=>{N.push([{metal_id:l,metal_purity_id:u,metal_tone_id:S}])})}):m==="mix_tones"?c.forEach(u=>{N.push(h.map(S=>({metal_id:l,metal_purity_id:u,metal_tone_id:S})))}):m==="mix_purities"&&h.forEach(u=>{N.push(c.map(S=>({metal_id:l,metal_purity_id:S,metal_tone_id:u})))}),N)},i=new Map;(e.metal_ids||[]).forEach(l=>{const c=n.get(l)||[],h=s.get(l)||[];let m="normal";if(e.metal_mix_mode){const u=e.metal_mix_mode[l];if(m=u==="normal"||u==="mix_tones"||u==="mix_purities"?u:m,m==="normal"){const S=e.metal_mix_mode[String(l)];m=S==="normal"||S==="mix_tones"||S==="mix_purities"?S:m}m==="normal"&&Object.keys(e.metal_mix_mode).forEach(S=>{const E=Number(S);if(E===l){const z=e.metal_mix_mode?.[E];(z==="normal"||z==="mix_tones"||z==="mix_purities")&&(m=z)}})}const N=d(l,c,h,m);i.set(l,N)});const a=[];if((e.metal_ids||[]).length>0){const l=m=>{if(m.length===0)return[[]];if(m.length===1)return m[0].map(z=>[z]);const[N,...u]=m,S=l(u),E=[];for(const z of N)for(const C of S)E.push([z,...C]);return E},c=(e.metal_ids||[]).map(m=>i.get(m)||[]),h=l(c);a.push(...h.map(m=>m.flat()))}const r=[];e.uses_diamond&&(e.diamond_options||[]).length>0?(e.diamond_options||[]).forEach(l=>{r.push({key:l.key,clarity_id:l.clarity_id!==""?Number(l.clarity_id):null,color_id:l.color_id!==""?Number(l.color_id):null,shape_id:l.shape_id!==""?Number(l.shape_id):null})}):r.push({key:"",clarity_id:null,color_id:null,shape_id:null});const p=e.size_dimension_enabled&&(e.size_values||[]).length>0?e.size_values||[]:[null],f=e.size_dimension_enabled&&(p||[]).length>0&&(p||[])[0]!==null,v=e.uses_diamond&&r.length>0&&r[0].key!=="",g=e.diamond_mixing_mode||"shared",M=v&&g==="as_variant";if(a.length===0&&!f&&!M)return e;const L=[],T=[];if(a.length>0?a.forEach(l=>{(p||[]).forEach(c=>{T.push({metals:l,size:c??null})})}):f?p.forEach(l=>{T.push({metals:[],size:l??null})}):T.push({metals:[],size:null}),g==="shared"){const l=v?r[0]:{key:"",clarity_id:null,color_id:null,shape_id:null};T.forEach(c=>{L.push({metals:c.metals,diamond:l,size:c.size})})}else T.forEach(l=>{v?r.forEach(c=>{L.push({metals:l.metals,diamond:c,size:l.size})}):L.push({metals:l.metals,diamond:{key:"",clarity_id:null,color_id:null,shape_id:null},size:l.size})});if(L.length===0)return e;const q=new Map;(e.variants||[]).forEach(l=>{if(!l.metals||l.metals.length===0)return;const c=l.size_cm||"no-size",h=l.diamond_option_key||"no-diamond",N=`${l.metals.filter(u=>u.metal_id!==""&&typeof u.metal_id=="number").map(u=>`${u.metal_id}-${u.metal_purity_id||"null"}-${u.metal_tone_id||"null"}`).sort().join("|")}::${c}::${h}`;q.set(N,{metals:l.metals.map(u=>({metal_id:typeof u.metal_id=="number"?u.metal_id:0,metal_purity_id:u.metal_purity_id!==""&&u.metal_purity_id!==null?typeof u.metal_purity_id=="number"?u.metal_purity_id:Number(u.metal_purity_id):null,metal_tone_id:u.metal_tone_id!==""&&u.metal_tone_id!==null?typeof u.metal_tone_id=="number"?u.metal_tone_id:Number(u.metal_tone_id):null,metal_weight:u.metal_weight||""})),diamonds:(l.diamonds||[]).map(u=>({diamond_id:u.diamond_id!==""&&u.diamond_id!==null?typeof u.diamond_id=="number"?u.diamond_id:Number(u.diamond_id):null,diamonds_count:u.diamonds_count||""}))})});const o=L.map((l,c)=>{const h=ne(c===0),m=l.size||"no-size",N=l.diamond.key||"no-diamond",S=`${l.metals.map(_=>`${_.metal_id}-${_.metal_purity_id||"null"}-${_.metal_tone_id||"null"}`).sort().join("|")}::${m}::${N}`,E=q.get(S);if(h.metals=l.metals.map(_=>{const $=E?.metals.find(D=>D.metal_id===_.metal_id&&D.metal_purity_id===(_.metal_purity_id??null)&&D.metal_tone_id===(_.metal_tone_id??null));return{id:void 0,metal_id:_.metal_id,metal_purity_id:_.metal_purity_id??"",metal_tone_id:_.metal_tone_id??"",metal_weight:$?.metal_weight||""}}),l.metals.length>0){const _=l.metals[0];h.metal_id=_.metal_id,_.metal_purity_id!==null&&(h.metal_purity_id=_.metal_purity_id)}(e.diamond_mixing_mode||"shared")==="shared"?e.diamond_selections&&e.diamond_selections.length>0?(h.diamonds=e.diamond_selections.filter(_=>_.diamond_id!==""&&_.diamond_id!==null).map(_=>{const $=E?.diamonds.find(D=>D.diamond_id===(typeof _.diamond_id=="number"?_.diamond_id:Number(_.diamond_id)));return{id:$?.id,diamond_id:typeof _.diamond_id=="number"?_.diamond_id:Number(_.diamond_id),diamonds_count:$?.diamonds_count||_.count||""}}),h.diamond_option_key=null):(h.diamond_option_key=null,h.diamonds=[]):(h.diamond_option_key=null,(e.diamond_selections||[]).length>0?h.diamonds=(e.diamond_selections||[]).map(_=>{const $=E?.diamonds.find(D=>D.diamond_id===(_.diamond_id!==""&&_.diamond_id!==null?typeof _.diamond_id=="number"?_.diamond_id:Number(_.diamond_id):null));return{id:void 0,diamond_id:_.diamond_id!==""&&_.diamond_id!==null?typeof _.diamond_id=="number"?_.diamond_id:Number(_.diamond_id):"",diamonds_count:$?.diamonds_count||_.count||""}}):h.diamonds=[]);const C={...h.metadata??{},status:"enabled"};if(l.size){const _=me(l.size,e.size_unit||"cm");h.size_cm=_,C.size_value=l.size,C.size_unit=e.size_unit}else delete C.size_value,delete C.size_unit;const V=e.diamond_mixing_mode||"shared";return h.diamond_option_key&&(C.diamond_option_key=h.diamond_option_key,V==="as_variant"&&(C.diamond={clarity_id:l.diamond.clarity_id,color_id:l.diamond.color_id,shape_id:l.diamond.shape_id})),e.colorstone_selections&&e.colorstone_selections.length>0?h.colorstones=e.colorstone_selections.filter(_=>_.colorstone_id!==""&&_.colorstone_id!==null).map(_=>{const D=(e.variants||[]).find(Y=>Y.colorstones&&Y.colorstones.length>0)?.colorstones?.find(Y=>Y.colorstone_id===(typeof _.colorstone_id=="number"?_.colorstone_id:Number(_.colorstone_id)));return{id:D?.id,colorstone_id:typeof _.colorstone_id=="number"?_.colorstone_id:Number(_.colorstone_id),stones_count:D?.stones_count||_.count||""}}):h.colorstones=[],h.metadata=C,h}),j={...e,variants:o,metal_mix_mode:e.metal_mix_mode||{}};return j.variants=U(j),j},he=()=>{b(e=>Qe(e))},Ye=e=>{e.preventDefault();const n=(I.data.media_uploads?.length??0)>0;I.transform(d=>{const i=d,a={...i};i.media_uploads&&Array.isArray(i.media_uploads)&&i.media_uploads.length>0&&(a.media_uploads=i.media_uploads),a.sku=i.sku||"",a.name=i.name||"",a.titleline=i.titleline||null,a.collection=i.collection||null,a.producttype=i.producttype||null,a.gender=i.gender||null,a.description=i.description||"";const r=i.brand_id;if(r!==""&&r!==null&&r!==void 0){const g=Number(r);a.brand_id=isNaN(g)?null:g}else a.brand_id=null;const p=i.category_id;if(p!==""&&p!==null&&p!==void 0){const g=Number(p);a.category_id=isNaN(g)?null:g}else a.category_id=null;const f=i.making_charge;if(f===""||f===null||f===void 0)a.making_charge=0;else{const g=Number(f);a.making_charge=isNaN(g)?0:g}const v=g=>g==null||g===""?null:typeof g=="number"?g:Number(g);return a.making_charge_discount_type=i.making_charge_discount_type||null,a.making_charge_discount_value=i.making_charge_discount_type?v(i.making_charge_discount_value):null,a.making_charge_discount_overrides=i.making_charge_discount_overrides.map(g=>({customer_group_id:g.customer_group_id!==""?Number(g.customer_group_id):null,type:g.type,value:v(g.value)})).filter(g=>g.customer_group_id!==null&&g.value!==null),a.is_active=i.is_active??!0,delete a.metadata,(!a.media_uploads||Array.isArray(a.media_uploads)&&a.media_uploads.length===0)&&delete a.media_uploads,(!a.removed_media_ids||Array.isArray(a.removed_media_ids)&&a.removed_media_ids.length===0)&&delete a.removed_media_ids,a.sku||(a.sku=""),a.name||(a.name=""),a.brand_id===void 0&&(a.brand_id=null),a.category_id===void 0&&(a.category_id=null),a.making_charge===void 0&&(a.making_charge=0),i.variants&&Array.isArray(i.variants)?a.variants=i.variants:a.variants=[],i.variant_options!==void 0&&(a.variant_options=i.variant_options),i.metal_ids!==void 0&&(a.metal_ids=i.metal_ids),i.metal_purity_ids!==void 0&&(a.metal_purity_ids=i.metal_purity_ids),i.metal_tone_ids!==void 0&&(a.metal_tone_ids=i.metal_tone_ids),i.diamond_selections!==void 0&&(a.diamond_selections=i.diamond_selections),i.colorstone_selections!==void 0&&(a.colorstone_selections=i.colorstone_selections),y?.id&&n&&(a._method="PUT"),a});const s={preserveScroll:!0,forceFormData:n,onFinish:()=>{I.transform(d=>d)}};y?.id?n?ae(route("admin.products.update",y.id),s):ke(route("admin.products.update",y.id),s):ae(route("admin.products.store"),s)},fe=w.variants,ge=k.useMemo(()=>Object.entries(w??{}).filter(([e])=>e.startsWith("media_uploads")).map(([,e])=>e),[w]),be=k.useMemo(()=>y?.media?[...y.media].sort((e,n)=>e.position-n.position):[],[y?.media]),Je=e=>{const n=x.removed_media_ids??[],d=n.includes(e)?n.filter(i=>i!==e):[...n,e];b("removed_media_ids",d)},Xe=e=>{const n=e.target.files?Array.from(e.target.files):[];n.length!==0&&(b("media_uploads",[...x.media_uploads??[],...n]),e.target.value="")},et=e=>{b("media_uploads",(x.media_uploads??[]).filter((n,s)=>s!==e))},ye=e=>(x.removed_media_ids??[]).includes(e);return t.jsxs(at,{children:[t.jsx(nt,{title:y?.id?`Edit ${y.name}`:"New Product"}),t.jsxs("form",{onSubmit:Ye,className:"space-y-10",children:[t.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-xl shadow-slate-900/10",children:[t.jsxs("div",{className:"flex flex-col gap-4 border-b border-slate-100 pb-6 sm:flex-row sm:items-center sm:justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:y?.id?"Update product":"Create product"}),t.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Define product master information and atelier references."})]}),t.jsx("button",{type:"submit",disabled:oe,className:"inline-flex items-center gap-2 rounded-full bg-slate-900 px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-slate-900/20 transition hover:bg-slate-700 disabled:cursor-not-allowed disabled:opacity-60",children:oe?"Saving…":y?.id?"Save changes":"Create product"})]}),t.jsx("div",{className:"mt-6 space-y-6",children:t.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[t.jsx("span",{children:"SKU *"}),t.jsx("input",{type:"text",value:x.sku,onChange:e=>b("sku",e.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200"}),w.sku&&t.jsx("span",{className:"text-xs text-rose-500",children:w.sku})]}),t.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[t.jsx("span",{children:"Product name *"}),t.jsx("input",{type:"text",value:x.name,onChange:e=>b("name",e.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200"}),w.name&&t.jsx("span",{className:"text-xs text-rose-500",children:w.name})]}),t.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[t.jsx("span",{children:"Title Line *"}),t.jsx("input",{type:"text",value:x.titleline,onChange:e=>b("titleline",e.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Enter product title line"}),w.titleline&&t.jsx("span",{className:"text-xs text-rose-500",children:w.titleline})]}),t.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[t.jsx("span",{children:"Brand *"}),t.jsxs("select",{value:x.brand_id,onChange:e=>b("brand_id",e.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[t.jsx("option",{value:"",children:"Select brand"}),Object.entries(je).map(([e,n])=>t.jsx("option",{value:e,children:n},e))]}),w.brand_id&&t.jsx("span",{className:"text-xs text-rose-500",children:w.brand_id})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[t.jsx("span",{children:"Category *"}),t.jsxs("select",{value:x.category_id,onChange:e=>b("category_id",e.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[t.jsx("option",{value:"",children:"Select category"}),Object.entries(Ne).map(([e,n])=>t.jsx("option",{value:e,children:n},e))]}),w.category_id&&t.jsx("span",{className:"text-xs text-rose-500",children:w.category_id})]}),t.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[t.jsx("span",{children:"Collection *"}),t.jsx("input",{type:"text",value:x.collection,onChange:e=>b("collection",e.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Enter collection name"}),w.collection&&t.jsx("span",{className:"text-xs text-rose-500",children:w.collection})]}),t.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[t.jsx("span",{children:"Product Type *"}),t.jsx("input",{type:"text",value:x.producttype,onChange:e=>b("producttype",e.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Enter product type"}),w.producttype&&t.jsx("span",{className:"text-xs text-rose-500",children:w.producttype})]}),t.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[t.jsx("span",{children:"Gender *"}),t.jsxs("select",{value:x.gender,onChange:e=>b("gender",e.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[t.jsx("option",{value:"",children:"Select gender"}),t.jsx("option",{value:"Men",children:"Men"}),t.jsx("option",{value:"Women",children:"Women"}),t.jsx("option",{value:"Unisex",children:"Unisex"}),t.jsx("option",{value:"Kids",children:"Kids"})]}),w.gender&&t.jsx("span",{className:"text-xs text-rose-500",children:w.gender})]}),t.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[t.jsx("span",{children:"Making charge (₹) *"}),t.jsx("input",{type:"number",step:"0.01",min:"0",value:x.making_charge,onChange:e=>b("making_charge",e.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200"}),w.making_charge&&t.jsx("span",{className:"text-xs text-rose-500",children:w.making_charge})]})]})]})})]}),t.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-xl shadow-slate-900/10",children:[t.jsx("div",{className:"flex flex-col gap-3 border-b border-slate-100 pb-4 lg:flex-row lg:items-center lg:justify-between",children:t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Product description"}),t.jsx("p",{className:"text-sm text-slate-500",children:"Provide merchandising copy, craftsmanship details, and any atelier notes for this SKU."})]})}),t.jsxs("div",{className:"mt-6",children:[t.jsx(it,{value:le,onChange:we,className:"overflow-hidden rounded-3xl border border-slate-200",placeholder:"Detail the design notes, materials, finish, and atelier craftsmanship."}),w.description&&t.jsx("span",{className:"mt-2 block text-xs text-rose-500",children:w.description})]})]}),t.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-xl shadow-slate-900/10",children:[t.jsx("div",{className:"flex flex-col gap-4 border-b border-slate-100 pb-4 lg:flex-row lg:items-center lg:justify-between",children:t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Product media"}),t.jsx("p",{className:"text-sm text-slate-500",children:"Upload product images or videos for catalogue displays. You can also remove outdated media assets."})]})}),t.jsxs("div",{className:"mt-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-slate-400",children:"Current media"}),t.jsx("div",{className:"mt-3 grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:be.length>0?be.map(e=>t.jsxs("div",{className:`relative overflow-hidden rounded-3xl border border-slate-200 bg-slate-50 shadow-sm transition ${ye(e.id)?"opacity-50 ring-2 ring-rose-200":""}`,children:[e.type==="video"?t.jsx("video",{src:e.url,className:"h-48 w-full rounded-t-3xl bg-black object-cover",controls:!0,onError:n=>{console.error("Video load error:",e.url),n.target.style.display="none"},children:"Your browser does not support the video tag."}):t.jsx("img",{src:e.url,alt:"Product media",className:"h-48 w-full rounded-t-3xl object-cover",onError:n=>{console.error("Image load error:",e.url),n.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Crect fill="%23ddd" width="400" height="300"/%3E%3Ctext fill="%23999" font-family="sans-serif" font-size="18" x="50%25" y="50%25" text-anchor="middle" dy=".3em"%3EImage not found%3C/text%3E%3C/svg%3E'}}),t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 text-xs text-slate-500",children:[t.jsx("span",{className:"rounded-full bg-white/70 px-3 py-1 font-semibold text-slate-700",children:e.type.toUpperCase()}),t.jsx("button",{type:"button",onClick:()=>Je(e.id),className:"text-rose-500 transition hover:text-rose-600",children:ye(e.id)?"Undo removal":"Remove"})]})]},e.id)):t.jsx("p",{className:"rounded-2xl border border-dashed border-slate-200 px-4 py-6 text-sm text-slate-500",children:"No media uploaded yet."})})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-slate-400",children:"Upload new files"}),t.jsxs("label",{className:"mt-3 flex cursor-pointer flex-col items-center justify-center gap-3 rounded-3xl border border-dashed border-slate-300 bg-slate-50 px-6 py-10 text-center text-slate-500 transition hover:border-slate-400 hover:bg-slate-100",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-slate-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 15a4 4 0 014-4h10a4 4 0 014 4v3a2 2 0 01-2 2H5a2 2 0 01-2-2v-3z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 10l5-5m0 0l5 5m-5-5v12"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-semibold text-slate-700",children:"Click to upload"}),t.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"JPEG, PNG, WebP, MP4 up to 50MB each."})]}),t.jsx("input",{type:"file",multiple:!0,accept:"image/*,video/*",onChange:Xe,className:"hidden"})]}),ge.length>0&&t.jsx("ul",{className:"mt-3 space-y-1",children:ge.map((e,n)=>t.jsx("li",{className:"text-xs text-rose-500",children:e},`${n}-${e}`))}),(x.media_uploads??[]).length>0&&t.jsx("ul",{className:"mt-4 space-y-2",children:(x.media_uploads??[]).map((e,n)=>t.jsxs("li",{className:"flex items-center justify-between rounded-2xl border border-slate-200 px-4 py-2 text-sm text-slate-600",children:[t.jsx("span",{className:"truncate",children:e.name}),t.jsx("button",{type:"button",onClick:()=>et(n),className:"text-rose-500 transition hover:text-rose-600",children:"Remove"})]},`${e.name}-${n}`))})]})]})]}),t.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-xl shadow-slate-900/10",children:[t.jsxs("div",{className:"flex flex-col gap-3 border-b border-slate-100 pb-4 lg:flex-row lg:items-center lg:justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Variant configuration"}),t.jsx("p",{className:"text-sm text-slate-500",children:"Decide whether this product uses a single price or multiple combinations across metals and diamonds."})]}),t.jsxs("label",{className:"inline-flex items-center gap-3 rounded-2xl border border-slate-200 px-4 py-3 text-sm text-slate-600",children:[t.jsx("input",{type:"checkbox",checked:x.is_variant_product??!0,onChange:e=>Ve(e.target.checked),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),"Variant product (multi-option catalogue)"]})]}),x.is_variant_product?t.jsxs("div",{className:"mt-6 space-y-6",children:[t.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[t.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-2",children:"Variant Configuration Options"}),t.jsx("p",{className:"text-xs text-slate-600 mb-4",children:"Use the configuration buttons in the variant table below to add metals (with purity and tone), diamonds, and colorstones to each variant."}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-xs",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-sky-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 13h8l-4-4m0 8l4-4"})}),t.jsx("span",{className:"text-slate-700",children:"Configure Metals"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-sky-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),t.jsx("span",{className:"text-slate-700",children:"Configure Diamonds"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-sky-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),t.jsx("span",{className:"text-slate-700",children:"Configure Colorstones"})]})]})]}),t.jsxs("div",{className:"space-y-4 rounded-2xl border border-slate-200 p-4",children:[t.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-slate-500",children:"Size dimension"}),t.jsx("p",{className:"text-xs text-slate-500",children:"Maintain consistent size data across variants. Add numeric values and choose the preferred unit."})]}),t.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[t.jsx("input",{type:"checkbox",checked:x.size_dimension_enabled,onChange:e=>Le(e.target.checked),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),"Use size dimension"]})]}),x.size_dimension_enabled&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:[t.jsx("span",{children:"Unit"}),t.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[t.jsx("input",{type:"radio",name:"size-unit",value:"mm",checked:x.size_unit==="mm",onChange:()=>ue("mm"),className:"h-4 w-4 border-slate-300 text-sky-600 focus:ring-sky-500"}),"Millimetres (mm)"]}),t.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[t.jsx("input",{type:"radio",name:"size-unit",value:"cm",checked:x.size_unit==="cm",onChange:()=>ue("cm"),className:"h-4 w-4 border-slate-300 text-sky-600 focus:ring-sky-500"}),"Centimetres (cm)"]})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"number",step:"0.001",min:"0",value:de,onChange:e=>ce(e.target.value),className:"w-24 rounded-2xl border border-slate-200 px-3 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:`e.g. 25${x.size_unit}`}),t.jsx("button",{type:"button",onClick:Ae,className:"inline-flex items-center gap-2 rounded-full border border-slate-300 px-4 py-1.5 text-xs font-semibold uppercase tracking-[0.2em] text-slate-600 transition hover:border-slate-400 hover:text-slate-900",children:"Add size"})]}),(x.size_values||[]).length===0&&t.jsx("span",{className:"text-xs text-slate-400",children:"Add at least one size value to use in the variant matrix."})]}),(x.size_values||[]).length>0&&t.jsx("div",{className:"flex flex-wrap gap-2",children:(x.size_values||[]).map(e=>t.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-slate-50 px-3 py-1 text-xs font-semibold text-slate-600",children:[e,x.size_unit,t.jsx("button",{type:"button",onClick:()=>Pe(e),className:"text-rose-500 transition hover:text-rose-600","aria-label":`Remove size ${e}${x.size_unit}`,children:"×"})]},`${e}-${x.size_unit}`))})]})]}),t.jsxs("div",{className:"space-y-4 rounded-2xl border border-slate-200 p-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-slate-500",children:"Metals"}),t.jsx("p",{className:"text-xs text-slate-500",children:"Select metals that can be used in your product variants."})]}),O.length>0?t.jsx("div",{className:"flex flex-wrap gap-3",children:O.map(e=>{const n=(x.metal_ids||[]).includes(e.id);return t.jsxs("label",{className:`inline-flex items-center gap-2 rounded-full border px-3 py-1 text-xs font-semibold transition ${n?"border-sky-400 bg-white text-sky-700":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"}`,children:[t.jsx("input",{type:"checkbox",checked:n,onChange:()=>Te(e.id),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),e.name]},e.id)})}):t.jsx("p",{className:"text-xs text-slate-400",children:"No metals available yet."})]}),(x.metal_ids||[]).length>0&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"space-y-4",children:O.filter(e=>(x.metal_ids||[]).includes(e.id)).map(e=>{const n=De.filter(r=>r.metal_id===e.id),s=Ee.filter(r=>r.metal_id===e.id),d=n.filter(r=>(x.metal_purity_ids||[]).includes(r.id)),i=s.filter(r=>(x.metal_tone_ids||[]).includes(r.id)),a=d.length>0&&i.length>0?d.length*i.length:d.length>0?d.length:i.length>0?i.length:0;return t.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:[t.jsxs("div",{className:"mb-4 flex items-center justify-between border-b border-slate-100 pb-3",children:[t.jsxs("h3",{className:"text-base font-semibold text-slate-900",children:["Metal: ",e.name]}),a>0&&t.jsxs("span",{className:"rounded-full bg-sky-50 px-3 py-1 text-xs font-semibold text-sky-700",children:[a," variant",a!==1?"s":""," for this metal"]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"mb-2 block text-xs font-semibold text-slate-600",children:"Purities for this metal"}),n.length>0?t.jsx("div",{className:"flex flex-wrap gap-2",children:n.map(r=>{const p=(x.metal_purity_ids||[]).includes(r.id);return t.jsxs("label",{className:`inline-flex cursor-pointer items-center gap-2 rounded-full border px-3 py-1.5 text-xs font-semibold transition ${p?"border-sky-400 bg-sky-50 text-sky-700 shadow-sm":"border-slate-200 bg-white text-slate-600 hover:border-slate-300 hover:bg-slate-50"}`,children:[t.jsx("input",{type:"checkbox",checked:p,onChange:()=>qe(r.id),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),r.name]},r.id)})}):t.jsxs("p",{className:"text-xs text-slate-400",children:["No purities available for ",e.name,"."]}),t.jsxs("p",{className:"mt-2 text-xs text-slate-500",children:["Choose all purities in which this design is available for ",e.name,"."]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"mb-2 block text-xs font-semibold text-slate-600",children:"Tones for this metal"}),s.length>0?t.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(r=>{const p=(x.metal_tone_ids||[]).includes(r.id);return t.jsxs("label",{className:`inline-flex cursor-pointer items-center gap-2 rounded-full border px-3 py-1.5 text-xs font-semibold transition ${p?"border-sky-400 bg-sky-50 text-sky-700 shadow-sm":"border-slate-200 bg-white text-slate-600 hover:border-slate-300 hover:bg-slate-50"}`,children:[t.jsx("input",{type:"checkbox",checked:p,onChange:()=>Ue(r.id),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),r.name]},r.id)})}):t.jsxs("p",{className:"text-xs text-slate-400",children:["No tones available for ",e.name,"."]}),t.jsxs("p",{className:"mt-2 text-xs text-slate-500",children:["Choose all tones in which this design is available for ",e.name,"."]})]})]})]},e.id)})}),(x.metal_ids||[]).length>0&&t.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-semibold text-slate-700",children:"Preview generated variants"}),t.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["This setup will generate approximately ",t.jsx("span",{className:"font-semibold text-slate-900",children:(x.variants||[]).length})," variant",(x.variants||[]).length!==1?"s":""," based on your current configuration."]})]}),t.jsx("button",{type:"button",onClick:he,className:"rounded-full border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 transition hover:border-slate-400 hover:bg-slate-50",children:"Regenerate matrix"})]})})]}),t.jsxs("div",{className:"space-y-4 rounded-2xl border border-slate-200 p-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-slate-500",children:"Diamonds"}),t.jsx("p",{className:"text-xs text-slate-500",children:"Select diamonds and specify counts for your product variants."})]}),t.jsxs("button",{type:"button",onClick:Be,className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-white px-3 py-1.5 text-xs font-semibold text-slate-700 transition hover:border-sky-400 hover:bg-sky-50",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 5v14M5 12h14"})}),"Add Diamond"]})]}),(x.diamond_selections||[]).length>0?t.jsx("div",{className:"space-y-3",children:(x.diamond_selections||[]).map((e,n)=>t.jsxs("div",{className:"flex items-center gap-3 rounded-xl border border-slate-200 bg-white p-3",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"mb-1 block text-xs font-semibold text-slate-600",children:"Diamond"}),t.jsxs("select",{value:e.diamond_id===""?"":e.diamond_id,onChange:s=>xe(n,"diamond_id",s.target.value===""?"":Number(s.target.value)),className:"w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[t.jsx("option",{value:"",children:"Select diamond"}),X.map(s=>t.jsx("option",{value:s.id,children:s.name},s.id))]})]}),t.jsxs("div",{className:"w-32",children:[t.jsx("label",{className:"mb-1 block text-xs font-semibold text-slate-600",children:"Count"}),t.jsx("input",{type:"number",min:"0",step:"1",value:e.count,onChange:s=>xe(n,"count",s.target.value),className:"w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"0"})]}),t.jsx("button",{type:"button",onClick:()=>Fe(n),className:"mt-6 rounded-full border border-rose-200 p-2 text-rose-600 transition hover:border-rose-300 hover:text-rose-700","aria-label":"Remove diamond",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]},n))}):t.jsx("p",{className:"text-xs text-slate-400",children:'No diamonds added. Click "Add Diamond" to add one.'})]}),t.jsxs("div",{className:"space-y-4 rounded-2xl border border-slate-200 p-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-slate-500",children:"Colorstones"}),t.jsx("p",{className:"text-xs text-slate-500",children:"Select colorstones and specify counts for your product variants."})]}),t.jsxs("button",{type:"button",onClick:Re,className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-white px-3 py-1.5 text-xs font-semibold text-slate-700 transition hover:border-sky-400 hover:bg-sky-50",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 5v14M5 12h14"})}),"Add Colorstone"]})]}),(x.colorstone_selections||[]).length>0?t.jsx("div",{className:"space-y-3",children:(x.colorstone_selections||[]).map((e,n)=>t.jsxs("div",{className:"flex items-center gap-3 rounded-xl border border-slate-200 bg-white p-3",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"mb-1 block text-xs font-semibold text-slate-600",children:"Colorstone"}),t.jsxs("select",{value:e.colorstone_id===""?"":e.colorstone_id,onChange:s=>_e(n,"colorstone_id",s.target.value===""?"":Number(s.target.value)),className:"w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[t.jsx("option",{value:"",children:"Select colorstone"}),ie.map(s=>t.jsx("option",{value:s.id,children:s.name},s.id))]})]}),t.jsxs("div",{className:"w-32",children:[t.jsx("label",{className:"mb-1 block text-xs font-semibold text-slate-600",children:"Count"}),t.jsx("input",{type:"number",min:"0",step:"1",value:e.count,onChange:s=>_e(n,"count",s.target.value),className:"w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"0"})]}),t.jsx("button",{type:"button",onClick:()=>Ke(n),className:"mt-6 rounded-full border border-rose-200 p-2 text-rose-600 transition hover:border-rose-300 hover:text-rose-700","aria-label":"Remove colorstone",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]},n))}):t.jsx("p",{className:"text-xs text-slate-400",children:'No colorstones added. Click "Add Colorstone" to add one.'})]})]}):t.jsx("p",{className:"mt-6 rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-4 py-3 text-sm text-slate-600",children:"Variants are disabled. Customers will see the making charge defined above."})]}),t.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl shadow-slate-900/10 ring-1 ring-slate-200/80",children:[t.jsxs("div",{className:"flex flex-col gap-4 border-b border-slate-200 pb-6 lg:flex-row lg:items-center lg:justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-semibold text-slate-900",children:"Variant Matrix"}),t.jsx("p",{className:"mt-2 text-sm text-slate-500",children:"Configure product variants with metals, diamonds, and colorstones. The default variant powers the customer catalogue card pricing."})]}),t.jsxs("button",{type:"button",onClick:he,className:"inline-flex items-center gap-2 rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-slate-900/20 transition hover:bg-slate-700",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h7"})}),"Generate Matrix"]})]}),fe&&t.jsx("div",{className:"mt-6 rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-600 ring-1 ring-rose-200/50",children:fe}),t.jsx("div",{className:"mt-8 overflow-hidden rounded-3xl bg-white shadow-xl shadow-slate-900/10 ring-1 ring-slate-200/80",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-sm",children:[t.jsx("thead",{className:"bg-slate-50 text-xs text-slate-500",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-5 py-3 text-left min-w-[150px]",children:"SKU"}),t.jsx("th",{className:"px-5 py-3 text-left min-w-[300px]",children:"Variant Label"}),t.jsx("th",{className:"px-5 py-3 text-left min-w-[250px]",children:"Metal"}),t.jsx("th",{className:"px-5 py-3 text-left min-w-[250px]",children:"Diamonds"}),t.jsx("th",{className:"px-5 py-3 text-left min-w-[250px]",children:"Colorstones"}),t.jsx("th",{className:"px-5 py-3 text-left",children:"Inventory Quantity"}),t.jsx("th",{className:"px-5 py-3 text-left",children:"Status"}),t.jsx("th",{className:"px-5 py-3 text-left",children:"Default"}),t.jsx("th",{className:"px-5 py-3 text-right",children:"Actions"})]})}),t.jsxs("tbody",{className:"divide-y divide-slate-100 bg-white",children:[(x.variants||[]).map((e,n)=>{const s=te(e,x);s.metalTone;const d=(e.metals||[]).filter(o=>o.metal_id!==""&&o.metal_id!==null&&typeof o.metal_id=="number");d.reduce((o,j)=>{const l=parseFloat(j.metal_weight||"0");return o+(isNaN(l)?0:l)},0);const i=new Map;d.forEach(o=>{const j=o.metal_id;i.has(j)||i.set(j,[]),i.get(j).push({metal_id:j,metal_purity_id:o.metal_purity_id!==""&&o.metal_purity_id!==null?typeof o.metal_purity_id=="number"?o.metal_purity_id:Number(o.metal_purity_id):null,metal_tone_id:o.metal_tone_id!==""&&o.metal_tone_id!==null?typeof o.metal_tone_id=="number"?o.metal_tone_id:Number(o.metal_tone_id):null})});const a=[],r=[];i.forEach((o,j)=>{const l=W[j]||"",c=new Set,h=new Set;if(o.forEach(m=>{if(m.metal_purity_id!==null){const N=typeof m.metal_purity_id=="number"?m.metal_purity_id:Number(m.metal_purity_id);Number.isFinite(N)&&c.add(N)}if(m.metal_tone_id!==null){const N=typeof m.metal_tone_id=="number"?m.metal_tone_id:Number(m.metal_tone_id);Number.isFinite(N)&&h.add(N)}}),c.size>0){const m=Array.from(c).map(N=>{const u=typeof N=="number"?N:Number(N);return Number.isFinite(u)&&K[u]||""}).filter(Boolean).sort();m.length>0&&(c.size>1?a.push(`${m.join(" + ")} (${l})`):a.push(`${m[0]} (${l})`))}if(h.size>0){const m=Array.from(h).map(N=>{const u=typeof N=="number"?N:Number(N);return Number.isFinite(u)&&G[u]||""}).filter(Boolean).sort();m.length>0&&(h.size>1?r.push(`${m.join(" + ")} (${l})`):r.push(`${m[0]} (${l})`))}});let p=[];const f=(e.diamonds||[]).filter(o=>o.diamond_id!==""&&o.diamond_id!==null&&o.diamond_id!==void 0).map(o=>({diamond_id:typeof o.diamond_id=="number"?o.diamond_id:Number(o.diamond_id),diamonds_count:o.diamonds_count||""}));f.length>0?p=f:(e.diamonds||[]).length>0?p=(e.diamonds||[]).map(o=>({diamond_id:null,diamonds_count:o.diamonds_count||""})):(x.diamond_selections||[]).length>0&&(p=(x.diamond_selections||[]).filter(o=>o.diamond_id!==""&&o.diamond_id!==null&&o.diamond_id!==void 0).map(o=>({diamond_id:typeof o.diamond_id=="number"?o.diamond_id:Number(o.diamond_id),diamonds_count:o.count||""})));let v=[];const g=(e.colorstones||[]).filter(o=>o.colorstone_id!==""&&o.colorstone_id!==null&&o.colorstone_id!==void 0).map(o=>({colorstone_id:typeof o.colorstone_id=="number"?o.colorstone_id:Number(o.colorstone_id),stones_count:o.stones_count||""}));g.length>0?v=g:(e.colorstones||[]).length>0?v=(e.colorstones||[]).map(o=>({colorstone_id:null,stones_count:o.stones_count||""})):(x.colorstone_selections||[]).length>0&&(v=(x.colorstone_selections||[]).filter(o=>o.colorstone_id!==""&&o.colorstone_id!==null&&o.colorstone_id!==void 0).map(o=>({colorstone_id:typeof o.colorstone_id=="number"?o.colorstone_id:Number(o.colorstone_id),stones_count:o.count||""})));const M=e.metadata??{},L=typeof M.size_value=="string"||typeof M.size_value=="number"?String(M.size_value):"",T=M.size_unit==="mm"||M.size_unit==="cm"?M.size_unit:"cm";L?`${L}${T}`:e.size_cm&&`${B(parseFloat(e.size_cm))}`;const q=typeof M.status=="string"&&M.status.trim().length>0?String(M.status):"enabled";return s.autoLabel,t.jsxs(t.Fragment,{children:[t.jsxs("tr",{className:`hover:bg-slate-50 ${q==="disabled"?"opacity-70":""} ${e.is_default?"bg-sky-50/30":""}`,children:[t.jsxs("td",{className:"px-5 py-3 align-middle min-w-[150px]",children:[t.jsx("input",{type:"text",value:e.sku,onChange:o=>Q(n,"sku",o.target.value),className:"w-full min-w-[120px] rounded-xl border border-slate-200 px-3 py-1.5 text-sm text-slate-700 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Variant SKU"}),w[`variants.${n}.sku`]&&t.jsx("p",{className:"mt-1 text-xs text-rose-500",children:w[`variants.${n}.sku`]})]}),t.jsxs("td",{className:"px-5 py-3 align-middle min-w-[300px]",children:[t.jsx("input",{type:"text",value:e.label,onChange:o=>Q(n,"label",o.target.value),className:"w-full min-w-[280px] rounded-xl border border-slate-200 px-3 py-1.5 text-sm text-slate-700 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Display label"}),w[`variants.${n}.label`]&&t.jsx("p",{className:"mt-1 text-xs text-rose-500",children:w[`variants.${n}.label`]})]}),t.jsx("td",{className:"px-5 py-3 align-middle text-slate-700",children:t.jsx("div",{className:"space-y-3 min-w-[250px]",children:d.length>0?d.map((o,j)=>{const l=W[o.metal_id]||"Unknown Metal",c=o.metal_purity_id&&typeof o.metal_purity_id=="number"&&A.find(N=>N.id===o.metal_purity_id)?.name||"",h=o.metal_tone_id&&typeof o.metal_tone_id=="number"&&P.find(N=>N.id===o.metal_tone_id)?.name||"",m=o.metal_weight||"";return t.jsxs("div",{className:"flex flex-col gap-2 rounded-lg border border-slate-200 bg-slate-50/50 p-3",children:[t.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[t.jsx("div",{className:"text-xs font-medium text-slate-500 mb-1",children:"Metal"}),t.jsx("div",{className:"text-sm font-semibold text-slate-800",children:l})]}),t.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[t.jsx("div",{className:"text-xs font-medium text-slate-500 mb-1",children:"Purity"}),t.jsx("div",{className:"text-sm text-slate-700",children:c||"—"})]}),t.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[t.jsx("div",{className:"text-xs font-medium text-slate-500 mb-1",children:"Tone"}),t.jsx("div",{className:"text-sm text-slate-700",children:h||"—"})]}),t.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[t.jsx("div",{className:"text-xs font-medium text-slate-500 mb-1.5",children:"Weight (g)"}),t.jsx("input",{type:"number",step:"0.001",min:"0.001",required:!0,value:m,onChange:N=>{const u=N.target.value;pe(n,j,"metal_weight",u)},className:`w-full rounded-lg border px-2.5 py-1.5 text-sm font-mono transition-colors ${!m||m===""?"border-rose-300 bg-rose-50 text-rose-500 focus:border-rose-400 focus:bg-white":"border-slate-200 bg-white text-slate-700 focus:border-sky-400"} focus:outline-none focus:ring-1 focus:ring-sky-200`,placeholder:"0.000"}),(!m||m==="")&&t.jsx("span",{className:"mt-1 text-[10px] text-rose-500",children:"Required"})]})]},j)}):t.jsx("span",{className:"text-sm text-slate-400",children:"—"})})}),t.jsx("td",{className:"px-5 py-3 align-middle text-slate-700",children:t.jsx("div",{className:"space-y-3 min-w-[250px]",children:p.length>0?p.map((o,j)=>{const l=o.diamond_id&&X?.find(h=>h.id===o.diamond_id)?.name||"Diamond",c=o.diamonds_count||"";return t.jsxs("div",{className:"flex items-center gap-3 rounded-lg border border-slate-200 bg-slate-50/50 p-3",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-xs font-medium text-slate-500 mb-1",children:"Diamond"}),t.jsx("div",{className:"text-sm font-semibold text-slate-800",children:l})]}),t.jsxs("div",{className:"w-24",children:[t.jsx("div",{className:"text-xs font-medium text-slate-500 mb-1",children:"Count"}),t.jsx("input",{type:"number",min:"1",step:"1",required:!0,value:c,onChange:h=>{const m=h.target.value;se(n,j,"diamonds_count",m)},className:`w-full rounded-lg border px-2.5 py-1.5 text-sm font-mono transition-colors ${!c||c===""?"border-rose-300 bg-rose-50 text-rose-500 focus:border-rose-400 focus:bg-white":"border-slate-200 bg-white text-slate-700 focus:border-sky-400"} focus:outline-none focus:ring-1 focus:ring-sky-200`,placeholder:"0"})]})]},j)}):t.jsx("span",{className:"text-sm text-slate-400",children:"—"})})}),t.jsx("td",{className:"px-5 py-3 align-middle text-slate-700",children:t.jsx("div",{className:"space-y-3 min-w-[250px]",children:v.length>0?v.map((o,j)=>{const l=o.colorstone_id&&ie?.find(h=>h.id===o.colorstone_id)?.name||"Colorstone",c=o.stones_count||"";return t.jsxs("div",{className:"flex items-center gap-3 rounded-lg border border-slate-200 bg-slate-50/50 p-3",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-xs font-medium text-slate-500 mb-1",children:"Colorstone"}),t.jsx("div",{className:"text-sm font-semibold text-slate-800",children:l})]}),t.jsxs("div",{className:"w-24",children:[t.jsx("div",{className:"text-xs font-medium text-slate-500 mb-1",children:"Count"}),t.jsx("input",{type:"number",min:"1",step:"1",required:!0,value:c,onChange:h=>{const m=h.target.value;Ze(n,j,"stones_count",m)},className:`w-full rounded-lg border px-2.5 py-1.5 text-sm font-mono transition-colors ${!c||c===""?"border-rose-300 bg-rose-50 text-rose-500 focus:border-rose-400 focus:bg-white":"border-slate-200 bg-white text-slate-700 focus:border-sky-400"} focus:outline-none focus:ring-1 focus:ring-sky-200`,placeholder:"0"})]})]},j)}):t.jsx("span",{className:"text-sm text-slate-400",children:"—"})})}),t.jsx("td",{className:"px-5 py-3 align-middle text-slate-700",children:t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsx("input",{type:"number",min:"0",step:"1",required:!0,value:e.inventory_quantity!==void 0&&e.inventory_quantity!==null&&e.inventory_quantity!==""?String(e.inventory_quantity):"",onChange:o=>{const j=o.target.value.trim();if(j==="")Q(n,"inventory_quantity","");else{const l=parseInt(j,10);!isNaN(l)&&l>=0&&Q(n,"inventory_quantity",l)}},className:`w-full min-w-[100px] rounded-xl border px-3 py-1.5 text-sm text-slate-700 transition-colors ${e.inventory_quantity===void 0||e.inventory_quantity===null||e.inventory_quantity===""?"border-rose-300 bg-rose-50 text-rose-500 focus:border-rose-400 focus:bg-white":"border-slate-200 bg-white focus:border-sky-400"} focus:outline-none focus:ring-2 focus:ring-sky-200`,placeholder:"0"}),(e.inventory_quantity===void 0||e.inventory_quantity===null||e.inventory_quantity==="")&&t.jsx("span",{className:"text-[10px] text-rose-500",children:"Required"})]})}),t.jsx("td",{className:"px-5 py-3 text-slate-700",children:t.jsxs("select",{value:q,onChange:o=>Oe(n,{status:o.target.value}),className:`rounded-xl border px-3 py-1.5 text-sm text-slate-700 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200 ${q==="enabled"?"border-emerald-300 bg-emerald-50":"border-amber-300 bg-amber-50"}`,children:[t.jsx("option",{value:"enabled",children:"Enabled"}),t.jsx("option",{value:"disabled",children:"Disabled"})]})}),t.jsx("td",{className:"px-5 py-3 text-slate-700",children:t.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[t.jsx("input",{type:"radio",name:"default-variant-table",checked:e.is_default,onChange:()=>Ie(n),className:"h-4 w-4 text-sky-600 focus:ring-sky-500"}),t.jsx("span",{children:e.is_default?"Default":"Set default"})]})}),t.jsx("td",{className:"px-5 py-3 text-right",children:t.jsx("div",{className:"flex items-center justify-end gap-2",children:t.jsx("button",{type:"button",onClick:()=>We(n),className:"inline-flex items-center justify-center rounded-full border border-rose-200 p-1.5 text-rose-600 transition hover:border-rose-300 hover:text-rose-700","aria-label":"Remove variant",title:"Remove Variant",children:t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,className:"h-4 w-4",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 7h12m-9 3v6m6-6v6M10 4h4a1 1 0 0 1 1 1v1H9V5a1 1 0 0 1 1-1Z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 7h14l-.8 11.2A2 2 0 0 1 16.2 20H7.8a2 2 0 0 1-1.99-1.8L5 7Z"})]})})})})]},e.id??`variant-${n}`),Se.has(n)&&t.jsx("tr",{children:t.jsx("td",{colSpan:13,className:"px-5 py-4",children:t.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[t.jsx("div",{className:"mb-4 flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Metals for this Variant"}),t.jsxs("p",{className:"mt-1 text-xs text-slate-600",children:[t.jsx("span",{className:"font-semibold text-rose-600",children:"Required:"})," Enter metal weight (in grams) for each metal in this variant."]})]})}),d.length===0?t.jsx("p",{className:"text-xs text-slate-400",children:"No metals assigned to this variant."}):t.jsx("div",{className:"space-y-3",children:d.map((o,j)=>{const l=W[o.metal_id]||"Unknown Metal",c=o.metal_purity_id&&typeof o.metal_purity_id=="number"&&A.find(m=>m.id===o.metal_purity_id)?.name||"",h=o.metal_tone_id&&typeof o.metal_tone_id=="number"&&P.find(m=>m.id===o.metal_tone_id)?.name||"";return t.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[t.jsx("div",{className:"mb-3 flex items-center justify-between",children:t.jsxs("span",{className:"text-xs font-semibold text-slate-600",children:[l,c&&` — ${c}`,h&&` — ${h}`]})}),t.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:t.jsxs("label",{className:"flex flex-col gap-1.5",children:[t.jsxs("span",{className:"text-xs font-semibold text-slate-700 flex items-center gap-1",children:[t.jsx("span",{children:"Metal Weight (g)"}),t.jsx("span",{className:"text-rose-500 font-bold text-sm",title:"Required field",children:"*"})]}),t.jsx("input",{type:"number",step:"0.001",min:"0.001",required:!0,value:o.metal_weight||"",onChange:m=>{const N=m.target.value;pe(n,j,"metal_weight",N)},className:`rounded-xl border-2 px-3 py-2 text-sm font-medium transition-colors ${o.metal_weight?"border-slate-200 bg-white focus:border-sky-400":"border-rose-300 bg-rose-50 focus:border-rose-400 focus:bg-white"} focus:outline-none focus:ring-2 focus:ring-sky-200`,placeholder:"Enter weight (required)"}),!o.metal_weight&&t.jsx("span",{className:"text-xs text-rose-600 font-medium",children:"⚠️ This field is required"})]})})]},j)})})]})})}),ze.has(n)&&t.jsx("tr",{children:t.jsx("td",{colSpan:13,className:"px-5 py-4",children:t.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Diamonds for this Variant"}),x.diamond_mixing_mode==="shared"&&t.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"This variant uses the shared diamond list defined above. All variants share the same diamonds."}),x.diamond_mixing_mode==="as_variant"&&t.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"This variant has its specific diamond from the diamond mixes list. Each variant-diamond combination is a separate sellable variant."})]}),x.diamond_mixing_mode==="shared"&&t.jsx("p",{className:"mb-4 text-xs text-slate-500",children:'In "shared" mode, diamonds are managed in the "Diamond mixes" section above. All variants use the same diamond list.'}),x.diamond_mixing_mode==="as_variant"&&t.jsxs("button",{type:"button",onClick:()=>He(n),className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-white px-3 py-1.5 text-xs font-semibold text-slate-700 transition hover:border-sky-400 hover:bg-sky-50",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 5v14M5 12h14"})}),"Add Diamond"]})]}),p.length===0?t.jsx("p",{className:"text-xs text-slate-400",children:x.diamond_mixing_mode==="shared"?"No diamonds assigned to this variant from the shared matrix.":'No diamonds added to this variant. Click "Add Diamond" to add one.'}):t.jsx("div",{className:"space-y-3",children:p.map((o,j)=>t.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[t.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[t.jsxs("span",{className:"text-xs font-semibold text-slate-600",children:["Diamond #",j+1]}),x.diamond_mixing_mode==="as_variant"&&t.jsx("button",{type:"button",onClick:()=>Ge(n,j),className:"text-xs text-rose-500 transition hover:text-rose-700",children:"Remove"})]}),t.jsxs("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:[t.jsxs("label",{className:"flex flex-col gap-1.5 text-xs font-medium text-slate-600",children:["Diamond",t.jsxs("select",{value:typeof o.diamond_id=="string"||!o.diamond_id?"":String(o.diamond_id),onChange:l=>se(n,j,"diamond_id",l.target.value===""?"":Number(l.target.value)),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[t.jsx("option",{value:"",children:"Select diamond"}),(X||[]).map(l=>t.jsx("option",{value:l.id,children:l.name},l.id))]})]}),t.jsxs("label",{className:"flex flex-col gap-1.5 text-xs font-medium text-slate-600",children:["Number of Diamonds",t.jsx("input",{type:"number",step:"1",min:"0",value:o.diamonds_count,onChange:l=>se(n,j,"diamonds_count",l.target.value),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"0"})]})]})]},j))})]})})})]})}),(x.variants||[]).length===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:17,className:"px-5 py-6 text-center text-xs uppercase tracking-[0.1em] text-slate-400",children:"No variants configured. Generate matrix to create variants."})})]})]})})})]})]})]})}export{_t as default};
