import{u as _,r as c,a as w,j as e,H as k,L as C}from"./app-DkJetrPT.js";import{A as S}from"./AuthenticatedLayout-DSD5Ys5v.js";import"./FlashMessage-BT8-rBiH.js";const j=[{value:"catalogue",label:"Catalogue design",helper:"Customise an existing AurumCraft design with metal / variant tweaks."},{value:"custom",label:"Upload bespoke concept",helper:"Share brand-new concepts with references, AI renders, or CAD briefs."}];function I(){const{prefillProduct:t,defaultVariantId:u,jobworks:o,offers:m}=_().props,[i,b]=c.useState(t?"catalogue":"custom"),[x,p]=c.useState(""),{data:r,setData:a,post:y,processing:h,errors:n}=w({submission_mode:t?"catalogue":"custom",product_id:t?.id??null,product_variant_id:u??null,type:"customer_supplied",reference_design:"",reference_url:"",reference_media:[],metal:t?.material??"",purity:t?.purity??"",diamond_quality:"",quantity:1,special_instructions:"",delivery_deadline:"",wastage_percentage:"",manufacturing_charge:""});c.useEffect(()=>{a("submission_mode",i),i==="catalogue"&&t&&(a("product_id",t.id),a("metal",t.material??""),a("purity",t.purity??""),a("product_variant_id",u??null)),i==="custom"&&(a("product_id",null),a("product_variant_id",null))},[i]),c.useEffect(()=>{const s=x.split(`
`).map(l=>l.trim()).filter(l=>l.length>0);a("reference_media",s)},[x]),c.useEffect(()=>{t&&t.media.length&&p(t.media.map(s=>s.url).join(`
`))},[t]);const g=c.useMemo(()=>!t||!r.product_variant_id?null:t.variants.find(s=>s.id===r.product_variant_id)??null,[t,r.product_variant_id]),f=c.useMemo(()=>{if(!t)return null;const s=t.base_price??0,l=t.making_charge??0,d=g?.price_adjustment??0;return s+l+d},[t,g]),N=s=>{s.preventDefault(),y(route("frontend.jobwork.store"),{preserveScroll:!0})};return e.jsxs(S,{children:[e.jsx(k,{title:"Jobwork & Custom Manufacturing"}),e.jsxs("div",{className:"space-y-10",children:[e.jsx("section",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:e.jsxs("div",{className:"flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold text-slate-900",children:"Create a production brief"}),e.jsx("p",{className:"mt-2 text-sm text-slate-500",children:"Share modification requirements for catalogue pieces or submit brand-new concepts. Our production concierge will revert with quotes and timelines."})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-500",children:[e.jsxs("span",{className:"inline-flex items-center rounded-full border border-slate-200 px-3 py-1 font-medium text-slate-700",children:["Current requests: ",o.length]}),e.jsxs(C,{href:route("frontend.catalog.index"),className:"inline-flex items-center gap-2 rounded-full bg-slate-900 px-4 py-2 font-semibold text-white shadow-slate-900/30 transition hover:bg-slate-700",children:["Browse catalogue",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})}),e.jsxs("section",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:j.map(s=>{const l=!t&&s.value==="catalogue";return e.jsx("button",{type:"button",onClick:()=>!l&&b(s.value),disabled:l,className:`rounded-full px-4 py-2 text-sm font-semibold transition ${i===s.value?"bg-slate-900 text-white shadow-slate-900/30":"bg-slate-100 text-slate-600 hover:bg-slate-200"} ${l?"cursor-not-allowed opacity-60":""}`,children:s.label},s.value)})}),e.jsxs("p",{className:"mt-3 text-xs text-slate-500",children:[j.find(s=>s.value===i)?.helper,!t&&i==="catalogue"&&e.jsx("span",{className:"ml-2 font-semibold text-amber-600",children:"Select a catalogue design first from Browse Catalogue."})]}),e.jsx("form",{onSubmit:N,className:"mt-6 space-y-6",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[i==="catalogue"&&t?e.jsxs("div",{className:"space-y-4 rounded-2xl border border-slate-200 p-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Design selected"}),e.jsx("h2",{className:"mt-1 text-lg font-semibold text-slate-900",children:t.name}),e.jsxs("p",{className:"text-xs text-slate-500",children:["SKU ",t.sku]})]}),e.jsxs("div",{className:"grid gap-3 text-sm text-slate-600 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-500",children:"Base value"}),e.jsxs("p",{className:"text-slate-900",children:["₹ ",(t.base_price??0).toLocaleString("en-IN")]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-500",children:"Making charge"}),e.jsxs("p",{className:"text-slate-900",children:["₹ ",(t.making_charge??0).toLocaleString("en-IN")]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-500",children:"Gross weight"}),e.jsxs("p",{className:"text-slate-900",children:[t.gross_weight?.toFixed(2)," g"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-500",children:"Purity"}),e.jsx("p",{className:"text-slate-900",children:t.purity})]})]}),t.standard_pricing&&e.jsxs("div",{className:"rounded-xl bg-slate-50 p-4 text-xs text-slate-600",children:[e.jsx("p",{className:"font-semibold text-slate-700",children:"Standard pricing snapshot"}),e.jsx("ul",{className:"mt-2 space-y-1",children:Object.entries(t.standard_pricing).map(([s,l])=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{className:"uppercase tracking-wide text-slate-500",children:s.replace("_"," ")}),e.jsx("span",{className:"text-slate-800",children:typeof l=="number"?l.toLocaleString("en-IN"):l})]},s))})]}),t.variants.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Select variant"}),e.jsx("div",{className:"grid gap-2",children:t.variants.map(s=>{const l=r.product_variant_id===s.id,d=s.price_adjustment,v=d===0?"Standard":`${d>0?"+":""}₹ ${Math.abs(d).toLocaleString("en-IN")}`;return e.jsxs("label",{className:`flex cursor-pointer items-center justify-between rounded-2xl border px-4 py-3 text-sm transition ${l?"border-sky-500 bg-sky-50 text-slate-900":"border-slate-200 bg-white text-slate-600 hover:border-sky-300"}`,children:[e.jsx("span",{children:s.label}),e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500",children:v}),e.jsx("input",{type:"radio",name:"product_variant_id",value:s.id,checked:l,onChange:()=>a("product_variant_id",s.id),className:"h-4 w-4 text-sky-600 focus:ring-sky-500"})]})]},s.id)})})]}),f!==null&&e.jsxs("div",{className:"rounded-xl bg-slate-900 px-4 py-3 text-sm text-white",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-white/70",children:"Estimated total"}),e.jsxs("p",{className:"mt-1 text-lg font-semibold",children:["₹ ",f.toLocaleString("en-IN")]}),e.jsx("p",{className:"text-xs text-white/70",children:"Final value subject to labour & offer adjustments."})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Reference design summary *"}),e.jsx("textarea",{className:"min-h-[120px] rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",value:r.reference_design,onChange:s=>a("reference_design",s.target.value),placeholder:"Describe materials, gemstone placements, finishing details, packaging expectations…"}),n.reference_design&&e.jsx("span",{className:"text-xs text-rose-500",children:n.reference_design})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Reference media URLs (one per line)"}),e.jsx("textarea",{className:"min-h-[120px] rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",value:x,onChange:s=>p(s.target.value),placeholder:"https://…"}),n.reference_media&&e.jsx("span",{className:"text-xs text-rose-500",children:n.reference_media})]})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Supply Type"}),e.jsxs("select",{className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",value:r.type,onChange:s=>a("type",s.target.value),children:[e.jsx("option",{value:"customer_supplied",children:"Customer supplying metal/stone"}),e.jsx("option",{value:"vendor_supplied",children:"AurumCraft supplying metal/stone"})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Metal"}),e.jsx("input",{type:"text",className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",value:r.metal,onChange:s=>a("metal",s.target.value)}),n.metal&&e.jsx("span",{className:"text-xs text-rose-500",children:n.metal})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Purity"}),e.jsx("input",{type:"text",className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",value:r.purity,onChange:s=>a("purity",s.target.value)}),n.purity&&e.jsx("span",{className:"text-xs text-rose-500",children:n.purity})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Diamond / Stone quality"}),e.jsx("input",{type:"text",className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",value:r.diamond_quality,onChange:s=>a("diamond_quality",s.target.value)})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Quantity"}),e.jsx("input",{type:"number",min:1,className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",value:r.quantity,onChange:s=>a("quantity",Number(s.target.value)||1)}),n.quantity&&e.jsx("span",{className:"text-xs text-rose-500",children:n.quantity})]})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Special instructions"}),e.jsx("textarea",{className:"min-h-[100px] rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",value:r.special_instructions,onChange:s=>a("special_instructions",s.target.value)})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Delivery deadline"}),e.jsx("input",{type:"date",className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",value:r.delivery_deadline,onChange:s=>a("delivery_deadline",s.target.value)}),n.delivery_deadline&&e.jsx("span",{className:"text-xs text-rose-500",children:n.delivery_deadline})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Wastage %"}),e.jsx("input",{type:"number",step:"0.01",className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",value:r.wastage_percentage,onChange:s=>a("wastage_percentage",s.target.value)})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Manufacturing charge (₹)"}),e.jsx("input",{type:"number",step:"0.01",className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",value:r.manufacturing_charge,onChange:s=>a("manufacturing_charge",s.target.value)})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Active offer playbook"}),e.jsx("ul",{className:"mt-3 space-y-3 text-sm text-slate-600",children:m.length?m.map(s=>e.jsxs("li",{className:"rounded-xl bg-slate-50 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold text-slate-800",children:s.name}),e.jsx("span",{className:"text-xs uppercase tracking-[0.35em] text-slate-500",children:s.code})]}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:s.description})]},s.code)):e.jsx("li",{className:"text-xs text-slate-500",children:"No active offers configured."})})]}),t&&t.media.length>0&&e.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:t.media.map(s=>e.jsx("img",{src:s.url,alt:s.alt,className:"h-36 w-full rounded-2xl object-cover shadow"},s.url))}),e.jsx("button",{type:"submit",disabled:h,className:"w-full rounded-full bg-sky-600 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-sky-600/30 transition hover:bg-sky-500 disabled:cursor-not-allowed disabled:opacity-60",children:h?"Submitting…":"Submit jobwork request"})]})]})})]}),e.jsxs("section",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Recent jobwork briefs"}),e.jsxs("span",{className:"text-xs text-slate-500",children:["Showing latest ",o.length]})]}),e.jsx("div",{className:"mt-4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs uppercase tracking-[0.3em] text-slate-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:"Reference"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Design"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Mode"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Qty"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Delivery"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Created"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[o.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-800",children:s.reference}),e.jsxs("td",{className:"px-4 py-3 text-slate-600",children:[s.product??"Custom",s.variant?e.jsx("span",{className:"block text-xs text-slate-400",children:s.variant}):null]}),e.jsx("td",{className:"px-4 py-3 capitalize text-slate-500",children:s.submission_mode}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:s.quantity}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"inline-flex rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-600",children:s.status})}),e.jsx("td",{className:"px-4 py-3 text-slate-500",children:s.delivery_deadline??"—"}),e.jsx("td",{className:"px-4 py-3 text-slate-500",children:s.created_at})]},s.id)),o.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-6 text-center text-sm text-slate-500",children:"No jobwork requests yet. Submit your first brief above."})})]})]})})]})]})]})}export{I as default};
