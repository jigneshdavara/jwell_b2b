import{j as e,u as re,r as d,a as ie,H as oe,L as J,R as ce,b as _}from"./app-BCnxwFoh.js";import{A as de}from"./AuthenticatedLayout-BNxGNSSN.js";import{M as Q}from"./Modal-B5FdPJP8.js";import"./ApplicationLogo-DW29TYwh.js";import"./FlashMessage-CntUQ1_S.js";import"./transition-CYMZ8zw2.js";function R({currentPage:r,totalPages:i,totalItems:C,itemsPerPage:v,onPageChange:h,onItemsPerPageChange:S,startIndex:q,endIndex:N}){if(C===0)return null;const I=()=>{const x=[];if(i<=5)for(let m=1;m<=i;m++)x.push(m);else{x.push(1),r>3&&x.push("...");const m=Math.max(2,r-1),a=Math.min(i-1,r+1);for(let j=m;j<=a;j++)x.push(j);r<i-2&&x.push("..."),x.push(i)}return x};return e.jsxs("div",{className:"flex flex-col gap-4 border-t border-slate-200 bg-white px-4 py-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-4",children:[e.jsxs("span",{className:"text-sm text-slate-600",children:["Showing ",e.jsx("span",{className:"font-semibold text-slate-900",children:q+1})," to"," ",e.jsx("span",{className:"font-semibold text-slate-900",children:Math.min(N,C)})," of"," ",e.jsx("span",{className:"font-semibold text-slate-900",children:C})," items"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{htmlFor:"items-per-page",className:"text-sm text-slate-600",children:"Show:"}),e.jsxs("select",{id:"items-per-page",value:v,onChange:x=>S(Number(x.target.value)),className:"rounded-lg border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 shadow-sm focus:border-elvee-blue focus:outline-none focus:ring-2 focus:ring-elvee-blue/20",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]})]})]}),i>1&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>h(r-1),disabled:r===1,className:"inline-flex h-9 w-9 items-center justify-center rounded-lg border border-slate-300 bg-white text-slate-600 transition hover:bg-slate-50 hover:text-slate-900 disabled:cursor-not-allowed disabled:opacity-50 disabled:hover:bg-white","aria-label":"Previous page",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-5 w-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})})}),e.jsx("div",{className:"flex items-center gap-1",children:I().map((x,y)=>{if(x==="...")return e.jsx("span",{className:"px-2 text-sm text-slate-400",children:"..."},`ellipsis-${y}`);const m=x,a=m===r;return e.jsx("button",{type:"button",onClick:()=>h(m),className:`inline-flex h-9 min-w-[2.25rem] items-center justify-center rounded-lg border px-3 text-sm font-medium transition ${a?"border-elvee-blue bg-elvee-blue text-white shadow-sm":"border-slate-300 bg-white text-slate-600 hover:bg-slate-50 hover:text-slate-900"}`,"aria-label":`Go to page ${m}`,"aria-current":a?"page":void 0,children:m},m)})}),e.jsx("button",{type:"button",onClick:()=>h(r+1),disabled:r===i,className:"inline-flex h-9 w-9 items-center justify-center rounded-lg border border-slate-300 bg-white text-slate-600 transition hover:bg-slate-50 hover:text-slate-900 disabled:cursor-not-allowed disabled:opacity-50 disabled:hover:bg-white","aria-label":"Next page",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-5 w-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})})]})]})}const xe=r=>new Intl.NumberFormat("en-IN",{style:"currency",currency:r,maximumFractionDigits:0});function ge(){const{cart:r}=re().props,i=d.useMemo(()=>xe(r.currency||"INR"),[r.currency]),[C,v]=d.useState(!1),[h,S]=d.useState(!1),[q,N]=d.useState(null),[I,x]=d.useState({}),[y,m]=d.useState([]),[a,j]=d.useState(null),[U,K]=d.useState(new Set),[A,F]=d.useState(new Set),[f,O]=d.useState(10),[W,B]=d.useState(1),Y=d.useMemo(()=>r.items.reduce((t,l)=>t+l.quantity,0),[r.items]),z=d.useMemo(()=>r.items.filter(t=>(t.configuration?.mode??"purchase")==="jobwork").length,[r.items]),D=d.useMemo(()=>{const t=new Map;return r.items.forEach(l=>{if(t.has(l.product_id)){const n=t.get(l.product_id),s=`${l.product_variant_id??"null"}_${JSON.stringify(l.configuration??{})}`;if(n.variants.has(s)){const o=n.variants.get(s);o.quantity+=l.quantity,o.line_total+=l.line_total,o.line_subtotal=(o.line_subtotal??0)+(l.line_subtotal??l.line_total),o.line_discount=(o.line_discount??0)+(l.line_discount??0),o.mergedItemIds.push(l.id)}else n.variants.set(s,{...l,mergedItemIds:[l.id]})}else{const n=`${l.product_variant_id??"null"}_${JSON.stringify(l.configuration??{})}`,s=new Map;s.set(n,{...l,mergedItemIds:[l.id]}),t.set(l.product_id,{product:l,variants:s})}}),Array.from(t.values()).map(l=>({product:l.product,variants:Array.from(l.variants.values()).map(n=>{const s=n.quantity>0?n.line_total/n.quantity:n.unit_total;return{...n,unit_total:Math.round(s*100)/100}})}))},[r.items]),P=d.useMemo(()=>D.map(t=>{const l=t.variants.reduce((c,u)=>c+u.quantity,0),n=t.variants.reduce((c,u)=>c+u.line_total,0),s=t.variants.some(c=>(c.configuration?.mode??"purchase")==="jobwork"),o=t.variants.some(c=>(c.configuration?.mode??"purchase")==="purchase");return{...t,totalQuantity:l,totalPrice:n,hasJobwork:s,hasPurchase:o}}),[D]),M=P.length,T=Math.ceil(M/f),L=(W-1)*f,E=L+f,G=d.useMemo(()=>P.slice(L,E),[P,L,E]),X=t=>{K(l=>{const n=new Set(l);return n.has(t)?n.delete(t):n.add(t),n})};d.useEffect(()=>{B(1)},[f]);const{data:$,setData:Z,post:me}=ie({comment:""});d.useEffect(()=>{const t={};r.items.forEach(l=>{t[l.id]=l.configuration?.notes??""}),x(t)},[r.items]);const V=(t,l)=>{const n=l>0?1:-1,s=t.mergedItemIds&&t.mergedItemIds.length>1?t.mergedItemIds[0]:t.id;if(A.has(s))return;const o=Number(t.quantity)||0,c=Math.max(1,o+n),u=t.inventory_quantity??null;if(u!==null&&(u===0||n>0&&c>u))return;F(b=>new Set(b).add(s));const p=()=>{F(b=>{const w=new Set(b);return w.delete(s),w})};t.mergedItemIds&&t.mergedItemIds.length>1?_.patch(route("frontend.cart.items.update",t.mergedItemIds[0]),{quantity:c},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{const b=t.mergedItemIds.slice(1);if(b.length===0){p();return}let w=0;b.forEach(ae=>{_.delete(route("frontend.cart.items.destroy",ae),{preserveScroll:!0,preserveState:!0,onFinish:()=>{w++,w===b.length&&p()},onError:()=>{w++,w===b.length&&p()}})})},onError:p}):_.patch(route("frontend.cart.items.update",t.id),{quantity:c},{preserveScroll:!0,preserveState:!0,onFinish:p,onError:p})},ee=(t,l)=>{_.patch(route("frontend.cart.items.update",t.id),{configuration:l},{preserveScroll:!0,preserveState:!0})},te=t=>{_.delete(route("frontend.cart.items.destroy",t.id),{preserveScroll:!0})},se=t=>{x(l=>({...l,[t.id]:t.configuration?.notes??""})),N(t.id)},ne=t=>{ee(t,{notes:I[t.id]||null}),N(null)},g=r.items.length===0,H=()=>{if(g)return;const t={},l=[];r.items.forEach(n=>{if(n.inventory_quantity!==null&&n.inventory_quantity!==void 0&&n.product_variant_id){const s=n.product_variant_id;t[s]||(t[s]={variant:n.inventory_quantity,product:n.name,total:0}),t[s].total+=n.quantity}}),Object.values(t).forEach(({variant:n,product:s,total:o})=>{n===0?l.push(`${s} is currently out of stock.`):n!=null&&o>n&&l.push(`Total quantity requested for ${s} is ${o}, but only ${n} ${n===1?"item is":"items are"} available.`)}),m(l),v(!0)},le=()=>{if(h||g)return;const t={},l=[];if(r.items.forEach(n=>{if(n.inventory_quantity!==null&&n.inventory_quantity!==void 0&&n.product_variant_id){const s=n.product_variant_id;t[s]||(t[s]={variant:n.inventory_quantity,product:n.name,total:0}),t[s].total+=n.quantity}}),Object.values(t).forEach(({variant:n,product:s,total:o})=>{n===0?l.push(`${s} is currently out of stock.`):n!=null&&o>n&&l.push(`Total quantity requested for ${s} is ${o}, but only ${n} ${n===1?"item is":"items are"} available.`)}),l.length>0){m(l);return}m([]),S(!0),_.post(route("frontend.quotations.store-from-cart"),{cart_comment:$.comment||null},{preserveScroll:!0,onSuccess:()=>v(!1),onError:n=>{n.quantity&&alert(Array.isArray(n.quantity)?n.quantity.join(`
`):n.quantity)},onFinish:()=>S(!1)})},k=q?r.items.find(t=>t.id===q):null;return e.jsxs(de,{children:[e.jsx(oe,{title:"Quotation list"}),e.jsxs("div",{className:"space-y-10",id:"cart",children:[e.jsx("header",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:e.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold text-slate-900",children:"Quotation list"}),e.jsx("p",{className:"mt-2 text-sm text-slate-500",children:"Review and submit all quotation requests together for merchandising review."})]}),e.jsxs("button",{type:"button",onClick:H,disabled:g,className:`inline-flex items-center gap-2 rounded-full px-5 py-2 text-sm font-semibold transition ${g?"cursor-not-allowed bg-slate-300 text-slate-500":"bg-elvee-blue text-white shadow-lg shadow-elvee-blue/30 hover:bg-navy"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-4 w-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Submit all quotations"]})]})}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[2fr_1fr]",children:[e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"rounded-2xl bg-white shadow-xl ring-1 ring-slate-200/80",children:g?e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4 p-16 text-sm text-slate-500",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,className:"h-12 w-12 text-slate-300",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsx("p",{children:"Your cart is empty. Explore the catalogue to add designs."}),e.jsxs(J,{href:route("frontend.catalog.index"),className:"inline-flex items-center gap-2 rounded-full bg-slate-900 px-5 py-2 text-sm font-semibold text-white hover:bg-slate-700",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-4 w-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Browse catalogue"]})]}):e.jsxs(e.Fragment,{children:[M>f&&e.jsx(R,{currentPage:W,totalPages:T,totalItems:M,itemsPerPage:f,onPageChange:B,onItemsPerPageChange:O,startIndex:L,endIndex:E}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold uppercase tracking-wider text-slate-700",children:"Product"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-semibold uppercase tracking-wider text-slate-700",children:"Mode"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-semibold uppercase tracking-wider text-slate-700",children:"Quantity"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold uppercase tracking-wider text-slate-700",children:"Unit Price"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold uppercase tracking-wider text-slate-700",children:"Total"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-semibold uppercase tracking-wider text-slate-700",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 bg-white",children:G.map(t=>{const l=U.has(t.product.product_id),n=t.variants.length;return e.jsxs(ce.Fragment,{children:[e.jsxs("tr",{className:"transition hover:bg-slate-50/50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>X(t.product.product_id),className:"flex-shrink-0 text-slate-400 transition hover:text-slate-600","aria-label":l?"Collapse variants":"Expand variants",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:`h-5 w-5 transition-transform ${l?"rotate-90":""}`,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})}),t.product.thumbnail&&e.jsx("img",{src:t.product.thumbnail,alt:t.product.name,className:"h-16 w-16 flex-shrink-0 rounded-lg object-cover shadow-sm"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(J,{href:route("frontend.catalog.show",{product:t.product.product_id}),className:"text-sm font-semibold text-slate-900 truncate hover:text-feather-gold transition",children:t.product.name}),e.jsxs("p",{className:"text-xs text-slate-400",children:["SKU ",t.product.sku]}),n>1&&e.jsxs("p",{className:"mt-0.5 text-xs font-medium text-slate-500",children:[n," ",n===1?"variant":"variants"]})]})]})}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-center",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-1",children:[t.hasPurchase&&e.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full bg-slate-100 px-2.5 py-1 text-xs font-semibold text-slate-700",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-3 w-3",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09z"})}),"Purchase"]}),t.hasJobwork&&e.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full bg-blue-100 px-2.5 py-1 text-xs font-semibold text-blue-700",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-3 w-3",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.42 15.17L17.25 21A2.652 2.652 0 0021 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655-5.653a2.548 2.548 0 00-3.586 3.586l4.655 5.653m8.048-8.048l-2.496 3.03a2.548 2.548 0 01-3.586-3.586l2.496-3.03"})}),"Jobwork"]})]})}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-center",children:e.jsx("span",{className:"text-sm font-semibold text-slate-900",children:t.totalQuantity})}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-right text-sm text-slate-500",children:n>1?"—":i.format(t.product.unit_total)}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-right",children:e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:i.format(t.totalPrice)})}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-center",children:e.jsx("div",{className:"flex items-center justify-center gap-2",children:e.jsx("button",{type:"button",onClick:()=>j(t.product),className:"inline-flex h-8 w-8 items-center justify-center rounded-lg text-slate-500 transition hover:bg-slate-100 hover:text-elvee-blue","aria-label":"View product details",title:"View product details",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-4 w-4",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})})})]}),l&&n>0&&e.jsx(e.Fragment,{children:t.variants.map(s=>e.jsxs("tr",{className:"bg-slate-50/30 transition hover:bg-slate-50/50",children:[e.jsx("td",{className:"px-6 py-3 pl-20",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"min-w-0 flex-1",children:[s.variant_label&&e.jsx("p",{className:"text-xs font-medium text-slate-700",children:s.variant_label}),e.jsxs("div",{className:"mt-1 flex items-center gap-2 text-xs text-slate-500",children:[s.price_breakdown.metal&&s.price_breakdown.metal>0&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:["Metal ",i.format(s.price_breakdown.metal)]}),e.jsx("span",{children:"·"})]}),s.price_breakdown.diamond&&s.price_breakdown.diamond>0&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:["Diamond ",i.format(s.price_breakdown.diamond)]}),e.jsx("span",{children:"·"})]}),s.price_breakdown.colorstone&&s.price_breakdown.colorstone>0&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:["Colorstone ",i.format(s.price_breakdown.colorstone)]}),e.jsx("span",{children:"·"})]}),e.jsxs("span",{children:["Making ",i.format(s.price_breakdown.making??0)]})]}),(s.line_discount??0)>0&&e.jsxs("p",{className:"mt-1 text-xs font-semibold text-emerald-600",children:["Discount −",i.format(s.line_discount??0)]})]})})}),e.jsx("td",{className:"whitespace-nowrap px-6 py-3 text-center",children:e.jsx("span",{className:`inline-flex items-center gap-1.5 rounded-full px-2.5 py-1 text-xs font-semibold ${(s.configuration?.mode??"purchase")==="jobwork"?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-700"}`,children:(s.configuration?.mode??"purchase")==="jobwork"?"Jobwork":"Purchase"})}),e.jsx("td",{className:"whitespace-nowrap px-6 py-3",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-1",children:[e.jsx("div",{className:"flex items-center justify-center gap-2",children:(()=>{const o=s.mergedItemIds&&s.mergedItemIds.length>1?s.mergedItemIds[0]:s.id,c=A.has(o),u=!c&&s.quantity>1,p=!c&&(s.inventory_quantity===null||s.inventory_quantity===void 0||s.inventory_quantity>0&&s.quantity<s.inventory_quantity);return e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>V(s,-1),disabled:!u,className:"inline-flex h-7 w-7 items-center justify-center rounded-lg border border-slate-200 text-slate-500 transition hover:border-slate-300 hover:bg-slate-50 hover:text-slate-700 disabled:cursor-not-allowed disabled:opacity-50","aria-label":"Decrease quantity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-4 w-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20 12H4"})})}),e.jsx("span",{className:"min-w-[2rem] text-center text-sm font-semibold text-slate-900",children:s.quantity}),e.jsx("button",{type:"button",onClick:()=>V(s,1),disabled:!p,className:"inline-flex h-7 w-7 items-center justify-center rounded-lg border border-slate-200 text-slate-500 transition hover:border-slate-300 hover:bg-slate-50 hover:text-slate-700 disabled:cursor-not-allowed disabled:opacity-50","aria-label":"Increase quantity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-4 w-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})})})]})})()}),s.inventory_quantity!==null&&s.inventory_quantity!==void 0&&s.quantity>s.inventory_quantity&&e.jsxs("span",{className:"text-xs text-rose-500",children:["Only ",s.inventory_quantity," ",s.inventory_quantity===1?"item is":"items are"," available"]})]})}),e.jsx("td",{className:"whitespace-nowrap px-6 py-3 text-right text-sm font-medium text-slate-900",children:i.format(s.unit_total)}),e.jsx("td",{className:"whitespace-nowrap px-6 py-3 text-right",children:e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:i.format(s.line_total)})}),e.jsx("td",{className:"whitespace-nowrap px-6 py-3 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>se(s),className:"inline-flex h-8 w-8 items-center justify-center rounded-lg text-slate-500 transition hover:bg-slate-100 hover:text-feather-gold","aria-label":"Edit notes",title:s.configuration?.notes?"View/edit notes":"Add notes",children:s.configuration?.notes?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-4 w-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-4 w-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})})}),e.jsx("button",{type:"button",onClick:()=>te(s),className:"inline-flex h-8 w-8 items-center justify-center rounded-lg text-slate-500 transition hover:bg-rose-50 hover:text-rose-600","aria-label":"Remove variant",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-4 w-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})})})]})})]},s.id))})]},t.product.product_id)})})]})}),M>f&&e.jsx(R,{currentPage:W,totalPages:T,totalItems:M,itemsPerPage:f,onPageChange:B,onItemsPerPageChange:O,startIndex:L,endIndex:E})]})})}),e.jsxs("aside",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-2xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Summary"}),e.jsxs("div",{className:"mt-4 space-y-3 text-sm text-slate-600",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{className:"font-medium",children:i.format(r.subtotal)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Tax"}),e.jsx("span",{className:"font-medium",children:i.format(r.tax)})]}),r.discount>0&&e.jsxs("div",{className:"flex items-center justify-between text-emerald-600",children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{className:"font-medium",children:["-",i.format(r.discount)]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Shipping"}),e.jsx("span",{className:"font-medium",children:i.format(r.shipping)})]}),e.jsx("div",{className:"border-t border-slate-200 pt-3",children:e.jsxs("div",{className:"flex items-center justify-between text-base font-semibold text-slate-900",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:i.format(r.total)})]})})]})]}),e.jsxs("div",{className:"rounded-2xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Cart Notes"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Add a comment for all items in this cart"}),e.jsx("textarea",{value:$.comment,onChange:t=>Z("comment",t.target.value),className:"mt-3 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",placeholder:"Add notes for the merchandising team...",rows:4})]}),e.jsxs("button",{type:"button",onClick:H,disabled:g,className:`w-full inline-flex items-center justify-center gap-2 rounded-full px-4 py-3 text-sm font-semibold transition ${g?"cursor-not-allowed bg-slate-300 text-slate-500":"bg-elvee-blue text-white shadow-lg shadow-elvee-blue/30 hover:bg-navy"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-4 w-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Submit quotations"]})]})]})]}),e.jsx(Q,{show:C,onClose:()=>h?void 0:(v(!1),m([])),maxWidth:"lg",children:e.jsxs("div",{className:"space-y-5 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Submit all quotation requests?"}),e.jsx("p",{className:"text-sm text-slate-600",children:"We will create separate quotation tickets for each product so the merchandising team can review the details. You can still add more items afterwards."}),y.length>0&&e.jsx("div",{className:"rounded-2xl border border-rose-300 bg-rose-50 p-4 text-sm text-rose-800",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"h-5 w-5 flex-shrink-0 text-rose-600 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold mb-2",children:"Inventory Not Available"}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:y.map((t,l)=>e.jsx("li",{children:t},l))})]})]})}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-4 text-sm text-slate-600",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-slate-800",children:"Products selected:"})," ",r.items.length]}),e.jsxs("p",{className:"mt-1",children:[e.jsx("span",{className:"font-semibold text-slate-800",children:"Total units:"})," ",Y]}),z>0&&e.jsxs("p",{className:"mt-1",children:[e.jsx("span",{className:"font-semibold text-slate-800",children:"Jobwork requests:"})," ",z]}),e.jsxs("p",{className:"mt-1",children:[e.jsx("span",{className:"font-semibold text-slate-800",children:"Estimated total:"})," ",i.format(r.total)]}),$.comment&&e.jsxs("div",{className:"mt-3 rounded-lg bg-white p-3",children:[e.jsx("p",{className:"text-xs font-semibold text-slate-700",children:"Cart Notes:"}),e.jsx("p",{className:"mt-1 text-xs text-slate-600",children:$.comment})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>h?void 0:v(!1),className:"inline-flex items-center justify-center rounded-full border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-600 transition hover:border-slate-300 hover:text-slate-900",disabled:h,children:"Cancel"}),e.jsx("button",{type:"button",onClick:le,disabled:h||y.length>0,className:"inline-flex items-center justify-center rounded-full bg-elvee-blue px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-elvee-blue/30 transition hover:bg-navy disabled:cursor-not-allowed disabled:opacity-60",children:h?"Submitting…":"Confirm & submit"})]})]})}),e.jsx(Q,{show:q!==null,onClose:()=>N(null),maxWidth:"md",children:k&&e.jsxs("div",{className:"space-y-4 p-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900",children:["Notes for ",k.name]}),e.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["SKU ",k.sku]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Notes"}),e.jsx("textarea",{value:I[k.id]||"",onChange:t=>x(l=>({...l,[k.id]:t.target.value})),className:"mt-2 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",placeholder:"Share expectations or deadlines...",rows:5})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>N(null),className:"inline-flex items-center justify-center rounded-full border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-600 transition hover:border-slate-300 hover:text-slate-900",children:"Cancel"}),e.jsx("button",{type:"button",onClick:()=>ne(k),className:"inline-flex items-center justify-center rounded-full bg-elvee-blue px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-elvee-blue/30 transition hover:bg-navy",children:"Save notes"})]})]})}),a&&e.jsx(Q,{show:!0,onClose:()=>j(null),maxWidth:"lg",children:e.jsxs("div",{className:"flex min-h-0 flex-col",children:[e.jsx("div",{className:"flex-shrink-0 border-b border-slate-200 px-5 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-base font-semibold text-slate-900",children:"Quick View"}),e.jsx("button",{type:"button",onClick:()=>j(null),className:"text-slate-400 transition hover:text-slate-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-5 w-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx("div",{className:"min-h-0 flex-1 overflow-y-auto px-5 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[a.thumbnail&&e.jsx("img",{src:a.thumbnail,alt:a.name,className:"h-24 w-24 flex-shrink-0 rounded-lg object-cover shadow-md"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold text-slate-900",children:a.name}),e.jsxs("p",{className:"mt-0.5 text-xs text-slate-500",children:["SKU: ",a.sku]}),a.variant_label&&e.jsx("p",{className:"mt-1 text-xs font-medium text-slate-600",children:a.variant_label}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[e.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-semibold ${(a.configuration?.mode??"purchase")==="jobwork"?"bg-elvee-blue/10 text-elvee-blue":"bg-slate-200 text-slate-700"}`,children:(a.configuration?.mode??"purchase")==="jobwork"?"Jobwork":"Purchase"}),e.jsxs("span",{className:"inline-flex items-center rounded-full bg-slate-200 px-2 py-0.5 text-xs font-semibold text-slate-700",children:["Qty: ",a.quantity]})]})]})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-3",children:[e.jsx("h5",{className:"mb-2 text-xs font-semibold uppercase tracking-wide text-slate-700",children:"Price Breakdown"}),e.jsx("div",{className:"space-y-1.5 text-xs",children:(()=>{const t=a.price_breakdown||{},l=Number(t.metal)||0,n=Number(t.diamond)||0,s=Number(t.colorstone)||0,o=Number(t.making)||0,c=Number(t.adjustment)||0,u=a.unit_total,p=a.line_total;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1",children:[l>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Metal:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:i.format(l)})]}),n>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Diamond:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:i.format(n)})]}),s>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Colorstone:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:i.format(s)})]}),o>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Making:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:i.format(o)})]}),c!==0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Adjustment:"}),e.jsxs("span",{className:`font-semibold ${c>0?"text-emerald-600":"text-rose-600"}`,children:[c>0?"+":"",i.format(c)]})]})]}),e.jsxs("div",{className:"border-t border-slate-300 pt-1.5 mt-1.5",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:"Unit Price:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:i.format(u)})]}),a.quantity>1&&e.jsxs("div",{className:"mt-0.5 flex justify-between text-xs text-slate-500",children:[e.jsxs("span",{children:[a.quantity," × ",i.format(u)]}),e.jsxs("span",{className:"font-semibold text-slate-700",children:["= ",i.format(p)]})]})]})]})})()})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.variant_label&&e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-2.5",children:[e.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Variant"}),e.jsx("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:a.variant_label})]}),a.inventory_quantity!==null&&a.inventory_quantity!==void 0&&e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-2.5",children:[e.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Stock"}),e.jsxs("p",{className:`mt-1 text-sm font-semibold ${a.inventory_quantity>0?"text-emerald-600":"text-rose-600"}`,children:[a.inventory_quantity," ",a.inventory_quantity===1?"item":"items"]})]})]}),a.configuration?.selections&&typeof a.configuration.selections=="object"&&a.configuration.selections!==null&&Object.keys(a.configuration.selections).length>0&&e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-2.5",children:[e.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide mb-2",children:"Options"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[Object.entries(a.configuration.selections).slice(0,3).map(([t,l])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-slate-600 capitalize",children:[t.replace(/_/g," "),":"]}),e.jsx("span",{className:"font-medium text-slate-900",children:l==null||l===""?"—":typeof l=="boolean"?l?"Yes":"No":String(l)})]},t)),Object.keys(a.configuration.selections).length>3&&e.jsxs("p",{className:"text-xs text-slate-400 pt-1",children:["+",Object.keys(a.configuration.selections).length-3," more"]})]})]}),a.configuration?.notes&&e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-2.5",children:[e.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1.5",children:"Notes"}),e.jsx("p",{className:"text-xs text-slate-700 line-clamp-3",children:a.configuration.notes})]})]})})]})})]})}export{ge as default};
