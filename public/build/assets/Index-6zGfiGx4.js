import{u as R,r as o,j as e,H as G,b as n,L as H}from"./app-DlYpOb3X.js";import{A as K}from"./AdminLayout-vRMPHNh2.js";import{C as k}from"./ConfirmationModal-BDCbnuIN.js";import"./Modal-0S1MFaok.js";import"./transition-Ckw0ApPS.js";import"./SecondaryButton-1hOPi0EW.js";const W={pending:"bg-amber-100 text-amber-700",review:"bg-amber-100 text-amber-700",approved:"bg-emerald-100 text-emerald-700",rejected:"bg-rose-100 text-rose-700"};function X(){const{users:s,kycStatuses:v,filters:i,stats:Y,customerGroups:j,perPageOptions:S}=R().props,[x,y]=o.useState(i.search??""),[a,u]=o.useState([]),[d,N]=o.useState(s.meta?.per_page??20),[p,w]=o.useState(i.type??""),[m,C]=o.useState(i.customer_group_id?String(i.customer_group_id):""),[D,h]=o.useState(!1),[g,b]=o.useState(null),A=o.useMemo(()=>["all",...v],[v]),L=t=>{const l={search:x||void 0,per_page:d!==(s.meta?.per_page??20)?d:void 0,customer_group_id:m||void 0,type:p||void 0,status:t==="all"?void 0:t};n.get(route("admin.customers.index"),l,{preserveState:!0,replace:!0,preserveScroll:!0})},_=()=>{n.get(route("admin.customers.index"),{search:x||void 0,status:i.status??void 0,per_page:d,customer_group_id:m||void 0,type:p||void 0},{preserveState:!0,replace:!0,preserveScroll:!0})},F=t=>{u(t?s.data.map(l=>l.id):[])},M=(t,l)=>{u(r=>l?[...r,t]:r.filter(c=>c!==t))},f=()=>u([]),T=()=>{a.length!==0&&h(!0)},$=()=>{n.delete(route("admin.customers.bulk-destroy"),{data:{ids:a},preserveScroll:!0,onFinish:()=>{f(),h(!1)}})},B=t=>{a.length!==0&&n.post(route("admin.customers.bulk-group-update"),{ids:a,customer_group_id:t||null},{preserveScroll:!0,onFinish:f})},P=t=>{b(t)},E=()=>{g&&n.delete(route("admin.customers.destroy",g),{preserveScroll:!0,onSuccess:()=>{b(null)}})},I=t=>{n.post(route("admin.customers.toggle-status",t.id),{},{preserveScroll:!0})};return e.jsxs(K,{children:[e.jsx(G,{title:"Customers & KYC"}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("section",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:[e.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500",children:"Search name or email"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:x,onChange:t=>y(t.target.value),placeholder:"Jane Doe or jane@studio.com",className:"w-full rounded-2xl border border-slate-300 px-4 py-2 text-sm text-slate-700 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20"}),e.jsx("button",{type:"button",onClick:_,className:"rounded-2xl bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow shadow-slate-900/20 transition hover:bg-slate-700",children:"Apply"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500",children:"Customer group"}),e.jsxs("select",{value:m,onChange:t=>C(t.target.value),className:"w-full rounded-2xl border border-slate-300 px-4 py-2 text-sm text-slate-700 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",children:[e.jsx("option",{value:"",children:"All groups"}),j.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500",children:"Customer type"}),e.jsxs("select",{value:p,onChange:t=>w(t.target.value),className:"w-full rounded-2xl border border-slate-300 px-4 py-2 text-sm text-slate-700 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",children:[e.jsx("option",{value:"",children:"All types"}),e.jsx("option",{value:"retailer",children:"Retailer"}),e.jsx("option",{value:"wholesaler",children:"Wholesaler"})]})]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3 border-t border-slate-200 pt-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs font-semibold text-slate-600",children:[e.jsx("span",{children:"Status:"}),A.map(t=>{const l=(i.status??"all")===t;return e.jsx("button",{type:"button",onClick:()=>L(t),className:`rounded-full px-3 py-1 transition ${l?"bg-slate-900 text-white shadow shadow-slate-900/20":"bg-slate-100 text-slate-500 hover:bg-slate-200"}`,children:t==="all"?"All":t.replace(/_/g," ")},t)})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[e.jsx("span",{children:"Show"}),e.jsx("select",{value:d,onChange:t=>N(Number(t.target.value)),className:"rounded-xl border border-slate-300 px-3 py-1 text-sm",children:S.map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx("span",{children:"entries"})]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2 text-xs text-slate-500",children:[e.jsx("button",{type:"button",onClick:_,className:"rounded-full border border-slate-200 px-4 py-1.5 font-semibold text-slate-600 hover:border-slate-300 hover:text-slate-900",children:"Apply filters"}),e.jsx("button",{type:"button",onClick:()=>{y(""),C(""),w(""),N(s.meta?.per_page??20),n.get(route("admin.customers.index"))},className:"rounded-full border border-slate-200 px-4 py-1.5 font-semibold text-slate-600 hover:border-slate-300 hover:text-slate-900",children:"Reset"})]})]}),a.length>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-3 rounded-3xl bg-slate-900 px-6 py-4 text-sm text-white shadow-lg shadow-slate-900/20",children:[e.jsxs("span",{children:[a.length," selected"]}),e.jsx("button",{type:"button",onClick:T,className:"inline-flex items-center gap-2 rounded-full bg-rose-500 px-4 py-1.5 text-xs font-semibold text-white shadow shadow-rose-500/20 transition hover:bg-rose-400",children:"Delete selected"}),e.jsxs("select",{className:"rounded-full border border-white/30 bg-white/10 px-3 py-1 text-xs font-semibold text-white focus:border-white focus:outline-none",value:"",onChange:t=>{B(t.target.value)},children:[e.jsx("option",{value:"",children:"Assign to group…"}),j.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("button",{type:"button",onClick:f,className:"text-xs text-white/80 hover:text-white transition",children:"Clear selection"})]}),e.jsx("div",{className:"overflow-hidden rounded-3xl bg-white shadow-xl shadow-slate-900/10 ring-1 ring-slate-200/80",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs font-semibold uppercase text-slate-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-5 py-3",children:e.jsx("input",{type:"checkbox",checked:a.length>0&&a.length===s.data.length,onChange:t=>F(t.target.checked),className:"h-4 w-4 rounded border-slate-300 text-elvee-blue focus:ring-feather-gold","aria-label":"Select all customers"})}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Name"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Email"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Type"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Customer group"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"KYC Status"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Status"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Docs"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Joined"}),e.jsx("th",{className:"px-5 py-3 text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100 bg-white",children:[s.data.map(t=>{const l=W[t.kyc_status]??"bg-slate-100 text-slate-600",r=a.includes(t.id);return e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-5 py-3",children:e.jsx("input",{type:"checkbox",checked:r,onChange:c=>M(t.id,c.target.checked),className:"h-4 w-4 rounded border-slate-300 text-elvee-blue focus:ring-feather-gold","aria-label":`Select ${t.name}`})}),e.jsx("td",{className:"px-5 py-3 font-medium text-slate-900",children:t.name}),e.jsx("td",{className:"px-5 py-3 text-slate-600",children:t.email}),e.jsx("td",{className:"px-5 py-3 text-slate-500",children:t.type}),e.jsx("td",{className:"px-5 py-3 text-slate-500",children:t.customer_group?.name??"—"}),e.jsx("td",{className:"px-5 py-3",children:e.jsx("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold ${l}`,children:t.kyc_status_label})}),e.jsx("td",{className:"px-5 py-3",children:e.jsx("button",{type:"button",onClick:()=>I(t),className:`inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold transition ${t.is_active?"bg-emerald-100 text-emerald-700 hover:bg-emerald-200":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:t.is_active?"Enabled":"Disabled"})}),e.jsx("td",{className:"px-5 py-3 text-slate-500",children:t.kyc_document_count}),e.jsx("td",{className:"px-5 py-3 text-slate-500",children:t.joined_at?new Date(t.joined_at).toLocaleDateString("en-IN"):"—"}),e.jsx("td",{className:"px-5 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(H,{href:route("admin.customers.kyc.show",t.id),className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-slate-200 text-slate-500 transition hover:border-slate-300 hover:text-slate-900",title:"Review KYC",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5l7.5 7.5-7.5 7.5m-7.5-7.5h15"})})}),e.jsx("button",{type:"button",onClick:()=>P(t.id),className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-rose-200 text-rose-500 transition hover:border-rose-300 hover:bg-rose-50 hover:text-rose-600",title:"Delete customer",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 7h12M9 7V4a1 1 0 011-1h4a1 1 0 011 1v3m1 0v12a2 2 0 01-2 2H8a2 2 0 01-2-2V7h12z"})})})]})})]},t.id)}),s.data.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"px-5 py-6 text-center text-sm text-slate-500",children:"No customers found."})})]})]})}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 text-sm text-slate-600",children:[e.jsxs("div",{children:["Showing ",((s.meta?.current_page??1)-1)*(s.meta?.per_page??20)+1," to"," ",Math.min((s.meta?.current_page??1)*(s.meta?.per_page??20),s.meta?.total??0)," of ",s.meta?.total??0," entries"]}),e.jsx("div",{className:"flex gap-2",children:Array.from({length:s.meta?.last_page??1}).map((t,l)=>{const r=l+1,c=r===(s.meta?.current_page??1);return e.jsx("button",{type:"button",onClick:()=>{n.get(route("admin.customers.index"),{page:r,search:x||void 0,status:i.status??void 0,customer_group_id:m||void 0,type:p||void 0,per_page:d},{preserveState:!0,preserveScroll:!0})},className:`rounded-full px-3 py-1 text-sm font-semibold transition ${c?"bg-elvee-blue text-white shadow shadow-elvee-blue/20":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:r},r)})})]})]}),e.jsx(k,{show:D,onClose:()=>h(!1),onConfirm:$,title:"Delete Customers",message:`Are you sure you want to delete ${a.length} selected customer(s)? This cannot be undone.`,confirmText:"Delete",variant:"danger"}),e.jsx(k,{show:g!==null,onClose:()=>b(null),onConfirm:E,title:"Delete Customer",message:"Are you sure you want to delete this customer? This action is irreversible.",confirmText:"Delete",variant:"danger"})]})}export{X as default};
