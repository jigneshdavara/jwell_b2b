import{u as xe,r as o,a as N,j as e,H as ue,L as Z,b as J}from"./app-ZBegTQyu.js";import{A as he}from"./AdminLayout-DkY62K2h.js";import{M as O}from"./Modal-8lhaXcBJ.js";import{C as pe}from"./ConfirmationModal-CIlv-B1G.js";import"./transition-CeUlJuWy.js";import"./SecondaryButton-DyfTcdly.js";const be={pending:"bg-amber-100 text-amber-700",approved:"bg-emerald-100 text-emerald-700",rejected:"bg-rose-100 text-rose-700",pending_customer_confirmation:"bg-amber-100 text-amber-700",customer_confirmed:"bg-emerald-100 text-emerald-700",customer_declined:"bg-rose-100 text-rose-700"},p=s=>s?new Date(s).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";function we(){const{quotation:s}=xe().props,[b,E]=o.useState(null),[F,V]=o.useState(!1),[v,y]=o.useState(""),[K,j]=o.useState([]),[u,w]=o.useState(null),[k,S]=o.useState(""),[$,g]=o.useState([]),[h,_]=o.useState(null),[R,T]=o.useState(!1),[B,C]=o.useState(s.status==="pending_customer_confirmation"),[i,f]=o.useState(""),[d,Q]=o.useState(null),[D,U]=o.useState({show:!1,itemId:null}),X=N({admin_notes:s.admin_notes??""}),G=N({admin_notes:s.admin_notes??""}),x=N({message:""}),c=N({product_id:"",product_variant_id:"",quantity:1,admin_notes:""}),m=N({product_id:"",product_variant_id:"",quantity:1,admin_notes:""}),I=s.related_quotations&&s.related_quotations.length>0?[s,...s.related_quotations]:[s],[W,H]=o.useState(!1);o.useEffect(()=>{if(!b||!W||v.length<2){W||j([]);return}const t=setTimeout(()=>{const a=new URL(route("admin.products.index"),window.location.origin);a.searchParams.set("search",v),a.searchParams.set("per_page","10"),fetch(a.toString(),{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json","X-Inertia":"true"}}).then(l=>l.json()).then(l=>{const n=l.props?.products?.data||[];j(n.map(r=>({id:r.id,name:r.name,sku:r.sku})))}).catch(()=>{j([])})},300);return()=>clearTimeout(t)},[v,b,W]),o.useEffect(()=>{if(!F||!R||k.length<2){R||g([]);return}const t=setTimeout(()=>{const a=new URL(route("admin.products.index"),window.location.origin);a.searchParams.set("search",k),a.searchParams.set("per_page","10"),fetch(a.toString(),{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json","X-Inertia":"true"}}).then(l=>l.json()).then(l=>{const n=l.props?.products?.data||[];g(n.map(r=>({id:r.id,name:r.name,sku:r.sku})))}).catch(()=>{g([])})},300);return()=>clearTimeout(t)},[k,F,R]);const Y=t=>{E(t.id),H(!1),c.setData({product_id:t.product.id.toString(),product_variant_id:t.variant?.id.toString()??"",quantity:t.quantity,admin_notes:""}),y(t.product.name),w({id:t.product.id,name:t.product.name,sku:t.product.sku,variants:t.product.variants}),j([])},A=()=>{E(null),y(""),j([]),w(null),H(!1),c.reset()},ee=t=>{c.setData("product_id",t.id.toString()),c.setData("product_variant_id",""),y(t.name);const a=I.find(l=>l.product.id===t.id);a?.product.variants?w({...t,variants:a.product.variants}):w({...t,variants:[]})},te=t=>{t.preventDefault(),b&&c.post(route("admin.quotations.update-product",b),{preserveScroll:!0,onSuccess:()=>{C(!0),f("request_confirmation"),A()}})},se=()=>{V(!0),T(!1),m.setData({product_id:"",product_variant_id:"",quantity:1,admin_notes:""}),S(""),_(null),g([])},L=()=>{V(!1),S(""),g([]),_(null),T(!1),m.reset()},ae=t=>{m.setData("product_id",t.id.toString()),m.setData("product_variant_id",""),S(t.name);const a=I.find(l=>l.product.id===t.id);a?.product.variants?_({...t,variants:a.product.variants}):_({...t,variants:[]})},le=t=>{t.preventDefault(),m.post(route("admin.quotations.add-item",s.id),{preserveScroll:!0,onSuccess:()=>{C(!0),f("request_confirmation"),L()}})},re=t=>{t.preventDefault(),x.data.message.trim()&&x.post(route("admin.quotations.messages.store",s.id),{preserveScroll:!0,onSuccess:()=>x.reset("message")})};return e.jsxs(he,{children:[e.jsx(ue,{title:`Quotation #${s.id}`}),e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h1",{className:"text-2xl font-semibold text-slate-900",children:["Quotation #",s.id]}),e.jsx(Z,{href:route("admin.quotations.index"),className:"inline-flex items-center gap-2 rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-600 transition hover:border-slate-400 hover:text-slate-900",children:"Back to list"})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:e.jsxs("div",{className:"grid gap-8 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:"From"}),e.jsx("p",{className:"mt-3 text-lg font-semibold text-slate-900",children:"Elvee"}),e.jsx("p",{className:"mt-1 text-sm text-slate-600",children:"123 Business Street"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Mumbai, Maharashtra 400001"}),e.jsx("p",{className:"mt-2 text-sm text-slate-600",children:"Phone: +91 98765 43210"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Email: info@elvee.com"}),e.jsx("p",{className:"mt-2 text-sm text-slate-600",children:"GSTIN: 27AAAAA0000A1Z5"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:"Bill To"}),e.jsx("p",{className:"mt-3 text-lg font-semibold text-slate-900",children:s.user?.name??"Unknown"}),e.jsx("p",{className:"mt-1 text-sm text-slate-600",children:s.user?.email??"—"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:"Quotation Details"}),e.jsxs("p",{className:"mt-3 text-lg font-semibold text-slate-900",children:["#",s.id]}),e.jsxs("p",{className:"mt-1 text-sm text-slate-500",children:["Date: ",e.jsx("span",{className:"font-semibold text-slate-900",children:s.created_at&&p(s.created_at)})]}),e.jsx("div",{className:"mt-3 flex justify-end gap-2",children:e.jsx("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-[11px] font-semibold ${be[s.status]??"bg-slate-200 text-slate-700"}`,children:s.status.replace(/_/g," ")})})]})]})}),e.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Items"}),e.jsxs("button",{type:"button",onClick:se,className:"inline-flex items-center gap-2 rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-slate-900/20 transition hover:bg-slate-700",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-4 w-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),"Add Item"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b-2 border-slate-200 bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Item"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Unit Price"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600",children:"Qty"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:I.map(t=>{const a=t.price_breakdown||{},l=Number(a.metal)||0,n=Number(a.diamond)||0,r=Number(a.making)||0,M=Number(a.total)||l+n+r,q=M*(Number(t.quantity)||0);return e.jsxs("tr",{className:"hover:bg-slate-50/50 transition",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[t.product.media?.[0]&&e.jsx("img",{src:t.product.media[0].url,alt:t.product.media[0].alt,className:"h-12 w-12 rounded-lg object-cover shadow-sm"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:t.product.name}),e.jsxs("p",{className:"text-xs text-slate-400",children:["SKU ",t.product.sku]}),t.variant&&e.jsx("p",{className:"mt-0.5 text-xs font-medium text-slate-500",children:t.variant.metadata?.auto_label||t.variant.label}),t.notes&&e.jsxs("p",{className:"mt-1 text-xs text-slate-500 italic",children:["Note: ",t.notes]})]})]})}),e.jsxs("td",{className:"px-4 py-4 text-right",children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:["₹ ",M.toLocaleString("en-IN")]}),e.jsxs("div",{className:"text-xs text-slate-400",children:[l>0&&`Metal: ₹ ${l.toLocaleString("en-IN")}`,l>0&&(n>0||r>0)&&" + ",n>0&&`Diamond: ₹ ${n.toLocaleString("en-IN")}`,n>0&&r>0&&" + ",r>0&&`Making: ₹ ${r.toLocaleString("en-IN")}`]})]}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"font-semibold text-slate-900",children:t.quantity})}),e.jsx("td",{className:"px-4 py-4 text-right",children:e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:["₹ ",q.toLocaleString("en-IN")]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>Q(t),className:"inline-flex items-center gap-1 rounded-full border border-elvee-blue/30 px-2.5 py-1.5 text-[10px] font-semibold text-elvee-blue transition hover:border-elvee-blue hover:bg-elvee-blue/5",title:"View product details",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-3 w-3",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"})})}),e.jsx("button",{type:"button",onClick:()=>Y(t),className:"inline-flex items-center gap-1 rounded-full border border-slate-300 px-2.5 py-1.5 text-[10px] font-semibold text-slate-700 transition hover:border-slate-400 hover:bg-slate-50",title:"Change product",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-3 w-3",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})})}),e.jsx("button",{type:"button",onClick:()=>{U({show:!0,itemId:t.id})},className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-rose-200 text-rose-600 transition hover:border-rose-300 hover:bg-rose-50",title:"Remove item",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 7h12M9 7V4a1 1 0 011-1h4a1 1 0 011 1v3m1 0v12a2 2 0 01-2 2H8a2 2 0 01-2-2V7h12z"})})})]})})]},t.id)})}),e.jsx("tfoot",{className:"border-t-2 border-slate-200 bg-slate-50",children:(()=>{const t=I.reduce((q,z)=>{const P=z.price_breakdown||{},ne=Number(P.metal)||0,oe=Number(P.diamond)||0,ie=Number(P.making)||0,de=Number(P.total)||ne+oe+ie,ce=Number(z.quantity)||0,me=de*ce;return q.totalBase+=me,q},{totalBase:0}),a=s.tax_summary,l=a?a.subtotal:t.totalBase,n=a?a.tax:0,r=a?a.total:l+n,M=s.tax_rate??18;return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{colSpan:4,className:"px-4 py-2 text-right text-sm text-slate-600",children:"Subtotal"}),e.jsxs("td",{className:"px-4 py-2 text-right text-sm font-semibold text-slate-900",children:["₹ ",l.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("td",{})]}),e.jsxs("tr",{children:[e.jsxs("td",{colSpan:4,className:"px-4 py-2 text-right text-sm text-slate-600",children:["GST (",M,"%)"]}),e.jsxs("td",{className:"px-4 py-2 text-right text-sm font-semibold text-slate-900",children:["₹ ",n.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("td",{})]}),e.jsxs("tr",{className:"border-t-2 border-slate-300",children:[e.jsx("td",{colSpan:4,className:"px-4 py-3 text-right text-base font-bold text-slate-900",children:"Grand Total"}),e.jsxs("td",{className:"px-4 py-3 text-right text-lg font-bold text-slate-900",children:["₹ ",r.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("td",{})]})]})})()})]})})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-6",children:[s.order&&e.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Linked Order"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-400",children:"Order Reference"}),e.jsx(Z,{href:route("admin.orders.show",s.order.id),className:"mt-1 text-base font-semibold text-sky-600 hover:text-sky-500",children:s.order.reference})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-400",children:"Status"}),e.jsx("p",{className:"mt-1 text-base font-semibold text-slate-900",children:s.order.status.replace(/_/g," ")})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 sm:col-span-2",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-400",children:"Total Amount"}),e.jsxs("p",{className:"mt-1 text-xl font-semibold text-slate-900",children:["₹ ",s.order.total_amount.toLocaleString("en-IN")]})]})]}),s.order?.history?.length?e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:"Status Timeline"}),e.jsx("div",{className:"mt-3 space-y-2",children:s.order.history.map(t=>e.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("span",{className:"text-sm font-semibold text-slate-700",children:t.status.replace(/_/g," ")}),e.jsx("span",{className:"text-xs text-slate-400",children:p(t.created_at)})]},t.id))})]}):null]})]}),e.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Quotation Timeline"}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-400",children:"Created"}),e.jsx("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:p(s.created_at)})]})})}),s.approved_at&&e.jsx("div",{className:"rounded-2xl border border-emerald-200 bg-emerald-50 px-4 py-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-emerald-600",children:"Approved"}),e.jsx("p",{className:"mt-1 text-sm font-semibold text-emerald-900",children:p(s.approved_at)})]})})}),s.updated_at&&s.updated_at!==s.created_at&&e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-400",children:"Last Updated"}),e.jsx("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:p(s.updated_at)})]})})})]})]}),e.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Conversation"}),e.jsxs("div",{className:"mt-4 space-y-3 max-h-96 overflow-y-auto pr-2 text-sm text-slate-600",children:[s.messages.length===0&&e.jsx("p",{className:"text-xs text-slate-400",children:"No messages yet. Start by sending the customer a note below."}),s.messages.map(t=>e.jsxs("div",{className:`flex flex-col gap-2 rounded-2xl border px-4 py-3 ${t.sender==="admin"?"border-slate-200 bg-slate-50":"border-sky-200 bg-sky-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between text-[11px] uppercase tracking-[0.25em] text-slate-400",children:[e.jsx("span",{className:"font-semibold",children:t.sender==="admin"?t.author??"Admin":"Customer"}),e.jsx("span",{children:p(t.created_at)})]}),e.jsx("p",{className:"whitespace-pre-line text-sm text-slate-700",children:t.message})]},t.id))]}),e.jsxs("form",{onSubmit:re,className:"mt-4 space-y-3 text-sm text-slate-600",children:[e.jsxs("label",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-800",children:"Send Message"}),e.jsx("textarea",{value:x.data.message,onChange:t=>x.setData("message",t.target.value),className:"min-h-[100px] rounded-2xl border border-slate-200 px-4 py-3 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Request more information or share updates with the client...",disabled:x.processing})]}),x.errors.message&&e.jsx("p",{className:"text-xs text-rose-500",children:x.errors.message}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:x.processing||!x.data.message.trim(),className:"rounded-full bg-sky-600 px-4 py-2 text-xs font-semibold text-white shadow-sky-600/30 transition hover:bg-sky-500 disabled:cursor-not-allowed disabled:opacity-60",children:x.processing?"Sending…":"Send message"})})]})]})]}),e.jsxs("aside",{className:"space-y-6",children:[s.admin_notes&&e.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Admin Notes"}),e.jsx("p",{className:"mt-3 whitespace-pre-line text-sm text-slate-600",children:s.admin_notes})]}),e.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:[e.jsx("h2",{className:"mb-4 text-lg font-semibold text-slate-900",children:"Actions"}),B&&e.jsxs("div",{className:"mb-4 rounded-xl border-2 border-amber-400 bg-amber-50 p-3",children:[e.jsx("p",{className:"text-sm font-semibold text-amber-800",children:"Changes detected"}),e.jsx("p",{className:"mt-1 text-xs text-amber-700",children:"Product or quantity has been modified. Request customer confirmation to save changes."})]}),e.jsxs("form",{onSubmit:t=>{if(t.preventDefault(),!i)return;const l=new FormData(t.currentTarget).get("notes");i==="approve"?(X.setData("admin_notes",l),X.post(route("admin.quotations.approve",s.id),{preserveScroll:!0})):i==="reject"?(G.setData("admin_notes",l),G.post(route("admin.quotations.reject",s.id),{preserveScroll:!0})):i==="request_confirmation"&&J.post(route("admin.quotations.request-confirmation",s.id),{notes:l},{preserveScroll:!0,onSuccess:()=>{C(!1),f("")}})},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-semibold text-slate-700",children:"Action"}),e.jsxs("select",{name:"action",value:i,onChange:t=>f(t.target.value),className:"w-full rounded-xl border border-slate-200 px-4 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[e.jsx("option",{value:"",children:"Select an action..."}),(s.status==="pending"||s.status==="customer_confirmed")&&e.jsx("option",{value:"approve",children:"Approve Quotation"}),s.status!=="rejected"&&e.jsx("option",{value:"reject",children:"Reject Quotation"}),e.jsx("option",{value:"request_confirmation",children:"Request Customer Confirmation"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-semibold text-slate-700",children:i==="approve"?"Internal Notes":i==="reject"?"Reason / Feedback":"Notes"}),e.jsx("textarea",{name:"notes",rows:4,className:"w-full rounded-xl border border-slate-200 px-4 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:i==="approve"?"Add internal notes...":i==="reject"?"Add reason for rejection...":i==="request_confirmation"?"Explain changes or pricing impact...":"Add notes..."})]}),e.jsx("button",{type:"submit",disabled:!i,className:`w-full rounded-full px-4 py-2 text-sm font-semibold text-white shadow-lg transition disabled:cursor-not-allowed disabled:opacity-70 ${i==="approve"?"bg-emerald-600 shadow-emerald-600/30 hover:bg-emerald-500":i==="reject"?"bg-rose-600 shadow-rose-600/30 hover:bg-rose-500":B?"bg-amber-600 shadow-amber-600/30 hover:bg-amber-500":"bg-sky-600 shadow-sky-600/30 hover:bg-sky-500"}`,children:i==="approve"?"Approve Quotation":i==="reject"?"Reject Quotation":B?"Request Confirmation (Changes Pending)":"Request Confirmation"})]})]})]})]})]})]}),d&&e.jsx(O,{show:!0,onClose:()=>Q(null),maxWidth:"4xl",children:e.jsxs("div",{className:"flex min-h-0 flex-col",children:[e.jsx("div",{className:"flex-shrink-0 border-b border-slate-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Product Details"}),e.jsx("button",{type:"button",onClick:()=>Q(null),className:"text-slate-400 hover:text-slate-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-5 w-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx("div",{className:"min-h-0 flex-1 overflow-y-auto px-6 py-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-6",children:[d.product.media?.[0]&&e.jsx("img",{src:d.product.media[0].url,alt:d.product.media[0].alt,className:"h-32 w-32 rounded-lg object-cover shadow-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-xl font-semibold text-slate-900",children:d.product.name}),e.jsxs("p",{className:"mt-1 text-sm text-slate-500",children:["SKU: ",d.product.sku]}),e.jsx("div",{className:"mt-3 flex gap-2",children:e.jsxs("span",{className:"inline-flex items-center rounded-full bg-slate-200 px-3 py-1 text-xs font-semibold text-slate-700",children:["Qty: ",d.quantity]})})]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("h5",{className:"mb-3 text-sm font-semibold text-slate-700",children:"Pricing"}),e.jsx("div",{className:"space-y-2 text-sm",children:(()=>{const t=d.price_breakdown||{},a=Number(t.metal)||0,l=Number(t.diamond)||0,n=Number(t.making)||0,r=Number(t.total)||a+l+n;return e.jsxs(e.Fragment,{children:[a>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Metal:"}),e.jsxs("span",{className:"font-semibold text-slate-900",children:["₹ ",a.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),l>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Diamond:"}),e.jsxs("span",{className:"font-semibold text-slate-900",children:["₹ ",l.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Making Charge:"}),e.jsxs("span",{className:"font-semibold text-slate-900",children:["₹ ",n.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsx("div",{className:"border-t border-slate-300 pt-2",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:"Unit Price:"}),e.jsxs("span",{className:"font-semibold text-slate-900",children:["₹ ",r.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})})]})})()})]}),d.variant&&e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("h5",{className:"mb-3 text-sm font-semibold text-slate-700",children:"Selected Variant"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Label:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:d.variant.label})]}),d.variant.metadata&&Object.keys(d.variant.metadata).length>0&&e.jsxs("div",{className:"mt-3 space-y-1",children:[e.jsx("p",{className:"text-xs font-semibold text-slate-500",children:"Variant Details:"}),Object.entries(d.variant.metadata).map(([t,a])=>e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsxs("span",{className:"text-slate-600",children:[t.replace(/_/g," "),":"]}),e.jsx("span",{className:"font-medium text-slate-900",children:String(a)})]},t))]})]})]}),d.notes&&e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("h5",{className:"mb-3 text-sm font-semibold text-slate-700",children:"Notes"}),e.jsx("p",{className:"text-sm text-slate-700 whitespace-pre-line",children:d.notes})]})]})})]})}),e.jsx(O,{show:b!==null,onClose:A,maxWidth:"4xl",children:e.jsxs("div",{className:"flex min-h-0 flex-col",children:[e.jsx("div",{className:"flex-shrink-0 border-b border-slate-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Change Product"}),e.jsx("button",{type:"button",onClick:A,className:"text-slate-400 hover:text-slate-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-5 w-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx("div",{className:"min-h-0 flex-1 overflow-y-auto px-6 py-4",children:e.jsxs("form",{onSubmit:te,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-semibold text-slate-700",children:"Search Product"}),e.jsx("input",{type:"text",value:v,onChange:t=>{y(t.target.value),H(!0)},placeholder:"Type product name or SKU...",className:"w-full rounded-2xl border border-slate-200 px-4 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200"}),K.length>0&&e.jsx("div",{className:"mt-2 max-h-48 overflow-y-auto rounded-lg border border-slate-200 bg-white",children:K.map(t=>e.jsxs("button",{type:"button",onClick:()=>ee(t),className:"w-full px-4 py-2 text-left text-sm hover:bg-slate-50 transition",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:t.name}),e.jsxs("div",{className:"text-xs text-slate-400",children:["SKU ",t.sku]})]},t.id))})]}),u&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-400",children:"Selected Product"}),e.jsx("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:u.name}),e.jsxs("p",{className:"text-xs text-slate-400",children:["SKU ",u.sku]})]}),u.variants.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-semibold text-slate-700",children:"Variant"}),e.jsxs("select",{value:c.data.product_variant_id,onChange:t=>c.setData("product_variant_id",t.target.value),className:"w-full rounded-2xl border border-slate-200 px-4 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[e.jsx("option",{value:"",children:"No variant"}),u.variants.map(t=>e.jsx("option",{value:t.id,children:t.label},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-semibold text-slate-700",children:"Quantity"}),e.jsx("input",{type:"number",value:c.data.quantity,onChange:t=>c.setData("quantity",parseInt(t.target.value)||1),min:1,className:"w-full rounded-2xl border border-slate-200 px-4 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-semibold text-slate-700",children:"Notes (optional)"}),e.jsx("textarea",{value:c.data.admin_notes,onChange:t=>c.setData("admin_notes",t.target.value),placeholder:"Add notes about this change...",rows:3,className:"w-full rounded-2xl border border-slate-200 px-4 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:A,className:"rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-600 transition hover:border-slate-400 hover:text-slate-900",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:c.processing||!u,className:"rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-slate-900/20 transition hover:bg-slate-700 disabled:cursor-not-allowed disabled:opacity-70",children:c.processing?"Updating...":"Update Product"})]})]})})]})}),e.jsx(O,{show:F,onClose:L,maxWidth:"4xl",children:e.jsxs("div",{className:"flex min-h-0 flex-col",children:[e.jsx("div",{className:"flex-shrink-0 border-b border-slate-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Add Item"}),e.jsx("button",{type:"button",onClick:L,className:"text-slate-400 hover:text-slate-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-5 w-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx("div",{className:"min-h-0 flex-1 overflow-y-auto px-6 py-4",children:e.jsxs("form",{onSubmit:le,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-semibold text-slate-700",children:"Search Product"}),e.jsx("input",{type:"text",value:k,onChange:t=>{S(t.target.value),T(!0)},placeholder:"Type product name or SKU...",className:"w-full rounded-2xl border border-slate-200 px-4 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200"}),$.length>0&&e.jsx("div",{className:"mt-2 max-h-48 overflow-y-auto rounded-lg border border-slate-200 bg-white",children:$.map(t=>e.jsxs("button",{type:"button",onClick:()=>ae(t),className:"w-full px-4 py-2 text-left text-sm hover:bg-slate-50 transition",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:t.name}),e.jsxs("div",{className:"text-xs text-slate-400",children:["SKU ",t.sku]})]},t.id))})]}),h&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-400",children:"Selected Product"}),e.jsx("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:h.name}),e.jsxs("p",{className:"text-xs text-slate-400",children:["SKU ",h.sku]})]}),h.variants.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-semibold text-slate-700",children:"Variant"}),e.jsxs("select",{value:m.data.product_variant_id,onChange:t=>m.setData("product_variant_id",t.target.value),className:"w-full rounded-2xl border border-slate-200 px-4 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[e.jsx("option",{value:"",children:"No variant"}),h.variants.map(t=>e.jsx("option",{value:t.id,children:t.label},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-semibold text-slate-700",children:"Quantity"}),e.jsx("input",{type:"number",value:m.data.quantity,onChange:t=>m.setData("quantity",parseInt(t.target.value)||1),min:1,className:"w-full rounded-2xl border border-slate-200 px-4 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-semibold text-slate-700",children:"Notes (optional)"}),e.jsx("textarea",{value:m.data.admin_notes,onChange:t=>m.setData("admin_notes",t.target.value),placeholder:"Add notes about this item...",rows:3,className:"w-full rounded-2xl border border-slate-200 px-4 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:L,className:"rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-600 transition hover:border-slate-400 hover:text-slate-900",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:m.processing||!h,className:"rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-slate-900/20 transition hover:bg-slate-700 disabled:cursor-not-allowed disabled:opacity-70",children:m.processing?"Adding...":"Add Item"})]})]})})]})}),e.jsx(pe,{show:D.show&&D.itemId!==null,onClose:()=>U({show:!1,itemId:null}),onConfirm:()=>{D.itemId&&J.delete(route("admin.quotations.destroy",D.itemId),{preserveScroll:!0,onSuccess:()=>{C(!0),f("request_confirmation"),U({show:!1,itemId:null})}})},title:"Remove Item",message:"Are you sure you want to remove this item from the quotation?",confirmText:"Remove",variant:"danger"})]})}export{we as default};
