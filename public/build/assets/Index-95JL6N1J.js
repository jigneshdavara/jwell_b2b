import{u as k,r as d,a as L,j as e,H as D,L as E}from"./app-2_233VM5.js";import{A as P}from"./AuthenticatedLayout-BJ0QJLye.js";import"./ApplicationLogo-CyVPGvDd.js";import"./FlashMessage-M_rn5rUv.js";const S=[{value:"catalogue",label:"Catalogue design",helper:"Customise an existing Elvee design with metal / variant tweaks."},{value:"custom",label:"Upload bespoke concept",helper:"Share brand-new concepts with references, AI renders, or CAD briefs."}];function T(){const{prefillProduct:t,defaultVariantId:h,jobworks:u,offers:g,metals:m,metalPurities:f,metalTones:j}=k().props,[o,C]=d.useState(t?"catalogue":"custom"),[p,b]=d.useState(""),[i,N]=d.useState(""),{data:n,setData:l,post:M,processing:v,errors:r}=L({submission_mode:t?"catalogue":"custom",product_id:t?.id??null,product_variant_id:h??null,type:"customer_supplied",reference_design:"",reference_url:"",reference_media:[],metal_id:"",metal_purity_id:"",metal_tone_id:"",metal:t?.material??"",purity:t?.purity??"",diamond_quality:"",quantity:1,special_instructions:"",delivery_deadline:"",wastage_percentage:"",manufacturing_charge:""}),y=d.useMemo(()=>i===""||typeof i!="number"?[]:f.filter(s=>s.metal_id===i),[i,f]),q=d.useMemo(()=>i===""||typeof i!="number"?[]:j.filter(s=>s.metal_id===i),[i,j]);d.useEffect(()=>{if(l("submission_mode",o),o==="catalogue"&&t&&(l("product_id",t.id),l("metal",t.material??""),l("purity",t.purity??""),l("product_variant_id",h??null),t.material)){const s=m.find(a=>a.name.toLowerCase()===t.material?.toLowerCase());s&&(N(s.id),l("metal_id",s.id))}o==="custom"&&(l("product_id",null),l("product_variant_id",null))},[o]),d.useEffect(()=>{const s=p.split(`
`).map(a=>a.trim()).filter(a=>a.length>0);l("reference_media",s)},[p]),d.useEffect(()=>{t&&t.media.length&&b(t.media.map(s=>s.url).join(`
`))},[t]);const _=d.useMemo(()=>!t||!n.product_variant_id?null:t.variants.find(s=>s.id===n.product_variant_id)??null,[t,n.product_variant_id]),w=d.useMemo(()=>{if(!t)return null;const s=t.base_price??0,a=t.making_charge??0,c=_?.price_adjustment??0;return s+a+c},[t,_]),I=s=>{s.preventDefault(),M(route("frontend.jobwork.store"),{preserveScroll:!0})};return e.jsxs(P,{children:[e.jsx(D,{title:"Jobwork & Custom Manufacturing"}),e.jsxs("div",{className:"space-y-10",children:[e.jsx("section",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:e.jsxs("div",{className:"flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold text-slate-900",children:"Create a production brief"}),e.jsx("p",{className:"mt-2 text-sm text-slate-500",children:"Share modification requirements for catalogue pieces or submit brand-new concepts. Our production concierge will revert with quotes and timelines."})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-500",children:[e.jsxs("span",{className:"inline-flex items-center rounded-full border border-slate-200 px-3 py-1 font-medium text-slate-700",children:["Current requests: ",u.length]}),e.jsxs(E,{href:route("frontend.catalog.index"),className:"inline-flex items-center gap-2 rounded-full bg-elvee-blue px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-elvee-blue/30 transition hover:bg-navy",children:["Browse catalogue",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})}),e.jsxs("section",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:S.map(s=>{const a=!t&&s.value==="catalogue";return e.jsx("button",{type:"button",onClick:()=>!a&&C(s.value),disabled:a,className:`rounded-full px-4 py-2 text-sm font-semibold transition ${o===s.value?"bg-slate-900 text-white shadow-slate-900/30":"bg-slate-100 text-slate-600 hover:bg-slate-200"} ${a?"cursor-not-allowed opacity-60":""}`,children:s.label},s.value)})}),e.jsxs("p",{className:"mt-3 text-xs text-slate-500",children:[S.find(s=>s.value===o)?.helper,!t&&o==="catalogue"&&e.jsx("span",{className:"ml-2 font-semibold text-amber-600",children:"Select a catalogue design first from Browse Catalogue."})]}),e.jsx("form",{onSubmit:I,className:"mt-6 space-y-6",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[o==="catalogue"&&t?e.jsxs("div",{className:"space-y-4 rounded-2xl border border-slate-200 p-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Design selected"}),e.jsx("h2",{className:"mt-1 text-lg font-semibold text-slate-900",children:t.name}),e.jsxs("p",{className:"text-xs text-slate-500",children:["SKU ",t.sku]})]}),e.jsxs("div",{className:"grid gap-3 text-sm text-slate-600 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-500",children:"Base value"}),e.jsxs("p",{className:"text-slate-900",children:["₹ ",(t.base_price??0).toLocaleString("en-IN")]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-500",children:"Making charge"}),e.jsxs("p",{className:"text-slate-900",children:["₹ ",(t.making_charge??0).toLocaleString("en-IN")]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-500",children:"Gross weight"}),e.jsxs("p",{className:"text-slate-900",children:[t.gross_weight?.toFixed(2)," g"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-500",children:"Purity"}),e.jsx("p",{className:"text-slate-900",children:t.purity})]})]}),t.standard_pricing&&e.jsxs("div",{className:"rounded-xl bg-slate-50 p-4 text-xs text-slate-600",children:[e.jsx("p",{className:"font-semibold text-slate-700",children:"Standard pricing snapshot"}),e.jsx("ul",{className:"mt-2 space-y-1",children:Object.entries(t.standard_pricing).map(([s,a])=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-500",children:s.replace("_"," ")}),e.jsx("span",{className:"text-slate-800",children:typeof a=="number"?a.toLocaleString("en-IN"):a})]},s))})]}),t.variants.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Select variant"}),e.jsx("div",{className:"grid gap-2",children:t.variants.map(s=>{const a=n.product_variant_id===s.id,c=s.price_adjustment,x=c===0?"Standard":`${c>0?"+":""}₹ ${Math.abs(c).toLocaleString("en-IN")}`;return e.jsxs("label",{className:`flex cursor-pointer items-center justify-between rounded-2xl border px-4 py-3 text-sm transition ${a?"border-feather-gold bg-feather-gold/10 text-slate-900":"border-slate-200 bg-white text-slate-600 hover:border-feather-gold/50"}`,children:[e.jsx("span",{children:s.label}),e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500",children:x}),e.jsx("input",{type:"radio",name:"product_variant_id",value:s.id,checked:a,onChange:()=>l("product_variant_id",s.id),className:"h-4 w-4 text-elvee-blue focus:ring-feather-gold"})]})]},s.id)})})]}),w!==null&&e.jsxs("div",{className:"rounded-xl bg-slate-900 px-4 py-3 text-sm text-white",children:[e.jsx("p",{className:"text-xs text-white/70",children:"Estimated total"}),e.jsxs("p",{className:"mt-1 text-lg font-semibold",children:["₹ ",w.toLocaleString("en-IN")]}),e.jsx("p",{className:"text-xs text-white/70",children:"Final value subject to labour & offer adjustments."})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Reference design summary *"}),e.jsx("textarea",{className:"min-h-[120px] rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.reference_design,onChange:s=>l("reference_design",s.target.value),placeholder:"Describe materials, gemstone placements, finishing details, packaging expectations…"}),r.reference_design&&e.jsx("span",{className:"text-xs text-rose-500",children:r.reference_design})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Reference media URLs (one per line)"}),e.jsx("textarea",{className:"min-h-[120px] rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:p,onChange:s=>b(s.target.value),placeholder:"https://…"}),r.reference_media&&e.jsx("span",{className:"text-xs text-rose-500",children:r.reference_media})]})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Supply Type"}),e.jsxs("select",{className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.type,onChange:s=>l("type",s.target.value),children:[e.jsx("option",{value:"customer_supplied",children:"Customer supplying metal/stone"}),e.jsx("option",{value:"vendor_supplied",children:"Elvee supplying metal/stone"})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Metal *"}),e.jsxs("select",{className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.metal_id,onChange:s=>{const a=s.target.value===""?"":Number(s.target.value);N(a),l("metal_id",a),l("metal_purity_id",""),l("metal_tone_id","");const c=m.find(x=>x.id===a);l("metal",c?.name??"")},children:[e.jsx("option",{value:"",children:"Select metal"}),m.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),r.metal_id&&e.jsx("span",{className:"text-xs text-rose-500",children:r.metal_id}),r.metal&&e.jsx("span",{className:"text-xs text-rose-500",children:r.metal})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Purity"}),e.jsxs("select",{className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20 disabled:bg-slate-50 disabled:text-slate-400",value:n.metal_purity_id,onChange:s=>{const a=s.target.value===""?"":Number(s.target.value);l("metal_purity_id",a);const c=y.find(x=>x.id===a);l("purity",c?.name??"")},disabled:i===""||typeof i!="number",children:[e.jsx("option",{value:"",children:"Select purity"}),y.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),r.metal_purity_id&&e.jsx("span",{className:"text-xs text-rose-500",children:r.metal_purity_id}),r.purity&&e.jsx("span",{className:"text-xs text-rose-500",children:r.purity})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Tone"}),e.jsxs("select",{className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20 disabled:bg-slate-50 disabled:text-slate-400",value:n.metal_tone_id,onChange:s=>{const a=s.target.value===""?"":Number(s.target.value);l("metal_tone_id",a)},disabled:i===""||typeof i!="number",children:[e.jsx("option",{value:"",children:"Select tone"}),q.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),r.metal_tone_id&&e.jsx("span",{className:"text-xs text-rose-500",children:r.metal_tone_id})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Diamond / Stone quality"}),e.jsx("input",{type:"text",className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.diamond_quality,onChange:s=>l("diamond_quality",s.target.value)})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Quantity"}),e.jsx("input",{type:"number",min:1,className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.quantity,onChange:s=>l("quantity",Number(s.target.value)||1)}),r.quantity&&e.jsx("span",{className:"text-xs text-rose-500",children:r.quantity})]})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Special instructions"}),e.jsx("textarea",{className:"min-h-[100px] rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.special_instructions,onChange:s=>l("special_instructions",s.target.value)})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Delivery deadline"}),e.jsx("input",{type:"date",className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.delivery_deadline,onChange:s=>l("delivery_deadline",s.target.value)}),r.delivery_deadline&&e.jsx("span",{className:"text-xs text-rose-500",children:r.delivery_deadline})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Wastage %"}),e.jsx("input",{type:"number",step:"0.01",className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.wastage_percentage,onChange:s=>l("wastage_percentage",s.target.value)})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Manufacturing charge (₹)"}),e.jsx("input",{type:"number",step:"0.01",className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.manufacturing_charge,onChange:s=>l("manufacturing_charge",s.target.value)})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Active offer playbook"}),e.jsx("ul",{className:"mt-3 space-y-3 text-sm text-slate-600",children:g.length?g.map(s=>e.jsxs("li",{className:"rounded-xl bg-slate-50 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold text-slate-800",children:s.name}),e.jsx("span",{className:"text-xs text-slate-500",children:s.code})]}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:s.description})]},s.code)):e.jsx("li",{className:"text-xs text-slate-500",children:"No active offers configured."})})]}),t&&t.media.length>0&&e.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:t.media.map(s=>e.jsx("img",{src:s.url,alt:s.alt,className:"h-36 w-full rounded-2xl object-cover shadow"},s.url))}),e.jsx("button",{type:"submit",disabled:v,className:"w-full rounded-full bg-elvee-blue px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-elvee-blue/30 transition hover:bg-navy disabled:cursor-not-allowed disabled:opacity-60",children:v?"Submitting…":"Submit jobwork request"})]})]})})]}),e.jsxs("section",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Recent jobwork briefs"}),e.jsxs("span",{className:"text-xs text-slate-500",children:["Showing latest ",u.length]})]}),e.jsx("div",{className:"mt-4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs font-semibold text-slate-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:"Reference"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Design"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Mode"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Qty"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Delivery"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Created"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[u.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-800",children:s.reference}),e.jsxs("td",{className:"px-4 py-3 text-slate-600",children:[s.product??"Custom",s.variant?e.jsx("span",{className:"block text-xs text-slate-400",children:s.variant}):null]}),e.jsx("td",{className:"px-4 py-3 capitalize text-slate-500",children:s.submission_mode}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:s.quantity}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"inline-flex rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-600",children:s.status})}),e.jsx("td",{className:"px-4 py-3 text-slate-500",children:s.delivery_deadline??"—"}),e.jsx("td",{className:"px-4 py-3 text-slate-500",children:s.created_at})]},s.id)),u.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-6 text-center text-sm text-slate-500",children:"No jobwork requests yet. Submit your first brief above."})})]})]})})]})]})]})}export{T as default};
