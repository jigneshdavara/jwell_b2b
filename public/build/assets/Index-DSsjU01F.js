import{u as I,r as d,a as q,j as e,H as L,L as D}from"./app-CQCZKZrJ.js";import{A as E}from"./AuthenticatedLayout-xN3_xEYn.js";import"./ApplicationLogo-GwL1BMv6.js";import"./FlashMessage-DMpsaJUH.js";const w=[{value:"catalogue",label:"Catalogue design",helper:"Customise an existing Elvee design with metal / variant tweaks."},{value:"custom",label:"Upload bespoke concept",helper:"Share brand-new concepts with references, AI renders, or CAD briefs."}];function F(){const{prefillProduct:s,defaultVariantId:h,jobworks:x,offers:g,metals:u,metalPurities:f,metalTones:b}=I().props,[c,S]=d.useState(s?"catalogue":"custom"),[m,j]=d.useState(""),[i,N]=d.useState(""),{data:n,setData:l,post:k,processing:_,errors:r}=q({submission_mode:s?"catalogue":"custom",product_id:s?.id??null,product_variant_id:h??null,type:"customer_supplied",reference_design:"",reference_url:"",reference_media:[],metal_id:"",metal_purity_id:"",metal_tone_id:"",metal:s?.material??"",purity:s?.purity??"",diamond_quality:"",quantity:1,special_instructions:"",delivery_deadline:"",wastage_percentage:"",manufacturing_charge:""}),v=d.useMemo(()=>i===""||typeof i!="number"?[]:f.filter(t=>t.metal_id===i),[i,f]),C=d.useMemo(()=>i===""||typeof i!="number"?[]:b.filter(t=>t.metal_id===i),[i,b]);d.useEffect(()=>{if(l("submission_mode",c),c==="catalogue"&&s&&(l("product_id",s.id),l("metal",s.material??""),l("purity",s.purity??""),l("product_variant_id",h??null),s.material)){const t=u.find(a=>a.name.toLowerCase()===s.material?.toLowerCase());t&&(N(t.id),l("metal_id",t.id))}c==="custom"&&(l("product_id",null),l("product_variant_id",null))},[c]),d.useEffect(()=>{const t=m.split(`
`).map(a=>a.trim()).filter(a=>a.length>0);l("reference_media",t)},[m]),d.useEffect(()=>{s&&s.media.length&&j(s.media.map(t=>t.url).join(`
`))},[s]),d.useMemo(()=>!s||!n.product_variant_id?null:s.variants.find(t=>t.id===n.product_variant_id)??null,[s,n.product_variant_id]);const y=d.useMemo(()=>{if(!s)return null;const t=s.base_price??0,a=s.calculated_making_charge??s.making_charge_amount??0;return t+a},[s]),M=t=>{t.preventDefault(),k(route("frontend.jobwork.store"),{preserveScroll:!0})};return e.jsxs(E,{children:[e.jsx(L,{title:"Jobwork & Custom Manufacturing"}),e.jsxs("div",{className:"space-y-10",children:[e.jsx("section",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:e.jsxs("div",{className:"flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold text-slate-900",children:"Create a production brief"}),e.jsx("p",{className:"mt-2 text-sm text-slate-500",children:"Share modification requirements for catalogue pieces or submit brand-new concepts. Our production concierge will revert with quotes and timelines."})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-500",children:[e.jsxs("span",{className:"inline-flex items-center rounded-full border border-slate-200 px-3 py-1 font-medium text-slate-700",children:["Current requests: ",x.length]}),e.jsxs(D,{href:route("frontend.catalog.index"),className:"inline-flex items-center gap-2 rounded-full bg-elvee-blue px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-elvee-blue/30 transition hover:bg-navy",children:["Browse catalogue",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})}),e.jsxs("section",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:w.map(t=>{const a=!s&&t.value==="catalogue";return e.jsx("button",{type:"button",onClick:()=>!a&&S(t.value),disabled:a,className:`rounded-full px-4 py-2 text-sm font-semibold transition ${c===t.value?"bg-slate-900 text-white shadow-slate-900/30":"bg-slate-100 text-slate-600 hover:bg-slate-200"} ${a?"cursor-not-allowed opacity-60":""}`,children:t.label},t.value)})}),e.jsxs("p",{className:"mt-3 text-xs text-slate-500",children:[w.find(t=>t.value===c)?.helper,!s&&c==="catalogue"&&e.jsx("span",{className:"ml-2 font-semibold text-amber-600",children:"Select a catalogue design first from Browse Catalogue."})]}),e.jsx("form",{onSubmit:M,className:"mt-6 space-y-6",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[c==="catalogue"&&s?e.jsxs("div",{className:"space-y-4 rounded-2xl border border-slate-200 p-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Design selected"}),e.jsx("h2",{className:"mt-1 text-lg font-semibold text-slate-900",children:s.name}),e.jsxs("p",{className:"text-xs text-slate-500",children:["SKU ",s.sku]})]}),e.jsxs("div",{className:"grid gap-3 text-sm text-slate-600 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-500",children:"Base value"}),e.jsxs("p",{className:"text-slate-900",children:["₹ ",(s.base_price??0).toLocaleString("en-IN")]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-500",children:"Making charge"}),(()=>{if(s.calculated_making_charge!==null&&s.calculated_making_charge!==void 0)return e.jsxs("p",{className:"text-slate-900",children:["₹ ",s.calculated_making_charge.toLocaleString("en-IN")]});const t=s.making_charge_types||[],a=t.includes("fixed")&&s.making_charge_amount&&s.making_charge_amount>0,o=t.includes("percentage")&&s.making_charge_percentage&&s.making_charge_percentage>0;return a&&o?e.jsxs("p",{className:"text-slate-900",children:["₹ ",s.making_charge_amount?.toLocaleString("en-IN")," + ",s.making_charge_percentage,"% of metal cost"]}):a?e.jsxs("p",{className:"text-slate-900",children:["₹ ",(s.making_charge_amount??0).toLocaleString("en-IN")," (Fixed)"]}):o?e.jsxs("p",{className:"text-slate-900",children:[s.making_charge_percentage,"% of metal cost"]}):e.jsxs("p",{className:"text-slate-900",children:["₹ ",(s.making_charge_amount??0).toLocaleString("en-IN")]})})()]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-500",children:"Purity"}),e.jsx("p",{className:"text-slate-900",children:s.purity})]})]}),s.variants.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Select variant"}),e.jsx("div",{className:"grid gap-2",children:s.variants.map(t=>{const a=n.product_variant_id===t.id;return e.jsxs("label",{className:`flex cursor-pointer items-center justify-between rounded-2xl border px-4 py-3 text-sm transition ${a?"border-feather-gold bg-feather-gold/10 text-slate-900":"border-slate-200 bg-white text-slate-600 hover:border-feather-gold/50"}`,children:[e.jsx("span",{children:t.label}),e.jsx("span",{className:"flex items-center gap-2",children:e.jsx("input",{type:"radio",name:"product_variant_id",value:t.id,checked:a,onChange:()=>l("product_variant_id",t.id),className:"h-4 w-4 text-elvee-blue focus:ring-feather-gold"})})]},t.id)})})]}),y!==null&&e.jsxs("div",{className:"rounded-xl bg-slate-900 px-4 py-3 text-sm text-white",children:[e.jsx("p",{className:"text-xs text-white/70",children:"Estimated total"}),e.jsxs("p",{className:"mt-1 text-lg font-semibold",children:["₹ ",y.toLocaleString("en-IN")]}),e.jsx("p",{className:"text-xs text-white/70",children:"Final value subject to labour & offer adjustments."})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Reference design summary *"}),e.jsx("textarea",{className:"min-h-[120px] rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.reference_design,onChange:t=>l("reference_design",t.target.value),placeholder:"Describe materials, gemstone placements, finishing details, packaging expectations…"}),r.reference_design&&e.jsx("span",{className:"text-xs text-rose-500",children:r.reference_design})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Reference media URLs (one per line)"}),e.jsx("textarea",{className:"min-h-[120px] rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:m,onChange:t=>j(t.target.value),placeholder:"https://…"}),r.reference_media&&e.jsx("span",{className:"text-xs text-rose-500",children:r.reference_media})]})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Supply Type"}),e.jsxs("select",{className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.type,onChange:t=>l("type",t.target.value),children:[e.jsx("option",{value:"customer_supplied",children:"Customer supplying metal/stone"}),e.jsx("option",{value:"vendor_supplied",children:"Elvee supplying metal/stone"})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Metal *"}),e.jsxs("select",{className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.metal_id,onChange:t=>{const a=t.target.value===""?"":Number(t.target.value);N(a),l("metal_id",a),l("metal_purity_id",""),l("metal_tone_id","");const o=u.find(p=>p.id===a);l("metal",o?.name??"")},children:[e.jsx("option",{value:"",children:"Select metal"}),u.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),r.metal_id&&e.jsx("span",{className:"text-xs text-rose-500",children:r.metal_id}),r.metal&&e.jsx("span",{className:"text-xs text-rose-500",children:r.metal})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Purity"}),e.jsxs("select",{className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20 disabled:bg-slate-50 disabled:text-slate-400",value:n.metal_purity_id,onChange:t=>{const a=t.target.value===""?"":Number(t.target.value);l("metal_purity_id",a);const o=v.find(p=>p.id===a);l("purity",o?.name??"")},disabled:i===""||typeof i!="number",children:[e.jsx("option",{value:"",children:"Select purity"}),v.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),r.metal_purity_id&&e.jsx("span",{className:"text-xs text-rose-500",children:r.metal_purity_id}),r.purity&&e.jsx("span",{className:"text-xs text-rose-500",children:r.purity})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Tone"}),e.jsxs("select",{className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20 disabled:bg-slate-50 disabled:text-slate-400",value:n.metal_tone_id,onChange:t=>{const a=t.target.value===""?"":Number(t.target.value);l("metal_tone_id",a)},disabled:i===""||typeof i!="number",children:[e.jsx("option",{value:"",children:"Select tone"}),C.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),r.metal_tone_id&&e.jsx("span",{className:"text-xs text-rose-500",children:r.metal_tone_id})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Diamond / Stone quality"}),e.jsx("input",{type:"text",className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.diamond_quality,onChange:t=>l("diamond_quality",t.target.value)})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Quantity"}),e.jsx("input",{type:"number",min:1,className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.quantity,onChange:t=>l("quantity",Number(t.target.value)||1)}),r.quantity&&e.jsx("span",{className:"text-xs text-rose-500",children:r.quantity})]})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Special instructions"}),e.jsx("textarea",{className:"min-h-[100px] rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.special_instructions,onChange:t=>l("special_instructions",t.target.value)})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Delivery deadline"}),e.jsx("input",{type:"date",className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.delivery_deadline,onChange:t=>l("delivery_deadline",t.target.value)}),r.delivery_deadline&&e.jsx("span",{className:"text-xs text-rose-500",children:r.delivery_deadline})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Wastage %"}),e.jsx("input",{type:"number",step:"0.01",className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.wastage_percentage,onChange:t=>l("wastage_percentage",t.target.value)})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Manufacturing charge (₹)"}),e.jsx("input",{type:"number",step:"0.01",className:"rounded-2xl border border-slate-200 px-4 py-2.5 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.manufacturing_charge,onChange:t=>l("manufacturing_charge",t.target.value)})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Active offer playbook"}),e.jsx("ul",{className:"mt-3 space-y-3 text-sm text-slate-600",children:g.length?g.map(t=>e.jsxs("li",{className:"rounded-xl bg-slate-50 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold text-slate-800",children:t.name}),e.jsx("span",{className:"text-xs text-slate-500",children:t.code})]}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:t.description})]},t.code)):e.jsx("li",{className:"text-xs text-slate-500",children:"No active offers configured."})})]}),s&&s.media.length>0&&e.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:s.media.map(t=>e.jsx("img",{src:t.url,alt:t.alt,className:"h-36 w-full rounded-2xl object-cover shadow"},t.url))}),e.jsx("button",{type:"submit",disabled:_,className:"w-full rounded-full bg-elvee-blue px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-elvee-blue/30 transition hover:bg-navy disabled:cursor-not-allowed disabled:opacity-60",children:_?"Submitting…":"Submit jobwork request"})]})]})})]}),e.jsxs("section",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Recent jobwork briefs"}),e.jsxs("span",{className:"text-xs text-slate-500",children:["Showing latest ",x.length]})]}),e.jsx("div",{className:"mt-4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs font-semibold text-slate-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:"Reference"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Design"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Mode"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Qty"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Delivery"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Created"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[x.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-800",children:t.reference}),e.jsxs("td",{className:"px-4 py-3 text-slate-600",children:[t.product??"Custom",t.variant?e.jsx("span",{className:"block text-xs text-slate-400",children:t.variant}):null]}),e.jsx("td",{className:"px-4 py-3 capitalize text-slate-500",children:t.submission_mode}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:t.quantity}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"inline-flex rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-600",children:t.status})}),e.jsx("td",{className:"px-4 py-3 text-slate-500",children:t.delivery_deadline??"—"}),e.jsx("td",{className:"px-4 py-3 text-slate-500",children:t.created_at})]},t.id)),x.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-6 text-center text-sm text-slate-500",children:"No jobwork requests yet. Submit your first brief above."})})]})]})})]})]})]})}export{F as default};
