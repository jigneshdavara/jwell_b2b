import{u as N,r as m,a as g,j as e,H as f,L as x}from"./app-J2-QCru0.js";import{A as v}from"./AdminLayout-DrjVLu0b.js";import{M as y}from"./Modal-C5IXMPM5.js";import"./transition-j3Opiktt.js";const r=new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2}),w={pending:"bg-amber-100 text-amber-700",pending_payment:"bg-amber-100 text-amber-700",payment_failed:"bg-rose-100 text-rose-700",awaiting_materials:"bg-indigo-100 text-indigo-700",under_production:"bg-indigo-100 text-indigo-700",approved:"bg-emerald-100 text-emerald-700",in_production:"bg-indigo-100 text-indigo-700",quality_check:"bg-blue-100 text-blue-700",ready_to_dispatch:"bg-purple-100 text-purple-700",dispatched:"bg-elvee-blue/10 text-elvee-blue",delivered:"bg-emerald-100 text-emerald-700",cancelled:"bg-rose-100 text-rose-700",paid:"bg-emerald-100 text-emerald-700"},d=t=>t?new Date(t).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";function P(){const{order:t,statusOptions:h}=N().props,[a,i]=m.useState(null),{data:n,setData:c,post:p,processing:j}=g({status:t.status,meta:{comment:""}}),b=s=>{s.preventDefault(),p(route("admin.orders.update-status",t.id),{preserveScroll:!0})},u=m.useMemo(()=>{if(t.payments.length===0)return"No payments recorded";const s=t.payments[0];return`${s.status??"Pending"} · ${r.format(s.amount)}`},[t.payments]);return e.jsxs(v,{children:[e.jsx(f,{title:`Order ${t.reference}`}),e.jsxs("div",{className:"space-y-10",children:[e.jsx("header",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-semibold text-slate-900",children:["Order ",t.reference]}),e.jsxs("p",{className:"mt-2 text-sm text-slate-500",children:[t.user?.name??"Guest"," · ",t.user?.email??"—"]})]}),e.jsx(x,{href:route("admin.orders.index"),className:"inline-flex items-center gap-2 rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-600 transition hover:border-slate-400 hover:text-slate-900",children:"Back to list"})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:e.jsxs("div",{className:"grid gap-8 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-slate-400",children:"From"}),e.jsx("p",{className:"mt-3 text-lg font-semibold text-slate-900",children:"Elvee"}),e.jsx("p",{className:"mt-1 text-sm text-slate-600",children:"123 Business Street"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Mumbai, Maharashtra 400001"}),e.jsx("p",{className:"mt-2 text-sm text-slate-600",children:"Phone: +91 98765 43210"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Email: info@elvee.com"}),e.jsx("p",{className:"mt-2 text-sm text-slate-600",children:"GSTIN: 27AAAAA0000A1Z5"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-slate-400",children:"Bill To"}),e.jsx("p",{className:"mt-3 text-lg font-semibold text-slate-900",children:t.user?.name??"Unknown"}),e.jsx("p",{className:"mt-1 text-sm text-slate-600",children:t.user?.email??"—"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("h3",{className:"text-xs font-semibold text-slate-400",children:"Order Details"}),e.jsx("p",{className:"mt-3 text-lg font-semibold text-slate-900",children:t.reference}),e.jsxs("p",{className:"mt-1 text-sm text-slate-500",children:["Date: ",e.jsx("span",{className:"font-semibold text-slate-900",children:d(t.created_at)})]}),e.jsx("div",{className:"mt-3 flex justify-end gap-2",children:e.jsx("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold ${w[t.status]??"bg-slate-200 text-slate-700"}`,children:t.status_label})}),e.jsxs("p",{className:"mt-2 text-xs text-slate-400",children:["Payment: ",u]})]})]})}),e.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:[e.jsx("h2",{className:"mb-4 text-lg font-semibold text-slate-900",children:"Items"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b-2 border-slate-200 bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Item"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Unit Price"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600",children:"Qty"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:t.items.map(s=>e.jsxs("tr",{className:"hover:bg-slate-50/50 transition",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[s.product?.media?.[0]&&e.jsx("img",{src:s.product.media[0].url,alt:s.product.media[0].alt,className:"h-12 w-12 rounded-lg object-cover shadow-sm"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:s.name}),e.jsxs("p",{className:"text-xs text-slate-400",children:["SKU ",s.sku]})]})]})}),e.jsx("td",{className:"px-4 py-4 text-right",children:e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:r.format(s.unit_price)})}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"font-semibold text-slate-900",children:s.quantity})}),e.jsx("td",{className:"px-4 py-4 text-right",children:e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:r.format(s.total_price)})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("button",{type:"button",onClick:()=>i(s),className:"inline-flex items-center gap-1 rounded-full border border-elvee-blue/30 px-2.5 py-1.5 text-[10px] font-semibold text-elvee-blue transition hover:border-elvee-blue hover:bg-elvee-blue/5",title:"View product details",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-3 w-3",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"})})})})})]},s.id))}),e.jsxs("tfoot",{className:"border-t-2 border-slate-200 bg-slate-50",children:[e.jsxs("tr",{children:[e.jsx("td",{colSpan:2,className:"px-4 py-2 text-right text-sm text-slate-600",children:"Subtotal"}),e.jsx("td",{className:"px-4 py-2"}),e.jsx("td",{className:"px-4 py-2 text-right text-sm font-semibold text-slate-900",children:r.format(t.subtotal_amount)})]}),t.discount_amount>0&&e.jsxs("tr",{children:[e.jsx("td",{colSpan:2,className:"px-4 py-2 text-right text-sm text-slate-600",children:"Discount"}),e.jsx("td",{className:"px-4 py-2"}),e.jsxs("td",{className:"px-4 py-2 text-right text-sm font-semibold text-slate-900",children:["-",r.format(t.discount_amount)]})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:2,className:"px-4 py-2 text-right text-sm text-slate-600",children:"Tax (GST)"}),e.jsx("td",{className:"px-4 py-2"}),e.jsx("td",{className:"px-4 py-2 text-right text-sm font-semibold text-slate-900",children:r.format(t.tax_amount)})]}),e.jsxs("tr",{className:"border-t-2 border-slate-300",children:[e.jsx("td",{colSpan:2,className:"px-4 py-3 text-right text-base font-bold text-slate-900",children:"Grand Total"}),e.jsx("td",{className:"px-4 py-3"}),e.jsx("td",{className:"px-4 py-3 text-right text-lg font-bold text-slate-900",children:r.format(t.total_amount)}),e.jsx("td",{className:"px-4 py-3"})]})]})]})})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("form",{onSubmit:b,className:"space-y-4 rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Update Status"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{className:"font-semibold text-slate-800",children:"Workflow stage"}),e.jsx("select",{className:"rounded-2xl border border-slate-300 px-4 py-2 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.status,onChange:s=>c("status",s.target.value),children:h.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{className:"font-semibold text-slate-800",children:"Operator note"}),e.jsx("textarea",{className:"min-h-[100px] rounded-2xl border border-slate-300 px-4 py-2 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:n.meta.comment??"",onChange:s=>c("meta",{...n.meta,comment:s.target.value}),placeholder:"Optional note shared with production & support"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(x,{href:route("admin.orders.index"),className:"rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-600 transition hover:border-slate-400 hover:text-slate-900",children:"Back"}),e.jsx("button",{type:"submit",disabled:j,className:"rounded-full bg-elvee-blue px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-elvee-blue/30 transition hover:bg-navy disabled:cursor-not-allowed disabled:opacity-60",children:"Save status"})]})]}),e.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Status History"}),e.jsxs("div",{className:"mt-4 space-y-3 text-sm text-slate-600",children:[t.status_history.length===0&&e.jsx("p",{className:"text-xs text-slate-400",children:"No status updates recorded yet."}),t.status_history.map(s=>{const l=s.meta?.comment,o=typeof l=="string"?l:null;return e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-200 px-4 py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-slate-800",children:s.status.replace(/_/g," ")}),o&&e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:o})]}),e.jsx("span",{className:"text-xs text-slate-400",children:d(s.created_at)})]},s.id)})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Order Timeline"}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-slate-400",children:"Created"}),e.jsx("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:d(t.created_at)})]})})}),t.updated_at&&t.updated_at!==t.created_at&&e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-slate-400",children:"Last Updated"}),e.jsx("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:d(t.updated_at)})]})})})]})]}),e.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Payments"}),e.jsxs("div",{className:"mt-4 space-y-2 text-sm text-slate-600",children:[t.payments.length===0&&e.jsx("p",{className:"text-xs text-slate-400",children:"No payments captured."}),t.payments.map(s=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 px-4 py-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold text-slate-800",children:s.status}),e.jsx("span",{className:"text-xs text-slate-400",children:d(s.created_at)})]}),e.jsx("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:r.format(s.amount)})]},s.id)),t.status==="pending_payment"&&e.jsx("p",{className:"text-xs text-amber-600",children:"Waiting for customer to complete payment."}),t.status==="paid"&&e.jsx("p",{className:"text-xs text-emerald-600",children:"Payment confirmed."})]})]}),t.quotations&&t.quotations.length>0&&e.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Source Quotations"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"This order was created from the following quotations"}),e.jsx("div",{className:"mt-4 space-y-3",children:t.quotations.map(s=>e.jsxs(x,{href:route("admin.quotations.show",s.id),className:"flex items-center gap-3 rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 transition hover:border-elvee-blue/50 hover:bg-elvee-blue/5",children:[s.product?.media?.[0]&&e.jsx("img",{src:s.product.media[0].url,alt:s.product.media[0].alt,className:"h-10 w-10 rounded-lg object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-semibold text-slate-900",children:["Quotation #",s.id]}),e.jsx("p",{className:"text-xs text-slate-500",children:s.product?.name??"Product"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-xs text-slate-500",children:["Qty: ",s.quantity]}),e.jsx("p",{className:"text-xs text-slate-400",children:s.mode==="jobwork"?"Jobwork":"Jewellery"})]})]},s.id))})]}),t.price_breakdown&&Object.keys(t.price_breakdown).length>0&&e.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/70",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Price Breakdown"}),e.jsx("pre",{className:"mt-4 max-h-64 overflow-auto rounded-2xl bg-slate-900/95 p-4 text-xs text-slate-100",children:JSON.stringify(t.price_breakdown,null,2)})]})]})]})]})]}),a&&e.jsx(y,{show:!0,onClose:()=>i(null),maxWidth:"4xl",children:e.jsxs("div",{className:"flex min-h-0 flex-col",children:[e.jsx("div",{className:"flex-shrink-0 border-b border-slate-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Product Details"}),e.jsx("button",{type:"button",onClick:()=>i(null),className:"text-slate-400 hover:text-slate-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-5 w-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx("div",{className:"min-h-0 flex-1 overflow-y-auto px-6 py-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-6",children:[a.product?.media?.[0]&&e.jsx("img",{src:a.product.media[0].url,alt:a.product.media[0].alt,className:"h-32 w-32 rounded-lg object-cover shadow-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-xl font-semibold text-slate-900",children:a.name}),e.jsxs("p",{className:"mt-1 text-sm text-slate-500",children:["SKU: ",a.sku]}),e.jsx("div",{className:"mt-3 flex gap-2",children:e.jsxs("span",{className:"inline-flex items-center rounded-full bg-slate-200 px-3 py-1 text-xs font-semibold text-slate-700",children:["Qty: ",a.quantity]})})]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("h5",{className:"mb-3 text-sm font-semibold text-slate-700",children:"Pricing"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[a.product?.base_price&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Base Price:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:r.format(Number(a.product.base_price))})]}),a.product?.making_charge&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Making Charge:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:r.format(Number(a.product.making_charge))})]}),e.jsxs("div",{className:"border-t border-slate-300 pt-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:"Unit Price:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:r.format(a.unit_price)})]}),e.jsxs("div",{className:"flex justify-between mt-2",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:"Total Price:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:r.format(a.total_price)})]})]})]})]}),(a.product?.gold_weight||a.product?.silver_weight||a.product?.other_material_weight||a.product?.total_weight)&&e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("h5",{className:"mb-3 text-sm font-semibold text-slate-700",children:"Weights"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[a.product.gold_weight&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Gold Weight:"}),e.jsxs("span",{className:"font-semibold text-slate-900",children:[Number(a.product.gold_weight).toFixed(3)," g"]})]}),a.product.silver_weight&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Silver Weight:"}),e.jsxs("span",{className:"font-semibold text-slate-900",children:[Number(a.product.silver_weight).toFixed(3)," g"]})]}),a.product.other_material_weight&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Other Material Weight:"}),e.jsxs("span",{className:"font-semibold text-slate-900",children:[Number(a.product.other_material_weight).toFixed(3)," g"]})]}),a.product.total_weight&&e.jsx("div",{className:"border-t border-slate-300 pt-2",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:"Total Weight:"}),e.jsxs("span",{className:"font-semibold text-slate-900",children:[Number(a.product.total_weight).toFixed(3)," g"]})]})})]})]}),a.configuration&&Object.keys(a.configuration).length>0&&e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("h5",{className:"mb-3 text-sm font-semibold text-slate-700",children:"Configuration"}),e.jsx("div",{className:"space-y-2 text-sm",children:Object.entries(a.configuration).map(([s,l])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-slate-600",children:[s.replace(/_/g," "),":"]}),e.jsx("span",{className:"font-semibold text-slate-900",children:l==null||l===""?"—":typeof l=="boolean"?l?"Yes":"No":String(l)})]},s))})]}),a.metadata&&Object.keys(a.metadata).length>0&&e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("h5",{className:"mb-3 text-sm font-semibold text-slate-700",children:"Additional Information"}),e.jsx("div",{className:"space-y-2 text-sm",children:Object.entries(a.metadata).map(([s,l])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-slate-600",children:[s.replace(/_/g," "),":"]}),e.jsx("span",{className:"font-semibold text-slate-900",children:l==null||l===""?"—":typeof l=="boolean"?l?"Yes":"No":typeof l=="object"?JSON.stringify(l):String(l)})]},s))})]})]})})]})})]})}export{P as default};
