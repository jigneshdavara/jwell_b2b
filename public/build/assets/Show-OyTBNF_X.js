import{u as K,r as t,a as Y,j as e,H as U,b as R}from"./app-DlYpOb3X.js";import{A as X}from"./AuthenticatedLayout-CC4xX56_.js";import"./ApplicationLogo-D6j-nJf5.js";import"./FlashMessage-CnsLhOfR.js";const d=new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0});function oe(){const q=K(),{mode:v,product:a,configurationOptions:m}=q.props,C=q.props.wishlist?.product_ids??[],w=t.useMemo(()=>new Set(C),[C]),[u,J]=t.useState(m[0]?.variant_id??null),l=t.useMemo(()=>m.find(s=>s.variant_id===u)??null,[u,m]),[j]=t.useState("purchase"),[W,k]=t.useState(!1),[p,M]=t.useState(!1),[b,f]=t.useState(0);t.useRef(null);const[g,I]=t.useState(!1),[ee,E]=t.useState(1.5),n=a.media.length,o=n>0,L=o?a.media[Math.min(b,n-1)]:null,_=s=>s==null?"—":`${s.toFixed(2)} g`,Q=(s,i,c)=>Math.min(c,Math.max(i,s)),{data:r,setData:x,post:Z,processing:N,errors:y}=Y({product_id:a.id,product_variant_id:u??null,mode:j,quantity:1,notes:"",selections:{metal_id:null,metal_purity_id:null,metal_tone_id:null,diamond_option_keys:[],size_cm:null}});t.useEffect(()=>{x("mode",j)},[j,x]);const h=v==="jobwork",A=h&&!a.is_jobwork_allowed;t.useEffect(()=>{x("product_variant_id",u??null)},[u,x]);const[se,te]=t.useState(!1),[ae,z]=t.useState(w.has(a.id));t.useEffect(()=>{z(w.has(a.id))},[w,a.id]),t.useEffect(()=>{f(0)},[a.id]),t.useEffect(()=>{b>n-1&&f(Math.max(n-1,0))},[b,n]);const H=t.useMemo(()=>l?h?l.price_breakup.making+l.price_breakup.adjustment:l.price_total:0,[l,h]),T=s=>{if(s.preventDefault(),N||S||A)return;const i={product_id:a.id,product_variant_id:r.product_variant_id,quantity:r.quantity,configuration:{mode:j,notes:r.notes,selections:r.selections}};R.post(route("frontend.cart.items.store"),i,{preserveScroll:!0})},V=()=>{N||p||(M(!0),Z(route("frontend.quotations.store"),{preserveScroll:!0,onSuccess:()=>k(!1),onFinish:()=>M(!1)}))},$=()=>{const s={product_id:a.id,product_variant_id:r.product_variant_id,quantity:r.quantity,configuration:{mode:v,notes:r.notes,selections:r.selections}};R.post(route("frontend.cart.items.store"),s,{preserveScroll:!0,onSuccess:()=>{k(!1)}})},B=t.useCallback(()=>{o&&I(!0)},[o]),F=t.useCallback(()=>{I(!1)},[]);t.useCallback(s=>{E(i=>Q(i+s,1,3))},[]);const O=t.useCallback(()=>E(1.5),[]),P=t.useCallback(()=>{!o||n<=1||f(s=>(s-1+n)%n)},[o,n]),D=t.useCallback(()=>{!o||n<=1||f(s=>(s+1)%n)},[o,n]);t.useEffect(()=>{if(!g||typeof document>"u")return;const s=document.body.style.overflow;document.body.style.overflow="hidden";const i=c=>{c.key==="Escape"?F():c.key==="ArrowRight"?D():c.key==="ArrowLeft"&&P()};return window.addEventListener("keydown",i),()=>{document.body.style.overflow=s,window.removeEventListener("keydown",i)}},[g,F,D,P]),t.useEffect(()=>{g&&O()},[b,g,O]);const S=m.length>0&&!l;return e.jsxs(X,{children:[e.jsx(U,{title:a.name}),e.jsx("div",{className:"space-y-8",children:e.jsxs("div",{className:"grid gap-10 lg:grid-cols-[1.6fr_1fr]",children:[e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:a.name}),a.brand&&e.jsxs("p",{className:"mt-1 text-sm text-slate-500",children:["by ",a.brand]})]}),o&&e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"relative aspect-square w-full overflow-hidden rounded-2xl bg-slate-100",children:e.jsx("img",{src:L?.url,alt:L?.alt??a.name,className:"h-full w-full object-cover",onClick:B,onError:s=>{const i=s.target;i.src="/placeholder-image.png"}})}),n>1&&e.jsx("div",{className:"mt-4 flex gap-2 overflow-x-auto pb-2",children:a.media.map((s,i)=>e.jsx("button",{type:"button",onClick:()=>f(i),className:`relative h-20 w-20 flex-shrink-0 overflow-hidden rounded-xl border-2 transition ${i===b?"border-feather-gold":"border-transparent hover:border-slate-300"}`,children:e.jsx("img",{src:s.url,alt:s.alt??a.name,className:"h-full w-full object-cover",onError:c=>{const G=c.target;G.src="/placeholder-image.png"}})},i))})]}),a.description&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"mb-2 text-lg font-semibold text-slate-900",children:"Description"}),e.jsx("p",{className:"text-sm text-slate-600",children:a.description})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Product details"}),e.jsxs("dl",{className:"grid grid-cols-2 gap-4",children:[a.material&&e.jsxs("div",{className:"rounded-2xl bg-slate-50 px-4 py-3 text-sm",children:[e.jsx("dt",{className:"text-slate-500",children:"Material"}),e.jsx("dd",{className:"mt-1 font-semibold text-slate-900",children:a.material})]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 px-4 py-3 text-sm",children:[e.jsx("dt",{className:"text-slate-500",children:"Gold weight"}),e.jsx("dd",{className:"mt-1 font-semibold text-slate-900",children:_(a.gold_weight)})]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 px-4 py-3 text-sm",children:[e.jsx("dt",{className:"text-slate-500",children:"Silver weight"}),e.jsx("dd",{className:"mt-1 font-semibold text-slate-900",children:_(a.silver_weight)})]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 px-4 py-3 text-sm",children:[e.jsx("dt",{className:"text-slate-500",children:"Other materials"}),e.jsx("dd",{className:"mt-1 font-semibold text-slate-900",children:_(a.other_material_weight)})]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 px-4 py-3 text-sm",children:[e.jsx("dt",{className:"text-slate-500",children:"Jobwork ready"}),e.jsx("dd",{className:"mt-1 font-semibold text-slate-900",children:a.is_jobwork_allowed?"Yes":"On request"})]})]})]})]})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("form",{onSubmit:T,className:"w-full space-y-5 rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Request quotation"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Select your configuration and our merchandising desk will share pricing shortly."})]}),m.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Select configuration"}),e.jsx("select",{className:"w-full rounded-2xl border border-slate-200 bg-white px-4 py-2.5 text-sm text-slate-900 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",value:u??"",onChange:s=>J(Number(s.target.value)||null),children:m.map(s=>e.jsx("option",{value:s.variant_id,children:s.label},s.variant_id))})]}),l&&e.jsxs("div",{className:"mt-4 space-y-3 rounded-2xl bg-slate-50 p-4 text-xs text-slate-700",children:[l.metals.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"mb-1.5 font-semibold text-slate-900",children:"Metals in this variant"}),e.jsx("ul",{className:"space-y-0.5",children:l.metals.map((s,i)=>e.jsxs("li",{children:["• ",s.label]},i))})]}),l.diamonds.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"mb-1.5 font-semibold text-slate-900",children:"Diamonds in this variant"}),e.jsx("ul",{className:"space-y-0.5",children:l.diamonds.map((s,i)=>e.jsxs("li",{children:["• ",s.label]},i))})]})]}),S&&e.jsx("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-600",children:"No variant is available for the selected combination. Please adjust your selections."}),e.jsxs("label",{className:"block space-y-1",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-600",children:"Quantity"}),e.jsx("input",{type:"number",min:"1",value:r.quantity,onChange:s=>x("quantity",parseInt(s.target.value,10)||1),className:"w-full rounded-2xl border border-slate-200 bg-white px-4 py-2.5 text-sm text-slate-900 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20"}),y.quantity&&e.jsx("span",{className:"text-xs text-rose-500",children:y.quantity})]}),e.jsxs("label",{className:"block space-y-1",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-600",children:"Notes (optional)"}),e.jsx("textarea",{rows:4,value:r.notes,onChange:s=>x("notes",s.target.value),className:"w-full rounded-2xl border border-slate-200 bg-white px-4 py-2.5 text-sm text-slate-900 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",placeholder:"List required scope: hallmarking, hallmark packaging, diamond certification, delivery deadlines…"}),y.notes&&e.jsx("span",{className:"text-xs text-rose-500",children:y.notes})]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 px-4 py-3 text-sm text-slate-600",children:[e.jsx("p",{className:"font-semibold text-slate-700",children:"Estimated total"}),l?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mt-1 text-xl font-semibold text-slate-900",children:d.format(H)}),e.jsx("p",{className:"text-xs text-slate-500",children:h?"Includes making charge only. Final quotation may vary with labour costs.":"Includes base & making. Final quotation may vary with bullion/diamond parity and labour."}),!h&&e.jsxs("div",{className:"mt-2 space-y-1 text-xs",children:[e.jsxs("p",{className:"flex justify-between",children:[e.jsx("span",{children:"Base:"}),e.jsx("span",{className:"font-medium",children:d.format(l.price_breakup.base)})]}),l.price_breakup.metal>0&&e.jsxs("p",{className:"flex justify-between",children:[e.jsx("span",{children:"Metal:"}),e.jsx("span",{className:"font-medium",children:d.format(l.price_breakup.metal)})]}),l.price_breakup.diamond>0&&e.jsxs("p",{className:"flex justify-between",children:[e.jsx("span",{children:"Diamond:"}),e.jsx("span",{className:"font-medium",children:d.format(l.price_breakup.diamond)})]}),e.jsxs("p",{className:"flex justify-between",children:[e.jsx("span",{children:"Making:"}),e.jsx("span",{className:"font-medium",children:d.format(l.price_breakup.making)})]}),l.price_breakup.adjustment!==0&&e.jsxs("p",{className:"flex justify-between",children:[e.jsx("span",{children:"Adjustment:"}),e.jsx("span",{className:"font-medium",children:d.format(l.price_breakup.adjustment)})]})]}),h&&e.jsxs("div",{className:"mt-2 space-y-1 text-xs",children:[e.jsxs("p",{className:"flex justify-between",children:[e.jsx("span",{children:"Making charge:"}),e.jsx("span",{className:"font-medium",children:d.format(l.price_breakup.making)})]}),l.price_breakup.adjustment!==0&&e.jsxs("p",{className:"flex justify-between",children:[e.jsx("span",{children:"Adjustment:"}),e.jsx("span",{className:"font-medium",children:d.format(l.price_breakup.adjustment)})]})]})]}):e.jsx("p",{className:"mt-1 text-sm text-rose-600",children:"Please select a configuration to see pricing."})]}),e.jsx("button",{type:"submit",disabled:N||S||A,className:"w-full rounded-full bg-elvee-blue px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-elvee-blue/30 transition hover:bg-navy disabled:cursor-not-allowed disabled:opacity-60",children:N?"Submitting…":"Request quotation"})]})})]})}),W&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"w-full max-w-md space-y-4 rounded-3xl bg-white p-6 shadow-2xl",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Confirm quotation"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Submit this quotation request with the selected configuration? Our merchandising desk will review and respond shortly."}),e.jsxs("div",{className:"space-y-2 rounded-2xl bg-slate-50 p-4 text-xs text-slate-500",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-slate-700",children:"Mode:"})," ",v==="jobwork"?"Jobwork":"Jewellery"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-slate-700",children:"Quantity:"})," ",r.quantity]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",className:"rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-600 hover:border-slate-400 hover:text-slate-900",onClick:()=>k(!1),disabled:p,children:"Review again"}),e.jsx("button",{type:"button",className:"rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-600 hover:border-slate-400 hover:text-slate-900",onClick:$,disabled:p,children:"Add to quotation list"}),e.jsx("button",{type:"button",className:"rounded-full bg-elvee-blue px-4 py-2 text-sm font-semibold text-white shadow-elvee-blue/30 hover:bg-navy disabled:cursor-not-allowed disabled:opacity-60",onClick:V,disabled:p,children:p?"Submitting…":"Confirm submission"})]})]})})]})}export{oe as default};
