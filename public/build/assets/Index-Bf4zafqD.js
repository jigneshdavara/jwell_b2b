import{g as Oe,G as l,u as ke,r as T,j as i,H as Ne,b as Te}from"./app-QzdpPliV.js";import{A as Ae}from"./AuthenticatedLayout-DHRvdEI_.js";import"./FlashMessage-C6pnsQhr.js";var D={exports:{}},B,z;function Ie(){if(z)return B;z=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return B=n,B}var V,X;function _e(){if(X)return V;X=1;var n=Ie();function e(){}function t(){}return t.resetWarningCache=e,V=function(){function r(c,d,a,v,y,b){if(b!==n){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}r.isRequired=r;function s(){return r}var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:s,element:r,elementType:r,instanceOf:s,node:r,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:t,resetWarningCache:e};return o.PropTypes=o,o},V}var Q;function Le(){return Q||(Q=1,D.exports=_e()()),D.exports}var Ue=Le();const u=Oe(Ue);function Z(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function ee(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Z(Object(t),!0).forEach(function(r){oe(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Z(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function W(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?W=function(e){return typeof e}:W=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(n)}function oe(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function We(n,e){if(n==null)return{};var t={},r=Object.keys(n),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}function qe(n,e){if(n==null)return{};var t=We(n,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function ae(n,e){return Me(n)||Fe(n,e)||De(n,e)||Be()}function Me(n){if(Array.isArray(n))return n}function Fe(n,e){var t=n&&(typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"]);if(t!=null){var r=[],s=!0,o=!1,c,d;try{for(t=t.call(n);!(s=(c=t.next()).done)&&(r.push(c.value),!(e&&r.length===e));s=!0);}catch(a){o=!0,d=a}finally{try{!s&&t.return!=null&&t.return()}finally{if(o)throw d}}return r}}function De(n,e){if(n){if(typeof n=="string")return te(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return te(n,e)}}function te(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Be(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=function(e,t,r){var s=!!r,o=l.useRef(r);l.useEffect(function(){o.current=r},[r]),l.useEffect(function(){if(!s||!e)return function(){};var c=function(){o.current&&o.current.apply(o,arguments)};return e.on(t,c),function(){e.off(t,c)}},[s,t,e,o])},$=function(e){var t=l.useRef(e);return l.useEffect(function(){t.current=e},[e]),t.current},R=function(e){return e!==null&&W(e)==="object"},Ve=function(e){return R(e)&&typeof e.then=="function"},$e=function(e){return R(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},re="[object Object]",Je=function n(e,t){if(!R(e)||!R(t))return e===t;var r=Array.isArray(e),s=Array.isArray(t);if(r!==s)return!1;var o=Object.prototype.toString.call(e)===re,c=Object.prototype.toString.call(t)===re;if(o!==c)return!1;if(!o&&!r)return e===t;var d=Object.keys(e),a=Object.keys(t);if(d.length!==a.length)return!1;for(var v={},y=0;y<d.length;y+=1)v[d[y]]=!0;for(var b=0;b<a.length;b+=1)v[a[b]]=!0;var p=Object.keys(v);if(p.length!==d.length)return!1;var w=e,C=t,j=function(A){return n(w[A],C[A])};return p.every(j)},ie=function(e,t,r){return R(e)?Object.keys(e).reduce(function(s,o){var c=!R(t)||!Je(e[o],t[o]);return r.includes(o)?(c&&console.warn("Unsupported prop change: options.".concat(o," is not a mutable property.")),s):c?ee(ee({},s||{}),{},oe({},o,e[o])):s},null):null},ce="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",ne=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ce;if(e===null||$e(e))return e;throw new Error(t)},Ke=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ce;if(Ve(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(s){return ne(s,t)})};var r=ne(e,t);return r===null?{tag:"empty"}:{tag:"sync",stripe:r}},Ge=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"5.3.0"}),e.registerAppInfo({name:"react-stripe-js",version:"5.3.0",url:"https://stripe.com/docs/stripe-js/react"}))},q=l.createContext(null);q.displayName="ElementsContext";var ue=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},le=function(e){var t=e.stripe,r=e.options,s=e.children,o=l.useMemo(function(){return Ke(t)},[t]),c=l.useState(function(){return{stripe:o.tag==="sync"?o.stripe:null,elements:o.tag==="sync"?o.stripe.elements(r):null}}),d=ae(c,2),a=d[0],v=d[1];l.useEffect(function(){var p=!0,w=function(j){v(function(O){return O.stripe?O:{stripe:j,elements:j.elements(r)}})};return o.tag==="async"&&!a.stripe?o.stripePromise.then(function(C){C&&p&&w(C)}):o.tag==="sync"&&!a.stripe&&w(o.stripe),function(){p=!1}},[o,a,r]);var y=$(t);l.useEffect(function(){y!==null&&y!==t&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[y,t]);var b=$(r);return l.useEffect(function(){if(a.elements){var p=ie(r,b,["clientSecret","fonts"]);p&&a.elements.update(p)}},[r,b,a.elements]),l.useEffect(function(){Ge(a.stripe)},[a.stripe]),l.createElement(q.Provider,{value:a},s)};le.propTypes={stripe:u.any,options:u.object};var Ye=function(e){var t=l.useContext(q);return ue(t,e)},He=function(){var e=Ye("calls useElements()"),t=e.elements;return t};u.func.isRequired;var pe=l.createContext(null);pe.displayName="CheckoutContext";u.any,u.shape({clientSecret:u.oneOfType([u.string,u.instanceOf(Promise)]).isRequired,elementsOptions:u.object}).isRequired;var J=function(e){var t=l.useContext(pe),r=l.useContext(q);if(t){if(r)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."));return t}else return ue(r,e)},ze=["mode"],Xe=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},g=function(e,t){var r="".concat(Xe(e),"Element"),s=function(a){var v=a.id,y=a.className,b=a.options,p=b===void 0?{}:b,w=a.onBlur,C=a.onFocus,j=a.onReady,O=a.onChange,A=a.onEscape,ve=a.onClick,ye=a.onLoadError,ge=a.onLoaderStart,xe=a.onNetworksChange,be=a.onConfirm,Se=a.onCancel,Ee=a.onShippingAddressChange,je=a.onShippingRateChange,Ce=a.onSavedPaymentMethodRemove,Pe=a.onSavedPaymentMethodUpdate,I=J("mounts <".concat(r,">")),_="elements"in I?I.elements:null,P="checkoutState"in I?I.checkoutState:null,S=P?.type==="success"||P?.type==="loading"?P.sdk:null,we=l.useState(null),K=ae(we,2),f=K[0],Re=K[1],E=l.useRef(null),M=l.useRef(null);h(f,"blur",w),h(f,"focus",C),h(f,"escape",A),h(f,"click",ve),h(f,"loaderror",ye),h(f,"loaderstart",ge),h(f,"networkschange",xe),h(f,"confirm",be),h(f,"cancel",Se),h(f,"shippingaddresschange",Ee),h(f,"shippingratechange",je),h(f,"savedpaymentmethodremove",Ce),h(f,"savedpaymentmethodupdate",Pe),h(f,"change",O);var F;j&&(e==="expressCheckout"?F=j:F=function(){j(f)}),h(f,"ready",F),l.useLayoutEffect(function(){if(E.current===null&&M.current!==null&&(_||S)){var m=null;if(S)switch(e){case"payment":m=S.createPaymentElement(p);break;case"address":if("mode"in p){var Y=p.mode,H=qe(p,ze);if(Y==="shipping")m=S.createShippingAddressElement(H);else if(Y==="billing")m=S.createBillingAddressElement(H);else throw new Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw new Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":m=S.createExpressCheckoutElement(p);break;case"currencySelector":m=S.createCurrencySelectorElement();break;case"taxId":m=S.createTaxIdElement(p);break;default:throw new Error("Invalid Element type ".concat(r,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else _&&(m=_.create(e,p));E.current=m,Re(m),m&&m.mount(M.current)}},[_,S,p]);var G=$(p);return l.useEffect(function(){if(E.current){var m=ie(p,G,["paymentRequest"]);m&&"update"in E.current&&E.current.update(m)}},[p,G]),l.useLayoutEffect(function(){return function(){if(E.current&&typeof E.current.destroy=="function")try{E.current.destroy(),E.current=null}catch{}}},[]),l.createElement("div",{id:v,className:y,ref:M})},o=function(a){J("mounts <".concat(r,">"));var v=a.id,y=a.className;return l.createElement("div",{id:v,className:y})},c=t?o:s;return c.propTypes={id:u.string,className:u.string,onChange:u.func,onBlur:u.func,onFocus:u.func,onReady:u.func,onEscape:u.func,onClick:u.func,onLoadError:u.func,onLoaderStart:u.func,onNetworksChange:u.func,onConfirm:u.func,onCancel:u.func,onShippingAddressChange:u.func,onShippingRateChange:u.func,onSavedPaymentMethodRemove:u.func,onSavedPaymentMethodUpdate:u.func,options:u.object},c.displayName=r,c.__elementType=e,c},x=typeof window>"u",Qe=l.createContext(null);Qe.displayName="EmbeddedCheckoutProviderContext";var Ze=function(){var e=J("calls useStripe()"),t=e.stripe;return t};g("auBankAccount",x);g("card",x);g("cardNumber",x);g("cardExpiry",x);g("cardCvc",x);g("iban",x);var et=g("payment",x);g("expressCheckout",x);g("paymentRequestButton",x);g("linkAuthentication",x);g("address",x);g("shippingAddress",x);g("paymentMethodMessaging",x);g("taxId",x);var de="clover",tt=function(e){return e===3?"v3":e},fe="https://js.stripe.com",rt="".concat(fe,"/").concat(de,"/stripe.js"),nt=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,st=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var ot=function(e){return nt.test(e)||st.test(e)},at=function(){for(var e=document.querySelectorAll('script[src^="'.concat(fe,'"]')),t=0;t<e.length;t++){var r=e[t];if(ot(r.src))return r}return null},se=function(e){var t="",r=document.createElement("script");r.src="".concat(rt).concat(t);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(r),r},it=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"8.3.0",startTime:t})},k=null,L=null,U=null,ct=function(e){return function(t){e(new Error("Failed to load Stripe.js",{cause:t}))}},ut=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},lt=function(e){return k!==null?k:(k=new Promise(function(t,r){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe){t(window.Stripe);return}try{var s=at();if(!(s&&e)){if(!s)s=se(e);else if(s&&U!==null&&L!==null){var o;s.removeEventListener("load",U),s.removeEventListener("error",L),(o=s.parentNode)===null||o===void 0||o.removeChild(s),s=se(e)}}U=ut(t,r),L=ct(r),s.addEventListener("load",U),s.addEventListener("error",L)}catch(c){r(c);return}}),k.catch(function(t){return k=null,Promise.reject(t)}))},pt=function(e,t,r){if(e===null)return null;var s=t[0],o=s.match(/^pk_test/),c=tt(e.version),d=de;o&&c!==d&&console.warn("Stripe.js@".concat(c," was loaded on the page, but @stripe/stripe-js@").concat("8.3.0"," expected Stripe.js@").concat(d,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var a=e.apply(void 0,t);return it(a,r),a},N,me=!1,he=function(){return N||(N=lt(null).catch(function(e){return N=null,Promise.reject(e)}),N)};Promise.resolve().then(function(){return he()}).catch(function(n){me||console.warn(n)});var dt=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];me=!0;var s=Date.now();return he().then(function(o){return pt(o,t,s)})};const ft=n=>new Intl.NumberFormat("en-IN",{style:"currency",currency:n,maximumFractionDigits:0});function mt({providerReference:n}){const e=Ze(),t=He(),[r,s]=T.useState(!1),[o,c]=T.useState(null),d=async a=>{if(a.preventDefault(),c(null),!e||!t)return;s(!0);const v=await e.confirmPayment({elements:t,redirect:"if_required"});if(v.error){c(v.error.message??"Unable to confirm payment."),s(!1);return}const y=v.paymentIntent?.id??n;Te.post(route("frontend.checkout.confirm"),{payment_intent_id:y},{onError:b=>{s(!1),c(b.payment)}})};return i.jsxs("form",{onSubmit:d,className:"space-y-6",children:[i.jsx(et,{options:{layout:"tabs"}}),o&&i.jsx("p",{className:"text-sm text-rose-500",children:o}),i.jsx("button",{type:"submit",disabled:!e||r,className:"w-full rounded-full bg-sky-600 px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-sky-600/30 transition hover:bg-sky-500 disabled:cursor-not-allowed disabled:opacity-60",children:r?"Processing…":"Confirm payment"})]})}function gt(){const{order:n,payment:e,summary:t}=ke().props,r=T.useMemo(()=>ft(n.currency),[n.currency]),s=T.useMemo(()=>dt(e.publishableKey),[e.publishableKey]),o=T.useMemo(()=>({clientSecret:e.clientSecret,appearance:{theme:"stripe"}}),[e.clientSecret]);return i.jsxs(Ae,{children:[i.jsx(Ne,{title:"Checkout"}),i.jsxs("div",{className:"grid gap-8 lg:grid-cols-[2fr_1fr]",children:[i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:[i.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Secure payment"}),i.jsxs("p",{className:"mt-2 text-sm text-slate-500",children:["Order reference ",i.jsx("span",{className:"font-semibold text-slate-900",children:n.reference})]}),i.jsx("div",{className:"mt-6",children:i.jsx(le,{stripe:s,options:o,children:i.jsx(mt,{providerReference:e.providerReference})})})]}),i.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:[i.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Items"}),i.jsx("div",{className:"mt-4 space-y-3 text-sm text-slate-600",children:n.items.map(c=>i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-slate-900",children:c.name}),i.jsxs("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:[c.quantity," × ",c.sku]})]}),i.jsx("p",{className:"font-semibold text-slate-900",children:r.format(c.line_total)})]},c.sku))})]})]}),i.jsx("aside",{className:"space-y-6",children:i.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:[i.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Summary"}),i.jsxs("div",{className:"mt-4 space-y-3 text-sm text-slate-600",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{children:"Subtotal"}),i.jsx("span",{children:r.format(t.subtotal)})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{children:"Tax"}),i.jsx("span",{children:r.format(t.tax)})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{children:"Discount"}),i.jsxs("span",{children:["-",r.format(t.discount)]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{children:"Shipping"}),i.jsx("span",{children:r.format(t.shipping)})]}),i.jsx("div",{className:"border-t border-slate-200 pt-3 text-base font-semibold text-slate-900",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{children:"Total due"}),i.jsx("span",{children:r.format(t.total)})]})})]})]})})]})]})}export{gt as default};
