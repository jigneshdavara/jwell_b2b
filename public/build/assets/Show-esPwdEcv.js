import{j as e,r as i,u as ae,a as ne,H as le,b as U}from"./app-BCnxwFoh.js";import{A as ie}from"./AuthenticatedLayout-BNxGNSSN.js";import"./ApplicationLogo-DW29TYwh.js";import"./FlashMessage-CntUQ1_S.js";function re({children:l,isSelected:S,isDisabled:x=!1,onClick:k}){return e.jsx("button",{type:"button",onClick:k,disabled:x,className:`
                inline-flex items-center rounded-full px-4 py-2 text-sm font-medium transition-all shadow-sm
                ${S?"bg-[#0E244D] text-white shadow-md":x?"border border-slate-200 bg-slate-50 text-slate-400 cursor-not-allowed":"border border-[#0E244D]/30 bg-white text-[#0E244D] hover:bg-[#F8F5F0] hover:border-[#0E244D]/50"}
            `,children:l})}function oe({configurationOptions:l,selectedVariantId:S,onVariantChange:x}){const k=s=>{if(s.purityName&&s.toneName&&s.metalName)return`${s.purityName} ${s.toneName}`;let t=s.label.replace(/\s+\d+\.?\d*\s*g\s*$/i,"").replace(/\s+\d+\.?\d*\s*grams?\s*$/i,"").trim();const n=t.split(/\s+/).filter(a=>a.length>0);if(n.length===0)return t;const m=n[0];n[n.length-1];const o=n.slice(1,n.length-1).join(" ");return`${m} ${o}`.trim()},p=i.useMemo(()=>{const s=new Map;return l.forEach(t=>{if(t.metals.length===0)return;const m=t.metals.map(k).join(" + "),o=`metals_${t.metals.map(a=>`${a.metalId}_${a.metalPurityId??"null"}_${a.metalToneId??"null"}`).sort().join("|")}`;if(!s.has(o))s.set(o,{id:o,label:m,variantIds:[t.variant_id]});else{const a=s.get(o);a.variantIds.includes(t.variant_id)||a.variantIds.push(t.variant_id)}}),Array.from(s.values()).sort((t,n)=>t.label.localeCompare(n.label))},[l]),L=s=>{const t=s.label.split(" ").filter(c=>c.length>0&&!c.match(/^\d+\.\d+ct$/i)&&!c.match(/^\(\d+\)$/));let n="",m="";for(let c=0;c<t.length;c++){const o=t[c];if(/^(SI|VS|VVS|IF|FL|I[1-3]|VVS[12]|VS[12])/i.test(o)){if(n=o.toUpperCase(),c>0){const a=t[c-1];/^[A-Z]{1,2}$/i.test(a)&&a.length<=2&&(m=a.toUpperCase())}break}}return!n&&t.length>=4&&(n=t[3]?.toUpperCase()||"",m=t[2]?.toUpperCase()||""),n&&m?`${n} ${m}`:n||s.label.split(" ").slice(0,4).join(" ")},g=i.useMemo(()=>{const s=new Map;return l.forEach(t=>{if(t.diamonds.length===0)return;const m=t.diamonds.map(L).join(" + "),o=`diamonds_${t.diamonds.map(a=>`${a.diamondShapeId}_${a.diamondColorId}_${a.diamondClarityId}`).sort().join("|")}`;if(!s.has(o))s.set(o,{id:o,label:m,variantIds:[t.variant_id]});else{const a=s.get(o);a.variantIds.includes(t.variant_id)||a.variantIds.push(t.variant_id)}}),Array.from(s.values()).sort((t,n)=>t.label.localeCompare(n.label))},[l]),y=i.useMemo(()=>l.find(s=>s.variant_id===S)??null,[S,l]),d=i.useMemo(()=>!y||y.metals.length===0?null:`metals_${y.metals.map(t=>`${t.metalId}_${t.metalPurityId??"null"}_${t.metalToneId??"null"}`).sort().join("|")}`,[y]),v=i.useMemo(()=>!y||y.diamonds.length===0?null:`diamonds_${y.diamonds.map(t=>`${t.diamondShapeId}_${t.diamondColorId}_${t.diamondClarityId}`).sort().join("|")}`,[y]),r=i.useMemo(()=>s=>{if(!s)return new Set(g.map(m=>m.id));const t=new Set,n=p.find(m=>m.id===s);return n&&n.variantIds.forEach(m=>{const c=l.find(o=>o.variant_id===m);if(c&&c.diamonds.length>0){const a=`diamonds_${c.diamonds.map(h=>`${h.diamondShapeId}_${h.diamondColorId}_${h.diamondClarityId}`).sort().join("|")}`;t.add(a)}}),t},[l,g,p]),j=i.useMemo(()=>s=>{if(!s)return new Set(p.map(m=>m.id));const t=new Set,n=g.find(m=>m.id===s);return n&&n.variantIds.forEach(m=>{const c=l.find(o=>o.variant_id===m);if(c&&c.metals.length>0){const a=`metals_${c.metals.map(h=>`${h.metalId}_${h.metalPurityId??"null"}_${h.metalToneId??"null"}`).sort().join("|")}`;t.add(a)}}),t},[l,p,g]);i.useMemo(()=>r(d),[d,r]);const b=i.useMemo(()=>j(v),[v,j]),_=(s,t)=>{const n=p.find(o=>o.id===s),m=g.find(o=>o.id===t);return!n||!m?null:n.variantIds.find(o=>m.variantIds.includes(o))??null},D=s=>{if(d===s){x(null);return}if(v){const t=_(s,v);x(t)}else{const t=p.find(n=>n.id===s);x(t?.variantIds[0]??null)}},w=d&&v&&!y;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-[#0E244D] mb-2",children:"Customization"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Select your preferred metal and diamond quality to see pricing."})]}),p.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-semibold text-[#0E244D]",children:"Metal"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:p.map(s=>{const t=!v||b.has(s.id);return e.jsx(re,{isSelected:d===s.id,isDisabled:!t,onClick:()=>D(s.id),children:s.label},s.id)})})]}),w&&e.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-600",children:"This combination is not available."})]})}function de({selectedConfig:l,productDescription:S}){const[x,k]=i.useState("details"),[p,L]=i.useState(new Set(["metal","diamond","colorstone","general","description"])),g=r=>{L(j=>{const b=new Set(j);return b.has(r)?b.delete(r):b.add(r),b})},y=i.useMemo(()=>!l||!l.metals||l.metals.length===0?[]:l.metals.map(r=>{const j=r.purityName||r.label.match(/(\d+K|\d{3})/i)?.[1]?.toUpperCase()||"—",b=r.toneName||"—";let _="—";if(r.metalWeight){const n=parseFloat(r.metalWeight);!isNaN(n)&&n>0&&(_=n%1===0?`${n.toFixed(0)} g`:`${n.toFixed(2)} g`)}const D=r.metalName||(r.label.toLowerCase().includes("gold")?"Gold":r.label.toLowerCase().includes("silver")?"Silver":r.label.toLowerCase().includes("platinum")?"Platinum":"—"),w=r.label.replace(/\s+\d+\.?\d*\s*g\s*$/i,"").replace(/\s+\d+\.?\d*\s*grams?\s*$/i,"").trim(),s=w.split(/\s+/).filter(n=>n.length>0),t=s.length>=3?s.slice(0,3).join(" "):w;return{id:`${r.metalId}_${r.metalPurityId??"null"}_${r.metalToneId??"null"}`,title:t,karatage:j,materialColour:b,grossMetalWeight:_,metal:D}}),[l]),d=i.useMemo(()=>{if(!l||l.diamonds.length===0)return null;const r=l.diamonds,j=r[0],b=j.label.split(" ").filter(a=>a.length>0&&!a.match(/^\d+\.\d+ct$/i)&&!a.match(/^\(\d+\)$/));let _="",D="";for(let a=0;a<b.length;a++){const h=b[a];if(/^(SI|VS|VVS|IF|FL|I[1-3]|VVS[12]|VS[12])/i.test(h)){if(_=h.toUpperCase(),a>0){const M=b[a-1];/^[A-Z]{1,2}$/i.test(M)&&M.length<=2&&(D=M.toUpperCase())}break}}const w=_&&D?`${_} ${D}`:j.label.split(" ").slice(0,4).join(" "),s=j.label.match(/\b(Round|Princess|Oval|Emerald|Cushion|Marquise|Pear|Asscher|Radiant|Heart)\b/i),t=s?s[1]:"—",n=r.reduce((a,h)=>{const M=parseFloat(h.totalCarat||"0");return a+(isNaN(M)?0:M)},0),m=n>0?`${n.toFixed(2)} ct`:"—",c=r.reduce((a,h)=>a+(h.stoneCount||0),0),o=c>0?c.toString():"—";return{diamondQuality:w,diamondShape:t,totalCaratWeight:m,numberOfDiamonds:o}},[l]),v=i.useMemo(()=>{if(!l||!l.colorstones||l.colorstones.length===0)return null;const r=l.colorstones,j=r[0],b=j.label.split(" ").filter(c=>c.length>0&&!c.match(/^\d+\.\d+ct$/i)&&!c.match(/^\(\d+\)$/)),_=j.shapeName||b[0]||"—",D=j.colorName||b[1]||"—",w=j.qualityName||b[2]||"—",s=r.reduce((c,o)=>{const a=parseFloat(o.totalCarat||"0");return c+(isNaN(a)?0:a)},0),t=s>0?`${s.toFixed(2)} ct`:"—",n=r.reduce((c,o)=>c+(o.stoneCount||0),0),m=n>0?n.toString():"—";return{colorstoneShape:_,colorstoneColor:D,colorstoneQuality:w,totalCaratWeight:t,numberOfColorstones:m}},[l]);return e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"flex border-b border-[#0E244D]/20",children:[e.jsx("button",{type:"button",onClick:()=>k("details"),className:`px-4 py-2 text-sm font-semibold transition-colors ${x==="details"?"text-[#0E244D] border-b-2 border-[#0E244D]":"text-gray-500 hover:text-[#0E244D]"}`,children:"Product Details"}),e.jsx("button",{type:"button",onClick:()=>k("price"),className:`px-4 py-2 text-sm font-semibold transition-colors ${x==="price"?"text-[#0E244D] border-b-2 border-[#0E244D]":"text-gray-500 hover:text-[#0E244D]"}`,children:"Price Breakup"})]}),x==="details"&&e.jsxs("div",{className:"space-y-4",children:[l&&e.jsxs("div",{className:"rounded-2xl bg-white border border-[#0E244D]/10 shadow-sm overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>g("metal"),className:"w-full flex items-center justify-between px-6 py-4 text-left hover:bg-[#F8F5F0]/50 transition-colors",children:[e.jsx("h3",{className:"text-base font-semibold text-[#0E244D]",children:"Metal Details"}),e.jsx("svg",{className:`w-5 h-5 text-[#0E244D] transition-transform ${p.has("metal")?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),p.has("metal")&&e.jsx("div",{className:"px-6 pb-6 space-y-6",children:y.length>0?y.map((r,j)=>e.jsxs("div",{className:j>0?"pt-6 border-t border-gray-200":"",children:[e.jsx("h4",{className:"text-sm font-semibold text-[#0E244D] mb-4",children:r.title}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 mb-1",children:"Karatage"}),e.jsx("div",{className:"text-lg font-semibold text-[#0E244D]",children:r.karatage})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 mb-1",children:"Material Colour"}),e.jsx("div",{className:"text-lg font-semibold text-[#0E244D]",children:r.materialColour})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 mb-1",children:"Gross Metal Weight"}),e.jsx("div",{className:"text-lg font-semibold text-[#0E244D]",children:r.grossMetalWeight})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 mb-1",children:"Metal"}),e.jsx("div",{className:"text-lg font-semibold text-[#0E244D]",children:r.metal})]})]})]},r.id)):e.jsx("div",{className:"text-sm text-gray-500",children:"No metal details available for this configuration."})})]}),l&&e.jsxs("div",{className:"rounded-2xl bg-white border border-[#0E244D]/10 shadow-sm overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>g("diamond"),className:"w-full flex items-center justify-between px-6 py-4 text-left hover:bg-[#F8F5F0]/50 transition-colors",children:[e.jsx("h3",{className:"text-base font-semibold text-[#0E244D]",children:"Diamond Details"}),e.jsx("svg",{className:`w-5 h-5 text-[#0E244D] transition-transform ${p.has("diamond")?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),p.has("diamond")&&e.jsx("div",{className:"px-6 pb-6",children:d?e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 mb-1",children:"Diamond Quality"}),e.jsx("div",{className:"text-lg font-semibold text-[#0E244D]",children:d.diamondQuality})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 mb-1",children:"Diamond Shape"}),e.jsx("div",{className:"text-lg font-semibold text-[#0E244D]",children:d.diamondShape})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 mb-1",children:"Total Carat Weight"}),e.jsx("div",{className:"text-lg font-semibold text-[#0E244D]",children:d.totalCaratWeight})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 mb-1",children:"Number of Diamonds"}),e.jsx("div",{className:"text-lg font-semibold text-[#0E244D]",children:d.numberOfDiamonds})]})]}):e.jsx("div",{className:"text-sm text-gray-500",children:"No diamond details available for this configuration."})})]}),l&&e.jsxs("div",{className:"rounded-2xl bg-white border border-[#0E244D]/10 shadow-sm overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>g("colorstone"),className:"w-full flex items-center justify-between px-6 py-4 text-left hover:bg-[#F8F5F0]/50 transition-colors",children:[e.jsx("h3",{className:"text-base font-semibold text-[#0E244D]",children:"Colorstone Details"}),e.jsx("svg",{className:`w-5 h-5 text-[#0E244D] transition-transform ${p.has("colorstone")?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),p.has("colorstone")&&e.jsx("div",{className:"px-6 pb-6",children:v?e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 mb-1",children:"Colorstone Type"}),e.jsx("div",{className:"text-lg font-semibold text-[#0E244D]",children:v.colorstoneColor})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 mb-1",children:"Shape"}),e.jsx("div",{className:"text-lg font-semibold text-[#0E244D]",children:v.colorstoneShape})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 mb-1",children:"Quality"}),e.jsx("div",{className:"text-lg font-semibold text-[#0E244D]",children:v.colorstoneQuality})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 mb-1",children:"Total Carat Weight"}),e.jsx("div",{className:"text-lg font-semibold text-[#0E244D]",children:v.totalCaratWeight})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 mb-1",children:"Number of Colorstones"}),e.jsx("div",{className:"text-lg font-semibold text-[#0E244D]",children:v.numberOfColorstones})]})]}):e.jsx("div",{className:"text-sm text-gray-500",children:"No colorstone details available for this configuration."})})]}),e.jsxs("div",{className:"rounded-2xl bg-white border border-[#0E244D]/10 shadow-sm overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>g("general"),className:"w-full flex items-center justify-between px-6 py-4 text-left hover:bg-[#F8F5F0]/50 transition-colors",children:[e.jsx("h3",{className:"text-base font-semibold text-[#0E244D]",children:"General Details"}),e.jsx("svg",{className:`w-5 h-5 text-[#0E244D] transition-transform ${p.has("general")?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),p.has("general")&&e.jsx("div",{className:"px-6 pb-6",children:e.jsx("div",{className:"text-sm text-gray-600",children:"General product information will be displayed here."})})]}),S&&e.jsxs("div",{className:"rounded-2xl bg-white border border-[#0E244D]/10 shadow-sm overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>g("description"),className:"w-full flex items-center justify-between px-6 py-4 text-left hover:bg-[#F8F5F0]/50 transition-colors",children:[e.jsx("h3",{className:"text-base font-semibold text-[#0E244D]",children:"Description"}),e.jsx("svg",{className:`w-5 h-5 text-[#0E244D] transition-transform ${p.has("description")?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),p.has("description")&&e.jsx("div",{className:"px-6 pb-6",children:e.jsx("div",{className:"text-sm text-gray-700 leading-relaxed",children:S})})]})]}),x==="price"&&l&&e.jsxs("div",{className:"rounded-2xl bg-white border border-[#0E244D]/10 shadow-sm p-6",children:[e.jsx("h3",{className:"text-base font-semibold text-[#0E244D] mb-4",children:"Price Breakdown"}),e.jsxs("div",{className:"space-y-3",children:[l.price_breakup.metal>0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Metal"}),e.jsxs("span",{className:"text-sm font-semibold text-[#0E244D]",children:["₹",l.price_breakup.metal.toLocaleString("en-IN")]})]}),l.price_breakup.diamond>0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Diamond"}),e.jsxs("span",{className:"text-sm font-semibold text-[#0E244D]",children:["₹",l.price_breakup.diamond.toLocaleString("en-IN")]})]}),l.price_breakup.colorstone>0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Colorstone"}),e.jsxs("span",{className:"text-sm font-semibold text-[#0E244D]",children:["₹",l.price_breakup.colorstone.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Making Charge"}),e.jsxs("span",{className:"text-sm font-semibold text-[#0E244D]",children:["₹",l.price_breakup.making.toLocaleString("en-IN")]})]}),l.price_breakup.adjustment!==0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Adjustment"}),e.jsxs("span",{className:"text-sm font-semibold text-[#0E244D]",children:["₹",l.price_breakup.adjustment.toLocaleString("en-IN")]})]}),e.jsx("div",{className:"border-t border-gray-200 pt-3 mt-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-base font-semibold text-[#0E244D]",children:"Total"}),e.jsxs("span",{className:"text-lg font-bold text-[#0E244D]",children:["₹",l.price_total.toLocaleString("en-IN")]})]})})]})]})]})}const $=new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0});function fe(){const l=ae(),{mode:S,product:x,configurationOptions:k}=l.props,p=l.props.wishlist?.product_ids??[],L=i.useMemo(()=>new Set(p),[p]),[g,y]=i.useState(k[0]?.variant_id??null),d=i.useMemo(()=>k.find(u=>u.variant_id===g)??null,[g,k]),[v]=i.useState("purchase"),[r,j]=i.useState(!1),[b,_]=i.useState(!1),[D,w]=i.useState("1"),[s,t]=i.useState(0);i.useRef(null);const[n,m]=i.useState(!1),[c,o]=i.useState(1.5),a=x.media.length,h=a>0,M=h?x.media[Math.min(s,a-1)]:null,z=(u,f,I)=>Math.min(I,Math.max(f,u)),{data:E,setData:C,post:K,processing:P,errors:q}=ne({product_id:x.id,product_variant_id:g??null,mode:v,quantity:1,notes:"",selections:{metal_id:null,metal_purity_id:null,metal_tone_id:null,diamond_option_keys:[],size_cm:null}});i.useEffect(()=>{C("mode",v)},[v,C]),i.useEffect(()=>{w(String(E.quantity))},[g,E.quantity]);const F=S==="jobwork",A=F&&!x.is_jobwork_allowed;i.useEffect(()=>{C("product_variant_id",g??null)},[g,C]);const[ce,me]=i.useState(!1),[xe,Z]=i.useState(L.has(x.id));i.useEffect(()=>{Z(L.has(x.id))},[L,x.id]),i.useEffect(()=>{t(0)},[x.id]),i.useEffect(()=>{s>a-1&&t(Math.max(a-1,0))},[s,a]);const G=i.useMemo(()=>d?F?d.price_breakup.making+d.price_breakup.adjustment:d.price_total:0,[d,F]),H=u=>{if(u.preventDefault(),P||B||A)return;const f={product_id:x.id,product_variant_id:E.product_variant_id,quantity:E.quantity,configuration:{mode:v,notes:E.notes,selections:E.selections}};U.post(route("frontend.cart.items.store"),f,{preserveScroll:!0})},J=()=>{P||b||(_(!0),K(route("frontend.quotations.store"),{preserveScroll:!0,onSuccess:()=>j(!1),onFinish:()=>_(!1)}))},X=()=>{const u={product_id:x.id,product_variant_id:E.product_variant_id,quantity:E.quantity,configuration:{mode:S,notes:E.notes,selections:E.selections}};U.post(route("frontend.cart.items.store"),u,{preserveScroll:!0,onSuccess:()=>{j(!1)}})},Y=i.useCallback(()=>{h&&m(!0)},[h]),T=i.useCallback(()=>{m(!1)},[]);i.useCallback(u=>{o(f=>z(f+u,1,3))},[]);const Q=i.useCallback(()=>o(1.5),[]),R=i.useCallback(()=>{!h||a<=1||t(u=>(u-1+a)%a)},[h,a]),O=i.useCallback(()=>{!h||a<=1||t(u=>(u+1)%a)},[h,a]);i.useEffect(()=>{if(!n||typeof document>"u")return;const u=document.body.style.overflow;document.body.style.overflow="hidden";const f=I=>{I.key==="Escape"?T():I.key==="ArrowRight"?O():I.key==="ArrowLeft"&&R()};return window.addEventListener("keydown",f),()=>{document.body.style.overflow=u,window.removeEventListener("keydown",f)}},[n,T,O,R]),i.useEffect(()=>{n&&Q()},[s,n,Q]);const B=k.length>0&&!d,N=d?.inventory_quantity??null,V=N!==null&&N===0,ee=parseInt(D,10)||1,W=N!==null&&N>0&&ee>N,te=V||W;return i.useEffect(()=>{w(String(E.quantity))},[g]),e.jsxs(ie,{children:[e.jsx(le,{title:x.name}),e.jsx("div",{className:"space-y-8",children:e.jsxs("div",{className:"grid gap-10 lg:grid-cols-[1.6fr_1fr]",children:[e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:x.name}),x.brand&&e.jsxs("p",{className:"mt-1 text-sm text-slate-500",children:["by ",x.brand]})]}),h&&e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"relative aspect-square w-full overflow-hidden rounded-2xl bg-slate-100",children:e.jsx("img",{src:M?.url,alt:M?.alt??x.name,className:"h-full w-full object-cover",onClick:Y,onError:u=>{const f=u.target;f.src="/placeholder-image.png"}})}),a>1&&e.jsx("div",{className:"mt-4 flex gap-2 overflow-x-auto pb-2",children:x.media.map((u,f)=>e.jsx("button",{type:"button",onClick:()=>t(f),className:`relative h-20 w-20 flex-shrink-0 overflow-hidden rounded-xl border-2 transition ${f===s?"border-feather-gold":"border-transparent hover:border-slate-300"}`,children:e.jsx("img",{src:u.url,alt:u.alt??x.name,className:"h-full w-full object-cover",onError:I=>{const se=I.target;se.src="/placeholder-image.png"}})},f))})]}),e.jsx(de,{selectedConfig:d,productDescription:x.description})]})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("form",{onSubmit:H,className:"w-full space-y-5 rounded-3xl bg-white p-6 shadow-xl ring-1 ring-slate-200/80",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Request quotation"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Select your configuration and our merchandising desk will share pricing shortly."})]}),k.length>0&&e.jsx(oe,{configurationOptions:k,selectedVariantId:g,onVariantChange:y}),e.jsxs("label",{className:"block space-y-1",children:[e.jsxs("span",{className:"text-xs font-semibold text-slate-600",children:["Quantity",N!==null&&N>0&&!W&&e.jsxs("span",{className:"ml-1 font-normal text-slate-500",children:["(Available: ",N,")"]})]}),e.jsx("input",{type:"number",min:"1",max:N!==null&&N>0?N:void 0,value:D,onChange:u=>{const f=u.target.value;w(f);const I=parseInt(f,10);!isNaN(I)&&I>=1&&C("quantity",I)},onBlur:u=>{const f=parseInt(D,10);isNaN(f)||f<1?(w("1"),C("quantity",1)):(w(String(f)),C("quantity",f))},className:`w-full rounded-2xl border px-4 py-2.5 text-sm text-slate-900 focus:outline-none focus:ring-2 ${W&&!V?"border-rose-300 bg-rose-50 focus:border-rose-400 focus:ring-rose-400/20":"border-slate-200 bg-white focus:border-feather-gold focus:ring-feather-gold/20"}`}),q.quantity&&e.jsx("span",{className:"text-xs text-rose-500",children:q.quantity}),W&&!V&&!q.quantity&&N!==null&&e.jsxs("span",{className:"text-xs text-rose-500",children:["Only ",N," ",N===1?"item is":"items are"," available. Maximum ",N," ",N===1?"item":"items"," allowed for request."]})]}),e.jsxs("label",{className:"block space-y-1",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-600",children:"Notes (optional)"}),e.jsx("textarea",{rows:4,value:E.notes,onChange:u=>C("notes",u.target.value),className:"w-full rounded-2xl border border-slate-200 bg-white px-4 py-2.5 text-sm text-slate-900 focus:border-feather-gold focus:outline-none focus:ring-2 focus:ring-feather-gold/20",placeholder:"List required scope: hallmarking, hallmark packaging, diamond certification, delivery deadlines…"}),q.notes&&e.jsx("span",{className:"text-xs text-rose-500",children:q.notes})]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 px-4 py-3 text-sm text-slate-600",children:[e.jsx("p",{className:"font-semibold text-slate-700",children:"Estimated total"}),d?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mt-1 text-xl font-semibold text-slate-900",children:$.format(G)}),e.jsx("p",{className:"text-xs text-slate-500",children:F?"Includes making charge only. Final quotation may vary with labour costs.":"Includes metal, diamond, colorstone, making charge & adjustment. Final quotation may vary with bullion/diamond parity and labour."}),!F&&e.jsxs("div",{className:"mt-2 space-y-1 text-xs",children:[d.price_breakup.metal>0&&e.jsxs("p",{className:"flex justify-between",children:[e.jsx("span",{children:"Metal:"}),e.jsx("span",{className:"font-medium",children:$.format(d.price_breakup.metal)})]}),d.price_breakup.diamond>0&&e.jsxs("p",{className:"flex justify-between",children:[e.jsx("span",{children:"Diamond:"}),e.jsx("span",{className:"font-medium",children:$.format(d.price_breakup.diamond)})]}),d.price_breakup.colorstone>0&&e.jsxs("p",{className:"flex justify-between",children:[e.jsx("span",{children:"Colorstone:"}),e.jsx("span",{className:"font-medium",children:$.format(d.price_breakup.colorstone)})]}),e.jsxs("p",{className:"flex justify-between",children:[e.jsx("span",{children:"Making:"}),e.jsx("span",{className:"font-medium",children:$.format(d.price_breakup.making)})]}),d.price_breakup.adjustment!==0&&e.jsxs("p",{className:"flex justify-between",children:[e.jsx("span",{children:"Adjustment:"}),e.jsx("span",{className:"font-medium",children:$.format(d.price_breakup.adjustment)})]})]}),F&&e.jsxs("div",{className:"mt-2 space-y-1 text-xs",children:[e.jsxs("p",{className:"flex justify-between",children:[e.jsx("span",{children:"Making charge:"}),e.jsx("span",{className:"font-medium",children:$.format(d.price_breakup.making)})]}),d.price_breakup.adjustment!==0&&e.jsxs("p",{className:"flex justify-between",children:[e.jsx("span",{children:"Adjustment:"}),e.jsx("span",{className:"font-medium",children:$.format(d.price_breakup.adjustment)})]})]})]}):e.jsx("p",{className:"mt-1 text-sm text-rose-600",children:"Please select a configuration to see pricing."})]}),V&&e.jsx("div",{className:"rounded-2xl border border-amber-300 bg-amber-50 px-4 py-3 text-sm text-amber-800",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"h-5 w-5 flex-shrink-0 text-amber-600 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Out of Stock"}),e.jsx("p",{className:"text-xs mt-0.5",children:"This product variant is currently out of stock. Quotation requests are not available."})]})]})}),e.jsx("button",{type:"submit",disabled:P||B||A||te,className:"w-full rounded-full bg-elvee-blue px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-elvee-blue/30 transition hover:bg-navy disabled:cursor-not-allowed disabled:opacity-60",children:P?"Submitting…":"Request quotation"})]})})]})}),r&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"w-full max-w-md space-y-4 rounded-3xl bg-white p-6 shadow-2xl",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Confirm quotation"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Submit this quotation request with the selected configuration? Our merchandising desk will review and respond shortly."}),e.jsxs("div",{className:"space-y-2 rounded-2xl bg-slate-50 p-4 text-xs text-slate-500",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-slate-700",children:"Mode:"})," ",S==="jobwork"?"Jobwork":"Jewellery"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-slate-700",children:"Quantity:"})," ",E.quantity]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",className:"rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-600 hover:border-slate-400 hover:text-slate-900",onClick:()=>j(!1),disabled:b,children:"Review again"}),e.jsx("button",{type:"button",className:"rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-600 hover:border-slate-400 hover:text-slate-900",onClick:X,disabled:b,children:"Add to quotation list"}),e.jsx("button",{type:"button",className:"rounded-full bg-elvee-blue px-4 py-2 text-sm font-semibold text-white shadow-elvee-blue/30 hover:bg-navy disabled:cursor-not-allowed disabled:opacity-60",onClick:J,disabled:b,children:b?"Submitting…":"Confirm submission"})]})]})})]})}export{fe as default};
