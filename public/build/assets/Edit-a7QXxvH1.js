import{u as Se,r as C,a as Ce,j as e,H as Me}from"./app-CQCZKZrJ.js";import{R as ze}from"./RichTextEditor-FaCyGwQD.js";import{A as $e}from"./AdminLayout-BZicIsUi.js";const de=(L=!1)=>({sku:"",label:"",metal_id:"",metal_purity_id:"",diamond_option_key:null,size_id:null,is_default:L,metadata:{},metals:[],diamonds:[]});function Le({subcategories:L,selectedIds:d,parentCategoryId:E,onChange:A,error:V}){const[q,R]=C.useState(!1),[P,W]=C.useState(""),F=C.useRef(null),K=C.useMemo(()=>E?L.filter(w=>w.parent_id===Number(E)):[],[L,E]),N=C.useMemo(()=>{if(!P.trim())return K;const w=P.toLowerCase();return K.filter(M=>M.name.toLowerCase().includes(w))},[K,P]),U=w=>{d.includes(w)?A(d.filter(M=>M!==w)):A([...d,w])};C.useEffect(()=>{const w=M=>{F.current&&!F.current.contains(M.target)&&(R(!1),W(""))};return q&&document.addEventListener("mousedown",w),()=>{document.removeEventListener("mousedown",w)}},[q]);const k=C.useMemo(()=>d.map(w=>{const M=L.find(O=>O.id===w);return M?{id:w,name:M.name}:null}).filter(Boolean),[d,L]),x=w=>{A(d.filter(M=>M!==w))};return C.useEffect(()=>{if(E){const w=d.filter(M=>{const O=L.find(u=>u.id===M);return O&&O.parent_id===Number(E)});w.length!==d.length&&A(w)}else d.length>0&&A([])},[E]),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Subcategories"}),d.length>0&&e.jsxs("span",{className:"text-xs font-medium text-sky-600",children:[d.length," selected"]})]}),e.jsxs("div",{className:"relative",ref:F,children:[e.jsx("button",{type:"button",onClick:()=>R(!q),disabled:!E,className:`w-full rounded-2xl border ${V?"border-rose-300":"border-slate-200"} bg-white px-4 py-2.5 text-left focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200 transition-all ${q?"border-sky-400 ring-2 ring-sky-200":""} ${E?"":"opacity-50 cursor-not-allowed"}`,children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"flex-1 min-h-[20px] flex flex-wrap gap-1.5",children:E?d.length===0?e.jsx("span",{className:"text-slate-400",children:"Select subcategories..."}):k.map(w=>e.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-md bg-sky-50 px-2 py-1 text-xs font-medium text-sky-700 border border-sky-200",onClick:M=>M.stopPropagation(),children:[e.jsx("span",{children:w.name}),e.jsx("button",{type:"button",onClick:M=>{M.stopPropagation(),x(w.id)},className:"hover:bg-sky-100 rounded-full p-0.5 transition-colors",children:e.jsx("svg",{className:"h-3 w-3 text-sky-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},w.id)):e.jsx("span",{className:"text-slate-400",children:"Select parent category first"})}),e.jsx("svg",{className:`ml-2 h-5 w-5 text-slate-400 transition-transform flex-shrink-0 ${q?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),q&&E&&e.jsxs("div",{className:"absolute z-50 mt-2 w-full rounded-2xl border border-slate-200 bg-white shadow-lg shadow-slate-900/10 max-h-80 overflow-hidden",children:[K.length>5&&e.jsx("div",{className:"border-b border-slate-100 p-3",children:e.jsxs("div",{className:"relative",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",value:P,onChange:w=>W(w.target.value),placeholder:"Search subcategories...",className:"w-full rounded-xl border border-slate-200 bg-white pl-10 pr-4 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",onClick:w=>w.stopPropagation()})]})}),e.jsx("div",{className:"max-h-64 overflow-y-auto p-2",children:N.length===0?e.jsx("div",{className:"px-3 py-6 text-center text-sm text-slate-400",children:P?"No subcategories found":"No subcategories available"}):e.jsx("div",{className:"space-y-1",children:N.map(w=>{const M=d.includes(w.id);return e.jsxs("button",{type:"button",onClick:()=>U(w.id),className:`w-full flex items-center gap-3 rounded-xl px-3 py-2.5 text-left transition-colors ${M?"bg-sky-50 text-sky-700":"text-slate-700 hover:bg-slate-50"}`,children:[e.jsx("div",{className:`flex h-5 w-5 items-center justify-center rounded border-2 transition-all ${M?"border-sky-500 bg-sky-500":"border-slate-300"}`,children:M&&e.jsx("svg",{className:"h-3.5 w-3.5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("span",{className:`text-sm font-medium truncate ${M?"text-sky-900":"text-slate-900"}`,children:w.name})})]},w.id)})})})]})]}),V&&e.jsx("span",{className:"text-xs text-rose-500",children:V})]})}function Ee({catalogs:L,selectedIds:d,onChange:E,error:A}){const[V,q]=C.useState(!1),[R,P]=C.useState(""),W=C.useRef(null),F=C.useMemo(()=>{if(!R.trim())return L;const k=R.toLowerCase();return L.filter(x=>x.name.toLowerCase().includes(k)||x.code?.toLowerCase().includes(k))},[L,R]),K=k=>{d.includes(k)?E(d.filter(x=>x!==k)):E([...d,k])};C.useEffect(()=>{const k=x=>{W.current&&!W.current.contains(x.target)&&(q(!1),P(""))};return V&&document.addEventListener("mousedown",k),()=>{document.removeEventListener("mousedown",k)}},[V]);const N=C.useMemo(()=>d.map(k=>{const x=L.find(w=>w.id===k);return x?{id:k,name:x.name}:null}).filter(Boolean),[d,L]),U=k=>{E(d.filter(x=>x!==k))};return e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Catalogs"}),d.length>0&&e.jsxs("span",{className:"text-xs font-medium text-sky-600",children:[d.length," selected"]})]}),e.jsxs("div",{className:"relative",ref:W,children:[e.jsx("button",{type:"button",onClick:()=>q(!V),className:`w-full rounded-2xl border ${A?"border-rose-300":"border-slate-200"} bg-white px-4 py-2.5 text-left focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200 transition-all ${V?"border-sky-400 ring-2 ring-sky-200":""}`,children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"flex-1 min-h-[20px] flex flex-wrap gap-1.5",children:d.length===0?e.jsx("span",{className:"text-slate-400",children:"Select catalogs..."}):N.map(k=>e.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-md bg-sky-50 px-2 py-1 text-xs font-medium text-sky-700 border border-sky-200",onClick:x=>x.stopPropagation(),children:[e.jsx("span",{children:k.name}),e.jsx("button",{type:"button",onClick:x=>{x.stopPropagation(),U(k.id)},className:"hover:bg-sky-100 rounded-full p-0.5 transition-colors",children:e.jsx("svg",{className:"h-3 w-3 text-sky-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},k.id))}),e.jsx("svg",{className:`ml-2 h-5 w-5 text-slate-400 transition-transform flex-shrink-0 ${V?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),V&&e.jsxs("div",{className:"absolute z-50 mt-2 w-full rounded-2xl border border-slate-200 bg-white shadow-lg shadow-slate-900/10 max-h-80 overflow-hidden",children:[L.length>5&&e.jsx("div",{className:"border-b border-slate-100 p-3",children:e.jsxs("div",{className:"relative",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",value:R,onChange:k=>P(k.target.value),placeholder:"Search catalogs...",className:"w-full rounded-xl border border-slate-200 bg-white pl-10 pr-4 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",onClick:k=>k.stopPropagation()})]})}),e.jsx("div",{className:"max-h-64 overflow-y-auto p-2",children:F.length===0?e.jsx("div",{className:"px-3 py-6 text-center text-sm text-slate-400",children:R?"No catalogs found":"No catalogs available"}):e.jsx("div",{className:"space-y-1",children:F.map(k=>{const x=d.includes(k.id);return e.jsxs("button",{type:"button",onClick:()=>K(k.id),className:`w-full flex items-center gap-3 rounded-xl px-3 py-2.5 text-left transition-colors ${x?"bg-sky-50 text-sky-700":"text-slate-700 hover:bg-slate-50"}`,children:[e.jsx("div",{className:`flex h-5 w-5 items-center justify-center rounded border-2 transition-all ${x?"border-sky-500 bg-sky-500":"border-slate-300"}`,children:x&&e.jsx("svg",{className:"h-3.5 w-3.5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm font-medium truncate ${x?"text-sky-900":"text-slate-900"}`,children:k.name}),k.code&&e.jsxs("span",{className:`text-xs font-mono ${x?"text-sky-600":"text-slate-500"}`,children:["(",k.code,")"]})]})})]},k.id)})})})]})]}),A&&e.jsx("span",{className:"text-xs text-rose-500",children:A})]})}function Be(){const{props:L}=Se(),{product:d,brands:E,parentCategories:A,subcategories:V,catalogs:q,diamonds:R,metals:P,metalPurities:W,metalTones:F,sizes:K,errors:N}=L,U=C.useMemo(()=>{if(!d?.variants?.length)return{metalPurityIds:[],metalToneIds:[],diamondSelections:[],metalSelections:[],selectedMetals:[],metalConfigurations:{}};const t=new Set,s=new Set,n=new Map,c=new Map,i=new Set,a=new Map;d.variants.forEach(f=>{f.metals?.length&&f.metals.forEach(o=>{if(o.metal_id&&o.metal_id!==""&&o.metal_id!==null){const l=typeof o.metal_id=="number"?o.metal_id:Number(o.metal_id);let h=o.metal_purity_id;(h==null||h===""||h===0)&&o.metal_purity&&(h=o.metal_purity.id);let b=o.metal_tone_id;(b==null||b===""||b===0)&&o.metal_tone&&(b=o.metal_tone.id);const g=h&&h!==""&&h!==0?typeof h=="number"?h:Number(h):0,_=b&&b!==""&&b!==0?typeof b=="number"?b:Number(b):0,y=o.metal_weight?String(o.metal_weight):"",r=`${l}-${g}-${_}`;if(c.has(r)||c.set(r,{metal_id:l,metal_purity_id:g||0,metal_tone_id:_||0,weight:y}),!isNaN(l)&&l>0){i.add(l),a.has(l)||a.set(l,{purities:new Set,tones:new Set});const S=a.get(l);!isNaN(g)&&g>0&&(S.purities.add(g),t.add(g)),!isNaN(_)&&_>0&&(S.tones.add(_),s.add(_))}}}),f.diamonds?.length&&f.diamonds.forEach(o=>{if(o.diamond_id&&o.diamond_id!==""&&o.diamond_id!==null){const l=typeof o.diamond_id=="number"?o.diamond_id:Number(o.diamond_id);n.has(l)||n.set(l,{diamond_id:l,count:o.diamonds_count&&o.diamonds_count!==""&&o.diamonds_count!==null?String(o.diamonds_count):""})}})});const m={};return a.forEach((f,o)=>{m[o]={purities:Array.from(f.purities),tones:Array.from(f.tones)}}),{metalPurityIds:Array.from(t),metalToneIds:Array.from(s),diamondSelections:Array.from(n.values()),metalSelections:Array.from(c.values()).map(f=>({metal_id:f.metal_id,metal_purity_id:f.metal_purity_id||"",metal_tone_id:f.metal_tone_id||"",weight:f.weight})),selectedMetals:Array.from(i),metalConfigurations:m}},[d]),k=Ce(()=>({sku:d?.sku??"",name:d?.name??"",titleline:d?.titleline??"",description:d?.description??"",catalog_ids:d?.catalog_ids??[],subcategory_ids:d?.category_ids??[],brand_id:String(d?.brand_id??""),category_id:String(d?.category_id??""),collection:d?.collection??"",producttype:d?.producttype??"",gender:d?.gender??"",making_charge_amount:d?.making_charge_amount?String(d.making_charge_amount):"",making_charge_types:(()=>{const t=d?.making_charge_amount&&Number(d.making_charge_amount)>0,s=d?.making_charge_percentage&&Number(d.making_charge_percentage)>0;return t&&s?["fixed","percentage"]:s?["percentage"]:t?["fixed"]:["fixed"]})(),making_charge_percentage:d?.making_charge_percentage?String(d.making_charge_percentage):"",is_active:d?.is_active??!0,variants:d?.variants?.length?d.variants.map((t,s)=>{const n=t.metals&&t.metals.length>0?t.metals[0]:null,c=n?.metal_id??t.metadata?.metal_id??"",i=n?.metal_purity_id??t.metadata?.metal_purity_id??"",a=t.metadata?.diamond_option_key??null;return{id:t.id,sku:t.sku??"",label:t.label??"",metal_id:c!==""&&c!==null&&c!==void 0?typeof c=="number"?c:Number(c):"",metal_purity_id:i!==""&&i!==null&&i!==void 0?typeof i=="number"?i:Number(i):"",diamond_option_key:a,size_id:t.size_id??null,is_default:t.is_default??s===0,inventory_quantity:t.inventory_quantity!==void 0&&t.inventory_quantity!==null?Number(t.inventory_quantity):0,metadata:t.metadata??{},metals:t.metals?.map(m=>({id:m.id,metal_id:m.metal_id??"",metal_purity_id:m.metal_purity_id??"",metal_tone_id:m.metal_tone_id??"",metal_weight:m.metal_weight?String(m.metal_weight):""}))??[],diamonds:t.diamonds?.map(m=>({id:m.id,diamond_id:m.diamond_id??"",diamonds_count:m.diamonds_count?String(m.diamonds_count):""}))??[]}}):[de(!0)],diamond_options:[],uses_diamond:(U.diamondSelections?.length??0)>0,diamond_selections:U.diamondSelections??[],metal_selections:U.metalSelections??[],selected_metals:U.selectedMetals??[],metal_configurations:U.metalConfigurations??{},all_sizes_available:(()=>{if(d?.category?.sizes&&d.category.sizes.length>0&&d?.variants&&d.variants.length>0){const t=d.category.sizes.map(n=>n.id).sort(),s=d.variants.map(n=>n.size_id).filter(n=>n!=null).sort().filter((n,c,i)=>i.indexOf(n)===c);if(t.length===s.length&&t.every(n=>s.includes(n)))return!0}})(),selected_sizes:(()=>{if(d?.variants&&d.variants.length>0){const t=d.variants.map(s=>s.size_id).filter(s=>s!=null);return[...new Set(t)]}return[]})(),media_uploads:[],removed_media_ids:[]})),{setData:x,post:w,put:M,processing:O}=k,u=k.data,[ee,te]=C.useState(u.description),G=C.useRef(null);C.useEffect(()=>{u.description!==ee&&te(u.description)},[u.description]);const ce=C.useCallback(t=>{te(t),G.current&&clearTimeout(G.current),G.current=setTimeout(()=>{x("description",t)},300)},[x]);C.useEffect(()=>()=>{G.current&&clearTimeout(G.current)},[]);const[me,De]=C.useState(new Set),[ue,Ae]=C.useState(new Set),xe=t=>Number.isFinite(t)?t.toFixed(3).replace(/\.?0+$/,""):"",H=C.useMemo(()=>Object.fromEntries(W.map(t=>[t.id,t.name])),[W]),Z=C.useMemo(()=>Object.fromEntries(F.map(t=>[t.id,t.name])),[F]),Y=C.useMemo(()=>Object.fromEntries(P.map(t=>[t.id,t.name])),[P]),I=C.useCallback((t,s)=>{let n="";if(t.metals&&t.metals.length>0){const g=t.metals.filter(_=>_.metal_id!==""&&typeof _.metal_id=="number").map(_=>({metal_id:_.metal_id,metal_purity_id:_.metal_purity_id!==""&&_.metal_purity_id!==null?Number(_.metal_purity_id):null,metal_tone_id:_.metal_tone_id!==""&&_.metal_tone_id!==null?Number(_.metal_tone_id):null}));if(g.length===0)n="";else{const _=new Map;g.forEach(r=>{_.has(r.metal_id)||_.set(r.metal_id,[]),_.get(r.metal_id).push(r)});const y=[];_.forEach((r,S)=>{const p=Y[S]??"";if(!p)return;const D=new Set(r.map(v=>v.metal_purity_id).filter(Boolean)),$=new Set(r.map(v=>v.metal_tone_id).filter(Boolean));let j="";if(D.size>1&&$.size===1){const v=Array.from($)[0],z=v?Z[v]??"":"",T=Array.from(D).map(B=>B?H[B]??"":"").filter(Boolean).sort();T.length>0?z?j=`${T.join(" + ")} ${z} ${p}`:j=`${T.join(" + ")} ${p}`:j=p}else if($.size>1&&D.size===1){const v=Array.from(D)[0],z=v?H[v]??"":"",T=Array.from($).map(B=>B?Z[B]??"":"").filter(Boolean).sort();T.length>0?z?j=`${z} ${T.join(" + ")} ${p}`:j=`${T.join(" + ")} ${p}`:j=z?`${z} ${p}`:p}else{const v=r[0],z=v.metal_purity_id,T=v.metal_tone_id,B=z?H[z]??"":"",X=T?Z[T]??"":"";B&&X?j=`${B} ${X} ${p}`:B?j=`${B} ${p}`:X?j=`${X} ${p}`:j=p}j&&y.push(j)}),n=y.join(" / ")}}else if(t.metal_id!==""&&typeof t.metal_id=="number"){const g=Y[t.metal_id]??"";if(t.metal_purity_id!==""&&typeof t.metal_purity_id=="number"){const _=H[t.metal_purity_id]??"";n=_?`${_} ${g}`:g}else n=g}let c="";if(t.diamonds&&t.diamonds.length>0){const g=[];t.diamonds.forEach(_=>{if(_.diamond_id&&typeof _.diamond_id=="number"){const y=_.diamonds_count?` (${_.diamonds_count})`:"";g.push(`Diamond${y}`)}}),c=g.join(" / ")}const i=t.metadata??{},a="",m=[c,n,a].filter(Boolean),f=m.length?m.join(" / "):"Variant",o=n;let l=null;t.diamonds&&t.diamonds.length>0&&(l=t.diamonds.map(g=>({diamond_id:g.diamond_id!==""&&g.diamond_id!==null?Number(g.diamond_id):null,diamonds_count:g.diamonds_count?Number(g.diamonds_count):null})));const h={metal_id:t.metal_id!==""&&t.metal_id!==null?Number(t.metal_id):null,metal_purity_id:t.metal_purity_id!==""&&t.metal_purity_id!==null?Number(t.metal_purity_id):null,diamond_option_key:t.diamond_option_key??null,diamond:l,auto_label:f};delete h.size_value,delete h.size_unit;const b=typeof i.status=="string"&&i.status.trim().length>0?String(i.status):void 0;return b?h.status=b:h.status="enabled",{autoLabel:f,metalTone:o,sizeText:a,metadata:h}},[xe,Y,H,Z]),J=C.useCallback(t=>(t.variants||[]).map((s,n)=>{const c=I(s,t),i=s.metadata?.auto_label??"",a=!s.label||s.label===i,m=s.metadata?.auto_sku??"",f=(t.sku??"").trim(),l=`${f?f.replace(/[^A-Za-z0-9]/g,"").toUpperCase():"SKU"}-${String(n+1).padStart(2,"0")}`,h=!s.sku||s.sku===m;return{...s,sku:h?l:s.sku,label:a?c.autoLabel:s.label,metadata:{...c.metadata,auto_sku:l},is_default:s.is_default??n===0}}),[I]),pe=()=>{x(t=>{const s=t.diamond_selections||[];return{...t,diamond_selections:[...s,{diamond_id:"",count:""}]}})},he=t=>{x(s=>{const n=s.diamond_selections||[];return{...s,diamond_selections:n.filter((c,i)=>i!==t)}})},se=(t,s,n)=>{x(c=>{const a=(c.diamond_selections||[]).map((m,f)=>f!==t?m:{...m,[s]:n});return{...c,diamond_selections:a}})},fe=t=>{x(s=>{if((s.variants||[]).length===1)return s;const n=(s.variants||[]).filter((i,a)=>a!==t);n.every(i=>!i.is_default)&&n.length>0&&(n[0].is_default=!0);const c={...s,variants:n};return c.variants=J(c),c})},Q=(t,s,n)=>{x(c=>{const i=(c.variants||[]).map((m,f)=>{if(f!==t)return m;const o={...m};switch(s){case"is_default":typeof n=="boolean"&&(o.is_default=n);break;case"metal_id":(n===""||typeof n=="number")&&(o.metal_id=n,(n===""||typeof n!="number")&&(o.metal_purity_id=""));break;case"metal_purity_id":(n===""||typeof n=="number")&&(o.metal_purity_id=n);break;case"diamond_option_key":o.diamond_option_key=n?String(n):null;break;case"sku":case"label":typeof n=="string"&&(o[s]=n);break;case"inventory_quantity":if(n===""||n===null)o[s]=0;else if(typeof n=="string"){const l=parseInt(n,10);o[s]=isNaN(l)?0:l}else typeof n=="number"&&(o[s]=n);break}return o}),a={...c,variants:i};return a.variants=J(a),a})},ge=(t,s)=>{x(n=>{const c=(n.variants||[]).map((a,m)=>{if(m!==t)return a;const f={...a.metadata??{}};return Object.entries(s).forEach(([o,l])=>{l===null?delete f[o]:f[o]=l}),{...a,metadata:f}}),i={...n,variants:c};return i.variants=J(i),i})},_e=t=>{x(s=>({...s,variants:(s.variants||[]).map((n,c)=>({...n,is_default:c===t}))}))},be=(t,s)=>{x(n=>{const c=(n.variants||[]).map((i,a)=>{if(a!==t)return i;const m=i.diamonds||[];return{...i,diamonds:m.filter((f,o)=>o!==s)}});return{...n,variants:c}})},ae=(t,s,n,c)=>{x(i=>{const a=(i.variants||[]).map((m,f)=>{if(f!==t)return m;const l=(m.diamonds||[]).map((h,b)=>b!==s?h:{...h,[n]:c});return{...m,diamonds:l}});return{...i,variants:a}})},ne=(t,s,n,c)=>{x(i=>{const a=(i.variants||[]).map((m,f)=>{if(f!==t)return m;const l=(m.metals||[]).map((h,b)=>b!==s?h:{...h,[n]:c});return{...m,metals:l}});return{...i,variants:a}})},ye=t=>{const s=[],n=t.selected_metals||[],c=t.metal_configurations||{};if(n.length>0&&n.forEach(l=>{const h=c[l]||{purities:[],tones:[]},b=h.purities.length>0?h.purities:[null],g=h.tones.length>0?h.tones:[null];b.forEach(_=>{g.forEach(y=>{s.push([{metal_id:l,metal_purity_id:_!==null?_:null,metal_tone_id:y!==null?y:null}])})})}),s.length===0)return t;let i=t.selected_sizes||[];if(t.all_sizes_available===!0){const l=t.category_id?Number(t.category_id):null,h=l?A.find(g=>g.id===l):null;i=(h&&"sizes"in h&&h.sizes||d?.category?.sizes||[]).map(g=>typeof g.id=="number"?g.id:Number(g.id))}const a=[];if(i.length>0?s.forEach(l=>{i.forEach(h=>{a.push({metals:l,size_id:h})})}):s.forEach(l=>{a.push({metals:l,size_id:null})}),a.length===0)return t;const m=new Map;(t.variants||[]).forEach(l=>{if(!l.metals||l.metals.length===0)return;const h=l.size_id||null,b=h?`size-${h}`:"no-size",_=`${l.metals.filter(y=>y.metal_id!==""&&typeof y.metal_id=="number").map(y=>`${y.metal_id}-${y.metal_purity_id||"null"}-${y.metal_tone_id||"null"}`).sort().join("|")}::${b}`;m.set(_,{metals:l.metals.map(y=>({metal_id:typeof y.metal_id=="number"?y.metal_id:0,metal_purity_id:y.metal_purity_id!==""&&y.metal_purity_id!==null?typeof y.metal_purity_id=="number"?y.metal_purity_id:Number(y.metal_purity_id):null,metal_tone_id:y.metal_tone_id!==""&&y.metal_tone_id!==null?typeof y.metal_tone_id=="number"?y.metal_tone_id:Number(y.metal_tone_id):null,metal_weight:y.metal_weight||""})),diamonds:(l.diamonds||[]).map(y=>({diamond_id:y.diamond_id!==""&&y.diamond_id!==null?typeof y.diamond_id=="number"?y.diamond_id:Number(y.diamond_id):null,diamonds_count:y.diamonds_count||""}))})});const f=a.map((l,h)=>{const b=de(h===0),g=l.size_id?`size-${l.size_id}`:"no-size",y=`${l.metals.map(p=>`${p.metal_id}-${p.metal_purity_id||"null"}-${p.metal_tone_id||"null"}`).sort().join("|")}::${g}`,r=m.get(y);if(b.metals=l.metals.map(p=>{const D=r?.metals.find(j=>j.metal_id===p.metal_id&&j.metal_purity_id===(p.metal_purity_id??null)&&j.metal_tone_id===(p.metal_tone_id??null));let $="";if((t.metal_selections||[]).length>0){const j=(t.metal_selections||[]).find(v=>{const z=typeof v.metal_id=="number"?v.metal_id:Number(v.metal_id),T=v.metal_purity_id===""?null:typeof v.metal_purity_id=="number"?v.metal_purity_id:Number(v.metal_purity_id),B=v.metal_tone_id===""?null:typeof v.metal_tone_id=="number"?v.metal_tone_id:Number(v.metal_tone_id);return z===p.metal_id&&T===(p.metal_purity_id??null)&&B===(p.metal_tone_id??null)});j&&($=j.weight||"")}return{id:void 0,metal_id:p.metal_id,metal_purity_id:p.metal_purity_id??"",metal_tone_id:p.metal_tone_id??"",metal_weight:D?.metal_weight||$||""}}),l.metals.length>0){const p=l.metals[0];b.metal_id=p.metal_id,p.metal_purity_id!==null&&(b.metal_purity_id=p.metal_purity_id)}b.diamond_option_key=null,b.diamonds=[],b.size_id=l.size_id||null;const S={...b.metadata??{},status:"enabled"};return delete S.size_value,delete S.size_unit,delete S.use_all_category_sizes,b.metadata=S,b}),o={...t,variants:f};return o.variants=J(o),o},je=()=>{x(t=>ye(t))},Ne=t=>{t.preventDefault();const s=(k.data.media_uploads?.length??0)>0;k.transform(c=>{const i=c,a={...i};i.media_uploads&&Array.isArray(i.media_uploads)&&i.media_uploads.length>0&&(a.media_uploads=i.media_uploads),a.sku=i.sku||"",a.name=i.name||"",a.titleline=i.titleline||null,a.collection=i.collection||null,a.producttype=i.producttype||null,a.gender=i.gender||null,a.description=i.description||"";const m=i.brand_id;if(m!==""&&m!==null&&m!==void 0){const l=Number(m);a.brand_id=isNaN(l)?null:l}else a.brand_id=null;const f=i.category_id;if(f!==""&&f!==null&&f!==void 0){const l=Number(f);a.category_id=isNaN(l)?null:l}else a.category_id=null;const o=i.making_charge_types||[];if(o.includes("fixed")){const l=i.making_charge_amount;if(l===""||l===null||l===void 0)a.making_charge_amount=0;else{const h=Number(l);a.making_charge_amount=isNaN(h)?0:h}}else a.making_charge_amount=0;if(o.includes("percentage")){const l=i.making_charge_percentage;if(l===""||l===null||l===void 0)a.making_charge_percentage=null;else{const h=Number(l);a.making_charge_percentage=isNaN(h)?null:h}}else a.making_charge_percentage=null;return a.is_active=i.is_active??!0,delete a.metadata,(!a.media_uploads||Array.isArray(a.media_uploads)&&a.media_uploads.length===0)&&delete a.media_uploads,(!a.removed_media_ids||Array.isArray(a.removed_media_ids)&&a.removed_media_ids.length===0)&&delete a.removed_media_ids,a.sku||(a.sku=""),a.name||(a.name=""),a.brand_id===void 0&&(a.brand_id=null),a.category_id===void 0&&(a.category_id=null),a.making_charge_amount===void 0&&(a.making_charge_amount=0),i.subcategory_ids&&Array.isArray(i.subcategory_ids)&&i.subcategory_ids.length>0?a.category_ids=i.subcategory_ids:a.category_ids=[],delete a.subcategory_ids,i.variants&&Array.isArray(i.variants)?a.variants=i.variants:a.variants=[],i.diamond_selections!==void 0&&(a.diamond_selections=i.diamond_selections),d?.id&&s&&(a._method="PUT"),a});const n={preserveScroll:!0,forceFormData:s,onFinish:()=>{k.transform(c=>c)}};d?.id?s?w(route("admin.products.update",d.id),n):M(route("admin.products.update",d.id),n):w(route("admin.products.store"),n)},ie=N.variants,le=C.useMemo(()=>Object.entries(N??{}).filter(([t])=>t.startsWith("media_uploads")).map(([,t])=>t),[N]),re=C.useMemo(()=>d?.media?[...d.media].sort((t,s)=>t.display_order-s.display_order):[],[d?.media]),ve=t=>{const s=u.removed_media_ids??[],c=s.includes(t)?s.filter(i=>i!==t):[...s,t];x("removed_media_ids",c)},ke=t=>{const s=t.target.files?Array.from(t.target.files):[];s.length!==0&&(x("media_uploads",[...u.media_uploads??[],...s]),t.target.value="")},we=t=>{x("media_uploads",(u.media_uploads??[]).filter((s,n)=>n!==t))},oe=t=>(u.removed_media_ids??[]).includes(t);return e.jsxs($e,{children:[e.jsx(Me,{title:d?.id?`Edit ${d.name}`:"New Product"}),e.jsxs("form",{onSubmit:Ne,className:"space-y-10",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-xl shadow-slate-900/10",children:[e.jsxs("div",{className:"flex flex-col gap-4 border-b border-slate-100 pb-6 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:d?.id?"Update product":"Create product"}),e.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Define product master information and atelier references."})]}),e.jsx("button",{type:"submit",disabled:O,className:"inline-flex items-center gap-2 rounded-full bg-slate-900 px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-slate-900/20 transition hover:bg-slate-700 disabled:cursor-not-allowed disabled:opacity-60",children:O?"Saving…":d?.id?"Save changes":"Create product"})]}),e.jsx("div",{className:"mt-6 space-y-6",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"SKU *"}),e.jsx("input",{type:"text",value:u.sku,onChange:t=>x("sku",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200"}),N.sku&&e.jsx("span",{className:"text-xs text-rose-500",children:N.sku})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Product name *"}),e.jsx("input",{type:"text",value:u.name,onChange:t=>x("name",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200"}),N.name&&e.jsx("span",{className:"text-xs text-rose-500",children:N.name})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Product Type *"}),e.jsx("input",{type:"text",value:u.producttype,onChange:t=>x("producttype",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Enter product type"}),N.producttype&&e.jsx("span",{className:"text-xs text-rose-500",children:N.producttype})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Title Line *"}),e.jsx("input",{type:"text",value:u.titleline,onChange:t=>x("titleline",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Enter product title line"}),N.titleline&&e.jsx("span",{className:"text-xs text-rose-500",children:N.titleline})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Collection *"}),e.jsx("input",{type:"text",value:u.collection,onChange:t=>x("collection",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Enter collection name"}),N.collection&&e.jsx("span",{className:"text-xs text-rose-500",children:N.collection})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Gender *"}),e.jsxs("select",{value:u.gender,onChange:t=>x("gender",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[e.jsx("option",{value:"",children:"Select gender"}),e.jsx("option",{value:"Men",children:"Men"}),e.jsx("option",{value:"Women",children:"Women"}),e.jsx("option",{value:"Unisex",children:"Unisex"}),e.jsx("option",{value:"Kids",children:"Kids"})]}),N.gender&&e.jsx("span",{className:"text-xs text-rose-500",children:N.gender})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Brand *"}),e.jsxs("select",{value:u.brand_id,onChange:t=>x("brand_id",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[e.jsx("option",{value:"",children:"Select brand"}),Object.entries(E).map(([t,s])=>e.jsx("option",{value:t,children:s},t))]}),N.brand_id&&e.jsx("span",{className:"text-xs text-rose-500",children:N.brand_id})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{children:"Category *"}),e.jsxs("select",{value:u.category_id,onChange:t=>x("category_id",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[e.jsx("option",{value:"",children:"Select category"}),(A||[]).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),N.category_id&&e.jsx("span",{className:"text-xs text-rose-500",children:N.category_id})]}),e.jsx(Le,{subcategories:V||[],selectedIds:Array.isArray(u.subcategory_ids)?u.subcategory_ids:[],parentCategoryId:u.category_id===""||u.category_id===null||u.category_id===void 0||isNaN(Number(u.category_id))?"":Number(u.category_id),onChange:t=>x("subcategory_ids",t),error:N.subcategory_ids}),e.jsx(Ee,{catalogs:q,selectedIds:Array.isArray(u.catalog_ids)?u.catalog_ids:[],onChange:t=>x("catalog_ids",t),error:N.catalog_ids}),e.jsxs("div",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{className:"mb-2 block",children:"Making Charge *"}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u.making_charge_types?.includes("fixed")??!1,onChange:t=>{const s=u.making_charge_types||[];t.target.checked?x("making_charge_types",[...s,"fixed"]):x("making_charge_types",s.filter(n=>n!=="fixed"))},className:"h-5 w-5 rounded border-slate-300 text-elvee-blue focus:ring-2 focus:ring-elvee-blue focus:ring-offset-0"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Fixed Amount"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u.making_charge_types?.includes("percentage")??!1,onChange:t=>{const s=u.making_charge_types||[];t.target.checked?x("making_charge_types",[...s,"percentage"]):x("making_charge_types",s.filter(n=>n!=="percentage"))},className:"h-5 w-5 rounded border-slate-300 text-elvee-blue focus:ring-2 focus:ring-elvee-blue focus:ring-offset-0"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Percentage"})]})]})]}),N.making_charge_types&&(!u.making_charge_types||u.making_charge_types.length===0)&&e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"block text-xs text-rose-500",children:N.making_charge_types})}),(u.making_charge_types?.includes("fixed")??!1)&&e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsxs("span",{children:["Making Charge (₹) ",u.making_charge_types?.includes("percentage")??!1?"":"*"]}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:u.making_charge_amount,onChange:t=>x("making_charge_amount",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Enter fixed making charge"}),N.making_charge_amount&&e.jsx("span",{className:"text-xs text-rose-500",children:N.making_charge_amount})]}),(u.making_charge_types?.includes("percentage")??!1)&&e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsxs("span",{children:["Making Charge Percentage (%) ",u.making_charge_types?.includes("fixed")??!1?"":"*"]}),e.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:u.making_charge_percentage,onChange:t=>x("making_charge_percentage",t.target.value),className:"rounded-2xl border border-slate-200 px-4 py-2 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Enter percentage (e.g., 10 for 10%)"}),e.jsx("span",{className:"text-xs text-slate-500",children:"Percentage will be calculated on metal cost"}),N.making_charge_percentage&&e.jsx("span",{className:"text-xs text-rose-500",children:N.making_charge_percentage})]}),N.making_charge_types&&u.making_charge_types&&u.making_charge_types.length>0&&e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"block text-xs text-rose-500",children:N.making_charge_types})})]})]})})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-xl shadow-slate-900/10",children:[e.jsx("div",{className:"flex flex-col gap-3 border-b border-slate-100 pb-4 lg:flex-row lg:items-center lg:justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Product description"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Provide merchandising copy, craftsmanship details, and any atelier notes for this SKU."})]})}),e.jsxs("div",{className:"mt-6",children:[e.jsx(ze,{value:ee,onChange:ce,className:"overflow-hidden rounded-3xl border border-slate-200",placeholder:"Detail the design notes, materials, finish, and atelier craftsmanship."}),N.description&&e.jsx("span",{className:"mt-2 block text-xs text-rose-500",children:N.description})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-xl shadow-slate-900/10",children:[e.jsx("div",{className:"flex flex-col gap-4 border-b border-slate-100 pb-4 lg:flex-row lg:items-center lg:justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Product media"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Upload product images or videos for catalogue displays. You can also remove outdated media assets."})]})}),e.jsxs("div",{className:"mt-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-slate-400",children:"Current media"}),e.jsx("div",{className:"mt-3 grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:re.length>0?re.map(t=>e.jsxs("div",{className:`relative overflow-hidden rounded-3xl border border-slate-200 bg-slate-50 shadow-sm transition ${oe(t.id)?"opacity-50 ring-2 ring-rose-200":""}`,children:[t.type==="video"?e.jsx("video",{src:t.url,className:"h-48 w-full rounded-t-3xl bg-black object-cover",controls:!0,onError:s=>{console.error("Video load error:",t.url),s.target.style.display="none"},children:"Your browser does not support the video tag."}):e.jsx("img",{src:t.url,alt:"Product media",className:"h-48 w-full rounded-t-3xl object-cover",onError:s=>{console.error("Image load error:",t.url),s.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Crect fill="%23ddd" width="400" height="300"/%3E%3Ctext fill="%23999" font-family="sans-serif" font-size="18" x="50%25" y="50%25" text-anchor="middle" dy=".3em"%3EImage not found%3C/text%3E%3C/svg%3E'}}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 text-xs text-slate-500",children:[e.jsx("span",{className:"rounded-full bg-white/70 px-3 py-1 font-semibold text-slate-700",children:t.type.toUpperCase()}),e.jsx("button",{type:"button",onClick:()=>ve(t.id),className:"text-rose-500 transition hover:text-rose-600",children:oe(t.id)?"Undo removal":"Remove"})]})]},t.id)):e.jsx("p",{className:"rounded-2xl border border-dashed border-slate-200 px-4 py-6 text-sm text-slate-500",children:"No media uploaded yet."})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-slate-400",children:"Upload new files"}),e.jsxs("label",{className:"mt-3 flex cursor-pointer flex-col items-center justify-center gap-3 rounded-3xl border border-dashed border-slate-300 bg-slate-50 px-6 py-10 text-center text-slate-500 transition hover:border-slate-400 hover:bg-slate-100",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-slate-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 15a4 4 0 014-4h10a4 4 0 014 4v3a2 2 0 01-2 2H5a2 2 0 01-2-2v-3z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 10l5-5m0 0l5 5m-5-5v12"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-700",children:"Click to upload"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"JPEG, PNG, WebP, MP4 up to 50MB each."})]}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*,video/*",onChange:ke,className:"hidden"})]}),le.length>0&&e.jsx("ul",{className:"mt-3 space-y-1",children:le.map((t,s)=>e.jsx("li",{className:"text-xs text-rose-500",children:t},`${s}-${t}`))}),(u.media_uploads??[]).length>0&&e.jsx("ul",{className:"mt-4 space-y-2",children:(u.media_uploads??[]).map((t,s)=>e.jsxs("li",{className:"flex items-center justify-between rounded-2xl border border-slate-200 px-4 py-2 text-sm text-slate-600",children:[e.jsx("span",{className:"truncate",children:t.name}),e.jsx("button",{type:"button",onClick:()=>we(s),className:"text-rose-500 transition hover:text-rose-600",children:"Remove"})]},`${t.name}-${s}`))})]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-xl shadow-slate-900/10",children:[e.jsx("div",{className:"flex flex-col gap-3 border-b border-slate-100 pb-4 lg:flex-row lg:items-center lg:justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Variant configuration"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Decide whether this product uses a single price or multiple combinations across metals and diamonds."})]})}),e.jsxs("div",{className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-2",children:"Variant Configuration Options"}),e.jsx("p",{className:"text-xs text-slate-600 mb-4",children:"Use the configuration buttons in the variant table below to add metals (with purity and tone) and diamonds to each variant."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-sky-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 13h8l-4-4m0 8l4-4"})}),e.jsx("span",{className:"text-slate-700",children:"Configure Metals"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-sky-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),e.jsx("span",{className:"text-slate-700",children:"Configure Diamonds"})]})]})]}),(()=>{const t=u.category_id?Number(u.category_id):null,s=t?A.find(a=>a.id===t):null,n=s&&"sizes"in s&&s.sizes&&s.sizes.length>0||d?.category?.id===t&&d.category.sizes&&d.category.sizes.length>0,c=s&&"sizes"in s&&s.sizes||d?.category?.sizes||[];if(!n)return null;const i=[{key:"all",label:"All sizes available",value:!0},{key:"specific",label:"Select specific sizes",value:!1}];return e.jsxs("div",{className:"space-y-4 rounded-2xl border border-slate-200 p-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-slate-500",children:"Sizes"}),e.jsxs("p",{className:"text-xs text-slate-500",children:['This category "',s?.name||d?.category?.name,'" has ',c.length," sizes available. Are all sizes available for this product?"]})]}),e.jsx("div",{className:"flex flex-wrap gap-3",children:i.map(a=>{const m=u.all_sizes_available===a.value;return e.jsxs("label",{className:`
                                                            inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-medium transition-all cursor-pointer
                                                            ${m?"bg-sky-600 text-white shadow-sm":"border border-slate-200 bg-white text-slate-700 hover:border-slate-300"}
                                                        `,children:[e.jsx("input",{type:"checkbox",checked:m,onChange:f=>{x(o=>{const l=c.map(h=>typeof h.id=="number"?h.id:Number(h.id));return{...o,all_sizes_available:f.target.checked?a.value:void 0,selected_sizes:f.target.checked&&a.value===!0?l:a.value===!1?[]:o.selected_sizes||[]}})},className:`mr-2 h-4 w-4 rounded border-2 ${m?"border-white bg-white text-sky-600":"border-slate-300 bg-white text-slate-700"} focus:ring-2 focus:ring-sky-500 focus:ring-offset-0`}),a.label]},a.key)})}),u.all_sizes_available!==void 0&&e.jsx("div",{className:"space-y-4",children:u.all_sizes_available===!0?e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"All Category Sizes"}),e.jsxs("span",{className:"text-xs font-medium text-sky-600",children:[c.length," sizes will be used"]})]}),e.jsxs("p",{className:"mb-3 text-xs text-slate-600",children:['Variants will be created for all sizes from category "',s?.name||d?.category?.name,'". Only metal combinations are shown in the variant table below.']}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(a=>e.jsx("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-slate-50 px-3 py-1 text-xs font-semibold text-slate-600",children:a.name||a.value},a.id||a.name))})]}):e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Select Specific Sizes"}),(u.selected_sizes||[]).length>0&&e.jsxs("span",{className:"text-xs font-medium text-sky-600",children:[(u.selected_sizes||[]).length," size",(u.selected_sizes||[]).length!==1?"s":""," selected"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-3 text-xs text-slate-600",children:"Choose sizes from the category to include in your product variants."}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(a=>{const m=typeof a.id=="number"?a.id:Number(a.id),f=(u.selected_sizes||[]).includes(m);return e.jsxs("label",{className:`
                                                                                inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-medium transition-all cursor-pointer
                                                                                ${f?"bg-sky-600 text-white shadow-sm":"border border-slate-200 bg-white text-slate-700 hover:border-slate-300"}
                                                                            `,children:[e.jsx("input",{type:"checkbox",checked:f,onChange:o=>{x(l=>{const h=l.selected_sizes||[],b=o.target.checked?[...h,m]:h.filter(g=>g!==m);return{...l,selected_sizes:b}})},className:`mr-2 h-4 w-4 rounded border-2 ${f?"border-white bg-white text-sky-600":"border-slate-300 bg-white text-slate-700"} focus:ring-2 focus:ring-sky-500 focus:ring-offset-0`}),a.name||a.value]},m||a.name)})})]})]})})]})})(),e.jsxs("div",{className:"space-y-4 rounded-2xl border border-slate-200 p-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-slate-500",children:"Metals"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Select metals that can be used in your product variants."})]}),e.jsx("div",{className:"flex flex-wrap gap-3",children:P.map(t=>{const s=(u.selected_metals||[]).includes(t.id);return e.jsxs("label",{className:`
                                                    inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-medium transition-all cursor-pointer
                                                    ${s?"bg-sky-600 text-white shadow-sm":"border border-slate-200 bg-white text-slate-700 hover:border-slate-300"}
                                                `,children:[e.jsx("input",{type:"checkbox",checked:s,onChange:n=>{x(c=>{const i=c.selected_metals||[],a=n.target.checked?[...i,t.id]:i.filter(f=>f!==t.id),m={...c.metal_configurations||{}};return n.target.checked?m[t.id]||(m[t.id]={purities:[],tones:[]}):delete m[t.id],{...c,selected_metals:a,metal_configurations:m}})},className:`mr-2 h-4 w-4 rounded border-2 ${s?"border-white bg-white text-sky-600":"border-slate-300 bg-white text-slate-700"} focus:ring-2 focus:ring-sky-500 focus:ring-offset-0`}),t.name]},t.id)})}),e.jsx("div",{className:"space-y-4",children:P.map(t=>{if(!(u.selected_metals||[]).includes(t.id))return null;const n=(u.metal_configurations||{})[t.id]||{purities:[],tones:[]},c=W.filter(o=>o.metal_id===t.id),i=F.filter(o=>o.metal_id===t.id),a=n.purities.length>0?n.purities.length:c.length>0?c.length:1,m=n.tones.length>0?n.tones.length:i.length>0?i.length:1,f=a*m;return e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("h4",{className:"text-sm font-semibold text-slate-900",children:["Metal: ",t.name]}),f>0&&e.jsxs("span",{className:"text-xs font-medium text-sky-600",children:[f," variant",f!==1?"s":""," for this metal"]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"mb-3 text-xs text-slate-600",children:["Choose all purities in which this design is available for ",t.name,"."]}),e.jsx("div",{className:"flex flex-wrap gap-3",children:c.map(o=>{const l=n.purities.includes(o.id);return e.jsxs("label",{className:`
                                                                        inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-medium transition-all cursor-pointer
                                                                        ${l?"bg-sky-600 text-white shadow-sm":"border border-slate-200 bg-white text-slate-700 hover:border-slate-300"}
                                                                    `,children:[e.jsx("input",{type:"checkbox",checked:l,onChange:h=>{x(b=>{const g={...b.metal_configurations||{}};g[t.id]||(g[t.id]={purities:[],tones:[]});const _=g[t.id].purities||[];return g[t.id].purities=h.target.checked?[..._,o.id]:_.filter(y=>y!==o.id),{...b,metal_configurations:g}})},className:`mr-2 h-4 w-4 rounded border-2 ${l?"border-white bg-white text-sky-600":"border-slate-300 bg-white text-slate-700"} focus:ring-2 focus:ring-sky-500 focus:ring-offset-0`}),o.name]},o.id)})})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"mb-3 text-xs text-slate-600",children:["Choose all tones in which this design is available for ",t.name,"."]}),e.jsx("div",{className:"flex flex-wrap gap-3",children:i.map(o=>{const l=n.tones.includes(o.id);return e.jsxs("label",{className:`
                                                                        inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-medium transition-all cursor-pointer
                                                                        ${l?"bg-sky-600 text-white shadow-sm":"border border-slate-200 bg-white text-slate-700 hover:border-slate-300"}
                                                                    `,children:[e.jsx("input",{type:"checkbox",checked:l,onChange:h=>{x(b=>{const g={...b.metal_configurations||{}};g[t.id]||(g[t.id]={purities:[],tones:[]});const _=g[t.id].tones||[];return g[t.id].tones=h.target.checked?[..._,o.id]:_.filter(y=>y!==o.id),{...b,metal_configurations:g}})},className:`mr-2 h-4 w-4 rounded border-2 ${l?"border-white bg-white text-sky-600":"border-slate-300 bg-white text-slate-700"} focus:ring-2 focus:ring-sky-500 focus:ring-offset-0`}),o.name]},o.id)})})]})]},t.id)})})]}),e.jsxs("div",{className:"space-y-4 rounded-2xl border border-slate-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-slate-500",children:"Diamonds"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Select diamonds and specify counts for your product variants."})]}),e.jsxs("button",{type:"button",onClick:pe,className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-white px-3 py-1.5 text-xs font-semibold text-slate-700 transition hover:border-sky-400 hover:bg-sky-50",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 5v14M5 12h14"})}),"Add Diamond"]})]}),(u.diamond_selections||[]).length>0?e.jsx("div",{className:"space-y-3",children:(u.diamond_selections||[]).map((t,s)=>e.jsxs("div",{className:"flex items-center gap-3 rounded-xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"mb-1 block text-xs font-semibold text-slate-600",children:"Diamond"}),e.jsxs("select",{value:t.diamond_id===""?"":t.diamond_id,onChange:n=>se(s,"diamond_id",n.target.value===""?"":Number(n.target.value)),className:"w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[e.jsx("option",{value:"",children:"Select diamond"}),R.map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]})]}),e.jsxs("div",{className:"w-32",children:[e.jsx("label",{className:"mb-1 block text-xs font-semibold text-slate-600",children:"Count"}),e.jsx("input",{type:"number",min:"0",step:"1",value:t.count,onChange:n=>se(s,"count",n.target.value),className:"w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"0"})]}),e.jsx("button",{type:"button",onClick:()=>he(s),className:"mt-6 rounded-full border border-rose-200 p-2 text-rose-600 transition hover:border-rose-300 hover:text-rose-700","aria-label":"Remove diamond",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]},s))}):e.jsx("p",{className:"text-xs text-slate-400",children:'No diamonds added. Click "Add Diamond" to add one.'})]})]})]}),e.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-xl shadow-slate-900/10 ring-1 ring-slate-200/80",children:[e.jsxs("div",{className:"flex flex-col gap-4 border-b border-slate-200 pb-6 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-900",children:"Variant Matrix"}),e.jsx("p",{className:"mt-2 text-sm text-slate-500",children:"Configure product variants with metals and diamonds. The default variant powers the customer catalogue card pricing."})]}),e.jsxs("button",{type:"button",onClick:je,className:"inline-flex items-center gap-2 rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-slate-900/20 transition hover:bg-slate-700",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h7"})}),"Generate Matrix"]})]}),ie&&e.jsx("div",{className:"mt-6 rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-600 ring-1 ring-rose-200/50",children:ie}),e.jsx("div",{className:"mt-8 overflow-hidden rounded-3xl bg-white shadow-xl shadow-slate-900/10 ring-1 ring-slate-200/80",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-5 py-3 text-left min-w-[150px]",children:"SKU"}),e.jsx("th",{className:"px-5 py-3 text-left min-w-[300px]",children:"Variant Label"}),e.jsx("th",{className:"px-5 py-3 text-left min-w-[150px]",children:"Metal"}),e.jsx("th",{className:"px-5 py-3 text-left min-w-[120px]",children:"Purity"}),e.jsx("th",{className:"px-5 py-3 text-left min-w-[120px]",children:"Tone"}),e.jsx("th",{className:"px-5 py-3 text-left min-w-[120px]",children:"Weight (g)"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Inventory Quantity"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Status"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Default"}),e.jsx("th",{className:"px-5 py-3 text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100 bg-white",children:[(u.variants||[]).map((t,s)=>{const n=I(t,u);n.metalTone;const c=(t.metals||[]).filter(r=>r.metal_id!==""&&r.metal_id!==null&&typeof r.metal_id=="number");c.reduce((r,S)=>{const p=parseFloat(S.metal_weight||"0");return r+(isNaN(p)?0:p)},0);const i=new Map;c.forEach(r=>{const S=r.metal_id;i.has(S)||i.set(S,[]),i.get(S).push({metal_id:S,metal_purity_id:r.metal_purity_id!==""&&r.metal_purity_id!==null?typeof r.metal_purity_id=="number"?r.metal_purity_id:Number(r.metal_purity_id):null,metal_tone_id:r.metal_tone_id!==""&&r.metal_tone_id!==null?typeof r.metal_tone_id=="number"?r.metal_tone_id:Number(r.metal_tone_id):null})});const a=[],m=[],f=[];i.forEach((r,S)=>{const p=Y[S]||"";p&&a.push(p);const D=new Set,$=new Set;if(r.forEach(j=>{if(j.metal_purity_id!==null){const v=typeof j.metal_purity_id=="number"?j.metal_purity_id:Number(j.metal_purity_id);Number.isFinite(v)&&D.add(v)}if(j.metal_tone_id!==null){const v=typeof j.metal_tone_id=="number"?j.metal_tone_id:Number(j.metal_tone_id);Number.isFinite(v)&&$.add(v)}}),D.size>0){const j=Array.from(D).map(v=>{const z=typeof v=="number"?v:Number(v);return Number.isFinite(z)&&H[z]||""}).filter(Boolean).sort();j.length>0&&(D.size>1?m.push(`${j.join(" + ")} (${p})`):m.push(`${j[0]} (${p})`))}if($.size>0){const j=Array.from($).map(v=>{const z=typeof v=="number"?v:Number(v);return Number.isFinite(z)&&Z[z]||""}).filter(Boolean).sort();j.length>0&&($.size>1?f.push(`${j.join(" + ")} (${p})`):f.push(`${j[0]} (${p})`))}});const o=a.length>0?a.join(", "):"—",l=m.length>0?m.join(" / "):"—",h=f.length>0?f.join(" / "):"—";let b=[];const g=(t.diamonds||[]).filter(r=>r.diamond_id!==""&&r.diamond_id!==null&&r.diamond_id!==void 0).map(r=>({diamond_id:typeof r.diamond_id=="number"?r.diamond_id:Number(r.diamond_id),diamonds_count:r.diamonds_count||""}));g.length>0?b=g:(t.diamonds||[]).length>0?b=(t.diamonds||[]).map(r=>({diamond_id:null,diamonds_count:r.diamonds_count||""})):(u.diamond_selections||[]).length>0&&(b=(u.diamond_selections||[]).filter(r=>r.diamond_id!==""&&r.diamond_id!==null&&r.diamond_id!==void 0).map(r=>({diamond_id:typeof r.diamond_id=="number"?r.diamond_id:Number(r.diamond_id),diamonds_count:r.count||""})));const _=t.metadata??{};_.size_value&&String(_.size_value);const y=typeof _.status=="string"&&_.status.trim().length>0?String(_.status):"enabled";return n.autoLabel,e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:`hover:bg-slate-50 ${y==="disabled"?"opacity-70":""} ${t.is_default?"bg-sky-50/30":""}`,children:[e.jsxs("td",{className:"px-5 py-3 align-middle min-w-[150px]",children:[e.jsx("input",{type:"text",value:t.sku,onChange:r=>Q(s,"sku",r.target.value),className:"w-full min-w-[120px] rounded-xl border border-slate-200 px-3 py-1.5 text-sm text-slate-700 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Variant SKU"}),N[`variants.${s}.sku`]&&e.jsx("p",{className:"mt-1 text-xs text-rose-500",children:N[`variants.${s}.sku`]})]}),e.jsxs("td",{className:"px-5 py-3 align-middle min-w-[300px]",children:[e.jsx("input",{type:"text",value:t.label,onChange:r=>Q(s,"label",r.target.value),className:"w-full min-w-[280px] rounded-xl border border-slate-200 px-3 py-1.5 text-sm text-slate-700 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Display label"}),N[`variants.${s}.label`]&&e.jsx("p",{className:"mt-1 text-xs text-rose-500",children:N[`variants.${s}.label`]})]}),e.jsx("td",{className:"px-5 py-3 align-middle text-slate-700",children:e.jsx("div",{className:"min-w-[150px]",children:e.jsx("span",{className:"text-sm font-semibold text-slate-800",children:o})})}),e.jsx("td",{className:"px-5 py-3 align-middle text-slate-700",children:e.jsx("div",{className:"min-w-[120px]",children:e.jsx("span",{className:"text-sm text-slate-700",children:l})})}),e.jsx("td",{className:"px-5 py-3 align-middle text-slate-700",children:e.jsx("div",{className:"min-w-[120px]",children:e.jsx("span",{className:"text-sm text-slate-700",children:h})})}),e.jsx("td",{className:"px-5 py-3 align-middle text-slate-700",children:e.jsx("div",{className:"min-w-[120px]",children:c.length>0?c.map((r,S)=>{const p=r.metal_weight||"";return e.jsxs("div",{className:"mb-2 last:mb-0",children:[e.jsx("input",{type:"number",step:"0.001",min:"0.001",required:!0,value:p,onChange:D=>{const $=D.target.value;ne(s,S,"metal_weight",$)},className:`w-full rounded-lg border px-2.5 py-1.5 text-sm font-mono transition-colors ${!p||p===""?"border-rose-300 bg-rose-50 text-rose-500 focus:border-rose-400 focus:bg-white":"border-slate-200 bg-white text-slate-700 focus:border-sky-400"} focus:outline-none focus:ring-1 focus:ring-sky-200`,placeholder:"0.000"}),(!p||p==="")&&e.jsx("span",{className:"mt-1 text-[10px] text-rose-500 block",children:"Required"})]},S)}):e.jsx("span",{className:"text-sm text-slate-400",children:"—"})})}),e.jsx("td",{className:"px-5 py-3 align-middle text-slate-700",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("input",{type:"number",min:"0",step:"1",required:!0,value:t.inventory_quantity!==void 0&&t.inventory_quantity!==null&&t.inventory_quantity!==""?String(t.inventory_quantity):"",onChange:r=>{const S=r.target.value.trim();if(S==="")Q(s,"inventory_quantity","");else{const p=parseInt(S,10);!isNaN(p)&&p>=0&&Q(s,"inventory_quantity",p)}},className:`w-full min-w-[100px] rounded-xl border px-3 py-1.5 text-sm text-slate-700 transition-colors ${t.inventory_quantity===void 0||t.inventory_quantity===null||t.inventory_quantity===""?"border-rose-300 bg-rose-50 text-rose-500 focus:border-rose-400 focus:bg-white":"border-slate-200 bg-white focus:border-sky-400"} focus:outline-none focus:ring-2 focus:ring-sky-200`,placeholder:"0"}),(t.inventory_quantity===void 0||t.inventory_quantity===null||t.inventory_quantity==="")&&e.jsx("span",{className:"text-[10px] text-rose-500",children:"Required"})]})}),e.jsx("td",{className:"px-5 py-3 text-slate-700",children:e.jsxs("select",{value:y,onChange:r=>ge(s,{status:r.target.value}),className:`rounded-xl border px-3 py-1.5 text-sm text-slate-700 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200 ${y==="enabled"?"border-emerald-300 bg-emerald-50":"border-amber-300 bg-amber-50"}`,children:[e.jsx("option",{value:"enabled",children:"Enabled"}),e.jsx("option",{value:"disabled",children:"Disabled"})]})}),e.jsx("td",{className:"px-5 py-3 text-slate-700",children:e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[e.jsx("input",{type:"radio",name:"default-variant-table",checked:t.is_default,onChange:()=>_e(s),className:"h-4 w-4 text-sky-600 focus:ring-sky-500"}),e.jsx("span",{children:t.is_default?"Default":"Set default"})]})}),e.jsx("td",{className:"px-5 py-3 text-right",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx("button",{type:"button",onClick:()=>fe(s),className:"inline-flex items-center justify-center rounded-full border border-rose-200 p-1.5 text-rose-600 transition hover:border-rose-300 hover:text-rose-700","aria-label":"Remove variant",title:"Remove Variant",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,className:"h-4 w-4",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 7h12m-9 3v6m6-6v6M10 4h4a1 1 0 0 1 1 1v1H9V5a1 1 0 0 1 1-1Z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 7h14l-.8 11.2A2 2 0 0 1 16.2 20H7.8a2 2 0 0 1-1.99-1.8L5 7Z"})]})})})})]},t.id??`variant-${s}`),ue.has(s)&&e.jsx("tr",{children:e.jsx("td",{colSpan:13,className:"px-5 py-4",children:e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Metals for this Variant"}),e.jsxs("p",{className:"mt-1 text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold text-rose-600",children:"Required:"})," Enter metal weight (in grams) for each metal in this variant."]})]})}),c.length===0?e.jsx("p",{className:"text-xs text-slate-400",children:"No metals assigned to this variant."}):e.jsx("div",{className:"space-y-3",children:c.map((r,S)=>{const p=Y[r.metal_id]||"Unknown Metal",D=r.metal_purity_id&&typeof r.metal_purity_id=="number"&&W.find(j=>j.id===r.metal_purity_id)?.name||"",$=r.metal_tone_id&&typeof r.metal_tone_id=="number"&&F.find(j=>j.id===r.metal_tone_id)?.name||"";return e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"mb-3 flex items-center justify-between",children:e.jsxs("span",{className:"text-xs font-semibold text-slate-600",children:[p,D&&` — ${D}`,$&&` — ${$}`]})}),e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:e.jsxs("label",{className:"flex flex-col gap-1.5",children:[e.jsxs("span",{className:"text-xs font-semibold text-slate-700 flex items-center gap-1",children:[e.jsx("span",{children:"Metal Weight (g)"}),e.jsx("span",{className:"text-rose-500 font-bold text-sm",title:"Required field",children:"*"})]}),e.jsx("input",{type:"number",step:"0.001",min:"0.001",required:!0,value:r.metal_weight||"",onChange:j=>{const v=j.target.value;ne(s,S,"metal_weight",v)},className:`rounded-xl border-2 px-3 py-2 text-sm font-medium transition-colors ${r.metal_weight?"border-slate-200 bg-white focus:border-sky-400":"border-rose-300 bg-rose-50 focus:border-rose-400 focus:bg-white"} focus:outline-none focus:ring-2 focus:ring-sky-200`,placeholder:"Enter weight (required)"}),!r.metal_weight&&e.jsx("span",{className:"text-xs text-rose-600 font-medium",children:"⚠️ This field is required"})]})})]},S)})})]})})}),me.has(s)&&e.jsx("tr",{children:e.jsx("td",{colSpan:13,className:"px-5 py-4",children:e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Diamonds for this Variant"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"This variant uses the shared diamond list defined above. All variants share the same diamonds."})]})}),b.length===0?e.jsx("p",{className:"text-xs text-slate-400",children:"No diamonds assigned to this variant from the shared matrix."}):e.jsx("div",{className:"space-y-3",children:b.map((r,S)=>e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs font-semibold text-slate-600",children:["Diamond #",S+1]}),e.jsx("button",{type:"button",onClick:()=>be(s,S),className:"text-xs text-rose-500 transition hover:text-rose-700",children:"Remove"})]}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("label",{className:"flex flex-col gap-1.5 text-xs font-medium text-slate-600",children:["Diamond",e.jsxs("select",{value:typeof r.diamond_id=="string"||!r.diamond_id?"":String(r.diamond_id),onChange:p=>ae(s,S,"diamond_id",p.target.value===""?"":Number(p.target.value)),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[e.jsx("option",{value:"",children:"Select diamond"}),(R||[]).map(p=>e.jsx("option",{value:p.id,children:p.name},p.id))]})]}),e.jsxs("label",{className:"flex flex-col gap-1.5 text-xs font-medium text-slate-600",children:["Number of Diamonds",e.jsx("input",{type:"number",step:"1",min:"0",value:r.diamonds_count,onChange:p=>ae(s,S,"diamonds_count",p.target.value),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"0"})]})]})]},S))})]})})})]})}),(u.variants||[]).length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:17,className:"px-5 py-6 text-center text-xs uppercase tracking-[0.1em] text-slate-400",children:"No variants configured. Generate matrix to create variants."})})]})]})})})]})]})]})}export{Be as default};
